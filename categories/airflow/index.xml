<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>Airflow on ğŸ”ï¸ MLOps Journey</title><link>https://keonhoban.github.io/mlops-journey/categories/airflow/</link><description>Recent content in Airflow on ğŸ”ï¸ MLOps Journey</description><generator>Hugo -- 0.145.0</generator><language>ko</language><lastBuildDate>Tue, 15 Jul 2025 17:55:05 +0900</lastBuildDate><atom:link href="https://keonhoban.github.io/mlops-journey/categories/airflow/index.xml" rel="self" type="application/rss+xml"/><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• : Airflow-MLflow-FastAPI (Helm)]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/helm/</link><pubDate>Tue, 15 Jul 2025 17:55:05 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/helm/</guid><description>&lt;h2 id="-ì „ì²´-ì‹œë¦¬ì¦ˆ-ìš”ì•½">ğŸ“Œ ì „ì²´ ì‹œë¦¬ì¦ˆ ìš”ì•½&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ìˆœì„œ&lt;/th>
&lt;th>ì£¼ì œ&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/">ğŸ”— ì‹¤ìŠµì„ ìœ„í•œ ì¸í”„ë¼ ì‚¬ì „ êµ¬ì„± (Kubernetes, NFS, PostgreSQL, S3 ë“±)&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/">ğŸ”— Secret/ë³´ì•ˆ êµ¬ì„± ë° Kubernetes ì—°ë™&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/03/">ğŸ”— MLflow Tracking ì„œë²„ ë° Registry êµ¬ì¶•&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>4&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/04/">ğŸ”— Airflow DAG Git ì—°ë™ ë° Secret ê¸°ë°˜ êµ¬ì„±&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/05/">ğŸ”— FastAPI ëª¨ë¸ ì„œë¹™ &amp;amp; MLflow ëª¨ë¸ ìë™ ë¡œë”©&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/06/">ğŸ”— Airflow + MLflow + FastAPI ì—°ê²°ì„ í†µí•´ ëª¨ë¸ í•«ìŠ¤ì™‘&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-ì§€ê¸ˆê¹Œì§€-êµ¬í˜„í•œ-ì•„í‚¤í…ì²˜-ìš”ì•½">ğŸ’¡ ì§€ê¸ˆê¹Œì§€ êµ¬í˜„í•œ ì•„í‚¤í…ì²˜ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code class="language-mermaid" data-lang="mermaid">graph TD
%% í´ëŸ¬ìŠ¤í„° êµ¬ì„±
subgraph &amp;#34;Kubernetes Cluster&amp;#34;
subgraph &amp;#34;Namespace: mlflow&amp;#34;
MLflow[ğŸ“¦ MLflow Pod]
end
subgraph &amp;#34;Namespace: airflow&amp;#34;
Airflow[ğŸ“¦ Airflow Pod]
end
subgraph &amp;#34;Namespace: fastapi&amp;#34;
FastAPI[ğŸ“¦ FastAPI Pod]
end
end
%% ì™¸ë¶€ ì‹œìŠ¤í…œ
subgraph &amp;#34;External Systems&amp;#34;
S3[ğŸª£ S3 Bucket]
DB_PostgreSQL[ğŸ—„ï¸ PostgreSQL DB]
end
%% Secret êµ¬ì„±
subgraph &amp;#34;Kubernetes Secrets&amp;#34;
AWS_Secret[ğŸ” aws-credentials-secret]
MLflow_DB_Secret[ğŸ” mlflow-db-secret]
Airflow_DB_Secret[ğŸ” airflow-db-secret]
end
%% MLflow ì—°ë™
MLflow --&amp;gt;|&amp;#34;ëª¨ë¸ ë©”íƒ€ë°ì´í„° ì €ì¥&amp;#34;| DB_PostgreSQL
MLflow --&amp;gt;|&amp;#34;ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ì €ì¥&amp;#34;| S3
AWS_Secret --&amp;gt; MLflow
MLflow_DB_Secret --&amp;gt; MLflow
%% Airflow ì—°ë™
Airflow --&amp;gt;|&amp;#34;ëª¨ë¸ í•™ìŠµ í›„ ë“±ë¡&amp;#34;| MLflow
Airflow --&amp;gt;|&amp;#34;ì¶”ë¡  ê²°ê³¼ ì €ì¥&amp;#34;| DB_PostgreSQL
AWS_Secret --&amp;gt; Airflow
Airflow_DB_Secret --&amp;gt; Airflow
%% FastAPI ì—°ë™
FastAPI --&amp;gt;|&amp;#34;ëª¨ë¸ ë©”íƒ€ì •ë³´ ì¡°íšŒ&amp;#34;| MLflow
FastAPI --&amp;gt;|&amp;#34;ëª¨ë¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ&amp;#34;| S3
FastAPI --&amp;gt;|&amp;#34;ì¶”ë¡  ì…ë ¥ ë°ì´í„° ì ‘ê·¼&amp;#34;| S3
AWS_Secret --&amp;gt; FastAPI
%% ì„œë¹„ìŠ¤ íë¦„ ê°•ì¡°
style FastAPI fill:#d1f7c4,stroke:#3fa34d,stroke-width:2px
style Airflow fill:#cfe2ff,stroke:#2c6ecb,stroke-width:2px
style MLflow fill:#fce2c8,stroke:#e09100,stroke-width:2px
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>&lt;strong>Kubernetes ê¸°ë°˜ Podë¡œ ëª¨ë“  êµ¬ì„± ìš”ì†Œ ìš´ì˜&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Secret ê¸°ë°˜ AWS ì¸ì¦ ì •ë³´ ë° DB ì •ë³´ ì£¼ì…&lt;/strong>&lt;/li>
&lt;li>&lt;strong>Ingress ê¸°ë°˜ ì ‘ê·¼ (ex. airflow.local, mlflow.local, fastapi.local)&lt;/strong>&lt;/li>
&lt;li>&lt;strong>MLflow + Airflow + FastAPI ì—°ê³„ë¡œ ì‹¤ì‹œê°„ ëª¨ë¸ ê´€ë¦¬/ì„œë¹™ ìë™í™”&lt;/strong>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-ì‹¤ë¬´-ê´€ì ì—ì„œ-ê°•ì ">ğŸ¯ ì‹¤ë¬´ ê´€ì ì—ì„œ ê°•ì &lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>í•­ëª©&lt;/th>
&lt;th>ë‚´ìš©&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ëª¨ë¸ ì‹¤í—˜ ìë™í™”&lt;/td>
&lt;td>Airflow DAG + MLflow ì—°ë™ìœ¼ë¡œ ë‹¤ì–‘í•œ ëª¨ë¸ ë²„ì „ í•™ìŠµ ìë™í™”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ì„œë¹™ ì•ˆì •ì„±&lt;/td>
&lt;td>FastAPIê°€ &lt;code>Production&lt;/code> Stage ê¸°ì¤€ìœ¼ë¡œ ëª¨ë¸ ë¡œë“œ â†’ ë¬´ì¤‘ë‹¨ í•«ìŠ¤ì™‘ ê°€ëŠ¥&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ë³´ì•ˆ êµ¬ì„±&lt;/td>
&lt;td>AWS ì¸ì¦ ì •ë³´ ë° DB ì •ë³´ëŠ” Secretìœ¼ë¡œ ì£¼ì…&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ì¸í”„ë¼ ì´ì‹ì„±&lt;/td>
&lt;td>Helm + Docker + Kubernetes ê¸°ë°˜ â†’ ì–´ë””ì„œë“  ì´ì‹ ê°€ëŠ¥&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ì‹¤ì‹œê°„ ì¶”ë¡  í™•ì¸&lt;/td>
&lt;td>Ingress ê¸°ë°˜ UI/Endpoint ì—°ê²° â†’ ë°”ë¡œ curl í…ŒìŠ¤íŠ¸ ê°€ëŠ¥&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-íšŒê³ ">ğŸ” íšŒê³ &lt;/h2>
&lt;h3 id="-í”„ë¡œë•ì…˜-í™˜ê²½-ê³ ë ¤">âœ… í”„ë¡œë•ì…˜ í™˜ê²½ ê³ ë ¤&lt;/h3>
&lt;ul>
&lt;li>ìš´ì˜ ê°€ëŠ¥í•œ MLOps êµ¬ì¡°ë¡œ ì„¤ê³„ (ìœ ì§€ë³´ìˆ˜/ë³´ì•ˆ ê³ ë ¤)&lt;/li>
&lt;li>AWS S3, PostgreSQL, Kubernetes, GitOpsê¹Œì§€ í˜„ì‹¤ í™˜ê²½ ê°€ì •í•˜ê³  êµ¬ì„±&lt;/li>
&lt;li>Secret ì„¤ê³„, Volume ë§ˆìš´íŠ¸, GitSync, ì»¤ìŠ¤í…€ ì´ë¯¸ì§€ ë“± ì„¸ì„¸í•œ ë¶€ë¶„ê¹Œì§€ ì„¤ê³„ ì£¼ë„&lt;/li>
&lt;/ul>
&lt;h3 id="-ìë™í™”-ê¸°ë°˜-ì„¤ê³„">âœ… ìë™í™” ê¸°ë°˜ ì„¤ê³„&lt;/h3>
&lt;ul>
&lt;li>Airflowë¥¼ í†µí•´ ëª¨ë¸ í•™ìŠµ â†’ Registry ë“±ë¡ â†’ ì„œë¹™ê¹Œì§€ ìë™í™”&lt;/li>
&lt;li>ëª¨ë¸ í•«ìŠ¤ì™‘ ì‹¤í—˜ê¹Œì§€ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-ë¶€ì¡±í–ˆë˜-ì --ë³´ì™„-ê³„íš">ğŸ§± ë¶€ì¡±í–ˆë˜ ì  &amp;amp; ë³´ì™„ ê³„íš&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>í•­ëª©&lt;/th>
&lt;th>ê°œì„  í¬ì¸íŠ¸&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ëª¨ë‹ˆí„°ë§&lt;/td>
&lt;td>Prometheus + Grafanaë¡œ ì„œë¹™/ì‹¤í—˜ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì¶”ê°€ í•„ìš”&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ëª¨ë¸ í…ŒìŠ¤íŠ¸ ìë™í™”&lt;/td>
&lt;td>pytest + CI íŒŒì´í”„ë¼ì¸ êµ¬ì„±ìœ¼ë¡œ í’ˆì§ˆ í™•ë³´ ê³ ë ¤&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Kubeflow ì—°ê³„&lt;/td>
&lt;td>Kubeflow Pipelines ë° Katib ë“±ê³¼ì˜ ë¹„êµ ë¶„ì„ ì˜ˆì •&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Terraform ê¸°ë°˜ ì „í™˜&lt;/td>
&lt;td>Helm êµ¬ì„± ìš”ì†Œë¥¼ ì½”ë“œë¡œ ê´€ë¦¬í•˜ëŠ” Terraform ì¸í”„ë¼ ì „í™˜ ê³„íš&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-ë‹¤ìŒ-ë‹¨ê³„-ì„¤ê³„">ğŸ“ˆ ë‹¤ìŒ ë‹¨ê³„ ì„¤ê³„&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ê¸°ê°„&lt;/th>
&lt;th>ëª©í‘œ&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>2025ë…„ 8ì›”&lt;/td>
&lt;td>Kubeflow ê¸°ë°˜ ì¬êµ¬ì„± + ëª¨ë¸ ìë™ íŠœë‹ ì‹¤í—˜&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2025ë…„ 9ì›”&lt;/td>
&lt;td>Triton Inference Server ì—°ë™ + GPU ì„œë¹™ ì‹¤ìŠµ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2025ë…„ 10ì›”&lt;/td>
&lt;td>ScyllaDB &amp;amp; LLM ì„œë¹™ êµ¬ì¡° ì‹¤í—˜&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ì—°ë§&lt;/td>
&lt;td>MLOps í¬íŠ¸í´ë¦¬ì˜¤ ì •ë¦¬ ë° ì§€ì›ì„œ ì‘ì„±&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-ë§ˆì¹˜ë©°">âœ¨ ë§ˆì¹˜ë©°&lt;/h2>
&lt;p>ì´ë²ˆ ì‹œë¦¬ì¦ˆëŠ” ë‹¨ìˆœí•œ í•™ìŠµì´ ì•„ë‹ˆë¼, ì„¤ê³„ì— ëŒ€í•´ ê³ ë¯¼í•˜ë©°&lt;/p></description></item><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 6ë‹¨ê³„: ì‹¤ì‹œê°„ ëª¨ë¸ í•«ìŠ¤ì™‘ êµ¬ì¡° ì‹¤í—˜]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/06/</link><pubDate>Thu, 10 Jul 2025 17:12:00 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/06/</guid><description>&lt;h2 id="-tldr">âœ… TL;DR&lt;/h2>
&lt;ul>
&lt;li>&lt;code>Airflow&lt;/code>ì—ì„œ ì„ íƒí•œ ëª¨ë¸ ë²„ì „ì— ë”°ë¼ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë‹¤ë¥´ê²Œ ì‹¤í–‰&lt;/li>
&lt;li>í•™ìŠµëœ ëª¨ë¸ì„ &lt;code>MLflow Model Registry&lt;/code>ì— ë“±ë¡ â†’ Production ë‹¨ê³„ë¡œ ìë™ ìŠ¹ê²©&lt;/li>
&lt;li>&lt;code>FastAPI&lt;/code> ì„œë²„ëŠ” &lt;code>Production ëª¨ë¸&lt;/code>ì„ ë‹¤ì‹œ ë¡œë“œ â†’ ë³„ë„ ì½”ë“œ ìˆ˜ì • ì—†ì´ í•«ìŠ¤ì™‘ ì™„ë£Œ&lt;/li>
&lt;li>ì‹¤ë¬´ì—ì„œ ëª¨ë¸ ê²€ì¦/ë°°í¬ ì‚¬ì´í´ ìë™í™”ì— ë°”ë¡œ ì‘ìš© ê°€ëŠ¥&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-êµ¬ì¡°-ë‹¤ì´ì–´ê·¸ë¨-í•«ìŠ¤ì™‘-íë¦„">ğŸ§  êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨ (í•«ìŠ¤ì™‘ íë¦„)&lt;/h2>
&lt;pre tabindex="0">&lt;code class="language-mermaid" data-lang="mermaid">flowchart TD
A1[Airflow DAG: ëª¨ë¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰] --&amp;gt; B1[MLflow ëª¨ë¸ ë“±ë¡ - ë²„ì „ ì„ íƒ]
B1 --&amp;gt; C1[ëª¨ë¸ Production ìŠ¹ê²©]
C1 --&amp;gt; D1[FastAPI ì„œë²„ ì¬ì‹œì‘]
D1 --&amp;gt; E1[FastAPI â†’ ìµœì‹  ëª¨ë¸ ë¡œë“œ]
E1 --&amp;gt; F1[ì¶”ë¡  API ì„œë¹™]
subgraph ì‹¤í—˜ ê´€ë¦¬
B1
C1
end
subgraph ì¶”ë¡  ì„œë¹„ìŠ¤
D1
E1
F1
end
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-í•µì‹¬-êµ¬ì„±-ìš”ì†Œ">ğŸ§© í•µì‹¬ êµ¬ì„± ìš”ì†Œ&lt;/h2>
&lt;h3 id="1-airflow-dag---ëª¨ë¸-ë²„ì „-ì„ íƒ">1. Airflow DAG - ëª¨ë¸ ë²„ì „ ì„ íƒ&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># dags/train_promote_pipeline_share.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.bash &lt;span style="color:#f92672">import&lt;/span> BashOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.models &lt;span style="color:#f92672">import&lt;/span> Variable
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>default_args &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;start_date&amp;#39;&lt;/span>: datetime(&lt;span style="color:#ae81ff">2023&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;train_promote_pipeline_share&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> default_args&lt;span style="color:#f92672">=&lt;/span>default_args,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tags&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;ml&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;train&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># moedel_version ë³€ìˆ˜ default_var ì§€ì •&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_version &lt;span style="color:#f92672">=&lt;/span> Variable&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;model_version&amp;#34;&lt;/span>, default_var&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;v1&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> debug_aws &lt;span style="color:#f92672">=&lt;/span> BashOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;debug_aws_credentials&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;echo $HOME &amp;amp;&amp;amp; ls -al $HOME/.aws &amp;amp;&amp;amp; cat $HOME/.aws/credentials&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> env&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#e6db74">&amp;#34;HOME&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/home/airflow&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_train_script &lt;span style="color:#f92672">=&lt;/span> BashOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;run_train_script&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># merdel_version ë³€ìˆ˜í™”&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#39;python /opt/airflow/dags/repo/ml_code/train_model_&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model_version&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">.py&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> env&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#e6db74">&amp;#34;HOME&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/home/airflow&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> promote_model &lt;span style="color:#f92672">=&lt;/span> BashOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;promote_model_to_production&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;python /opt/airflow/dags/repo/ml_code/promote_model.py&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> env&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#e6db74">&amp;#34;HOME&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/home/airflow&amp;#34;&lt;/span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> debug_aws &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> run_train_script &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> promote_model
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>â†’ &lt;code>Airflow UI &amp;gt; Admin &amp;gt; Variables&lt;/code> ì—ì„œ &lt;code>model_version = v1&lt;/code> ë˜ëŠ” &lt;code>v2&lt;/code> ì„¤ì • ê°€ëŠ¥&lt;/p></description></item><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 4ë‹¨ê³„: Airflow : GitSync + ì™¸ë¶€ PostgreSQL + Secret ì—°ë™]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/04/</link><pubDate>Thu, 03 Jul 2025 17:11:53 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/04/</guid><description>&lt;h2 id="-tldr">âœ¨ TL;DR&lt;/h2>
&lt;ul>
&lt;li>Helmì„ í†µí•´ Airflowë¥¼ ë°°í¬í•˜ë©´ì„œ DAG ì½”ë“œë¥¼ Git ì €ì¥ì†Œì—ì„œ ìë™ìœ¼ë¡œ ë™ê¸°í™”í•˜ëŠ” êµ¬ì¡° ì„¤ê³„&lt;/li>
&lt;li>GitSync, Secret ê¸°ë°˜ SSH ì¸ì¦, ì™¸ë¶€ PostgreSQL, AWS S3 ì—°ë™ê¹Œì§€ í¬í•¨í•´ êµ¬ì„±&lt;/li>
&lt;li>UI ì ‘ê·¼ì€ Ingressë¥¼ í†µí•´ ì´ë£¨ì–´ì§€ë©°, ë¡œê·¸ëŠ” PVC ë˜ëŠ” S3ë¡œ ì„¤ì • ê°€ëŠ¥&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„">ğŸ“ ì•„í‚¤í…ì²˜ êµ¬ì„±ë„&lt;/h2>
&lt;pre tabindex="0">&lt;code class="language-mermaid" data-lang="mermaid">flowchart TD
subgraph K8s_Cluster[&amp;#34;Kubernetes Cluster&amp;#34;]
Scheduler[(Airflow Scheduler Pod)]
Worker[(Airflow Worker Pod)]
Webserver[(Airflow Webserver Pod)]
end
subgraph DAG_Repo[&amp;#34;Git Repository&amp;#34;]
DAG[(airflow-dags.git)]
end
subgraph Secrets[&amp;#34;K8s Secrets + Configs&amp;#34;]
SecretAWS[(aws-credentials-secret)]
SecretDB[(airflow-db-secret)]
end
subgraph External[&amp;#34;External Systems&amp;#34;]
PG[(PostgreSQL: External Metadata DB)]
NFS[(NFS: airflow-logs-pvc)]
end
%% GitSync
DAG --&amp;gt; Scheduler
DAG --&amp;gt; Worker
DAG --&amp;gt; Webserver
%% Secret ì£¼ì…
SecretAWS --&amp;gt; Scheduler
SecretAWS --&amp;gt; Worker
SecretAWS --&amp;gt; Webserver
SecretDB --&amp;gt; Scheduler
%% ì™¸ë¶€ ì—°ë™
Scheduler --&amp;gt; PG
Scheduler --&amp;gt; NFS
Worker --&amp;gt; NFS
Webserver --&amp;gt; NFS
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì»¤ìŠ¤í…€-airflow-ì´ë¯¸ì§€-êµ¬ì„±">ğŸ³ ì»¤ìŠ¤í…€ Airflow ì´ë¯¸ì§€ êµ¬ì„±&lt;/h2>
&lt;p>GitSync DAGì—ì„œ MLflow ì—°ë™ ë˜ëŠ” AWS SDK ì‚¬ìš©ì„ ìœ„í•œ Python íŒ¨í‚¤ì§€ ì„¤ì¹˜ í•„ìš”&lt;/p></description></item><item><title>[Airflow ê¸°ì´ˆ ìë™í™” - Airflow â†’ MLflow â†’ FastAPI]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/basic/</link><pubDate>Fri, 13 Jun 2025 20:58:51 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/basic/</guid><description>&lt;h2 id="-ì „ì²´-íë¦„-ì˜ˆì‹œ">ğŸ§­ ì „ì²´ íë¦„ ì˜ˆì‹œ&lt;/h2>
&lt;pre tabindex="0">&lt;code>[AIRFLOW DAG ì‹¤í–‰]
â†“
[train_mlflow.py]
- iris ëª¨ë¸ í•™ìŠµ
- íŒŒë¼ë¯¸í„°/ë©”íŠ¸ë¦­ ë¡œê¹…
- ëª¨ë¸ Registry ë“±ë¡
â†“
[promote_mlflow.py]
- ìµœì‹  ëª¨ë¸ì„ Productionìœ¼ë¡œ ì „í™˜
â†“
[FastAPI]
- models:/IrisModel/Production â†’ ì‹¤ì‹œê°„ ì˜ˆì¸¡
&lt;/code>&lt;/pre>&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow_mlflow_fastapi_dockerCompose">ğŸ”— GitHub (Airflow + MLflow + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-1ë‹¨ê³„-í”„ë¡œì íŠ¸-ê¸°ë³¸-í´ë”-êµ¬ì¡°-ì„¤ê³„">âœ… [1ë‹¨ê³„] í”„ë¡œì íŠ¸ ê¸°ë³¸ í´ë” êµ¬ì¡° ì„¤ê³„&lt;/h2>
&lt;h3 id="-1-ì „ì²´-ë””ë ‰í† ë¦¬-êµ¬ì„±ë„">ğŸ“ 1. ì „ì²´ ë””ë ‰í† ë¦¬ êµ¬ì„±ë„&lt;/h3>
&lt;pre tabindex="0">&lt;code>mlops_project/
â”œâ”€â”€ airflow/ ğŸ›« Airflow ì„¤ì • ë° DAG ìŠ¤ì¼€ì¤„ëŸ¬
â”‚ â”œâ”€â”€ dags/ â† DAG ì •ì˜ ë””ë ‰í† ë¦¬
â”‚ â”‚ â””â”€â”€ train_with_mlflow.py â† í•™ìŠµ DAG (MLflow ì—°ë™)
â”‚ â”œâ”€â”€ Dockerfile.airflow â† Airflowìš© Dockerfile
â”‚ â”œâ”€â”€ requirements.txt â† Airflow ì˜ì¡´ì„±
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ fastapi/ âš¡ FastAPI ì˜ˆì¸¡ API ì„œë²„
â”‚ â”œâ”€â”€ app/
â”‚ â”‚ â””â”€â”€ main.py â† ëª¨ë¸ ì„œë¹™ ì—”ë“œí¬ì¸íŠ¸
â”‚ â”œâ”€â”€ Dockerfile.api â† FastAPIìš© Dockerfile
â”‚ â”œâ”€â”€ requirements.txt â† FastAPI ì˜ì¡´ì„±
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ ml_code/ ğŸ§  ML í•™ìŠµ ë° í”„ë¡œëª¨ì…˜ ì½”ë“œ
â”‚ â”œâ”€â”€ train_mlflow.py â† ëª¨ë¸ í•™ìŠµ ë° MLflow ë¡œê¹…
â”‚ â””â”€â”€ promte_mlflow.py â† ëª¨ë¸ í”„ë¡œëª¨ì…˜ (Staging â†’ Production)
â”‚
â”œâ”€â”€ mlflow_store/ ğŸ—‚ï¸ MLflow ì €ì¥ì†Œ ê²½ë¡œ (ë³¼ë¥¨)
â”‚ â”œâ”€â”€ Dockerfile.mlflow â† MLflow ì„œë²„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
â”‚ â”œâ”€â”€ mlflow.db â† Model Registry DB (sqlite)
â”‚ â”œâ”€â”€ mlruns/ â† ì‹¤í—˜ ë¡œê·¸ ë””ë ‰í† ë¦¬
â”‚ â”œâ”€â”€ artifacts/ â† ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ docker-compose.yaml ğŸ§© ì „ì²´ ì„œë¹„ìŠ¤ êµ¬ì„± ì •ì˜
â”œâ”€â”€ .env ğŸ” ë¯¼ê° ì •ë³´ (.envë¡œ ë¶„ë¦¬)
â”œâ”€â”€ README.md ğŸ“ ì „ì²´ í”„ë¡œì íŠ¸ ë¬¸ì„œí™”
â”œâ”€â”€ .gitignore
â””â”€â”€ .dockerignore
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-2ë‹¨ê³„-docker-composeyaml-í†µí•©-êµ¬ì„±">âœ… [2ë‹¨ê³„] &lt;code>docker-compose.yaml&lt;/code> í†µí•© êµ¬ì„±&lt;/h2>
&lt;h3 id="-êµ¬ì„±-ëª©í‘œ">ğŸ§­ êµ¬ì„± ëª©í‘œ&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ì„œë¹„ìŠ¤ëª…&lt;/th>
&lt;th>ì„¤ëª…&lt;/th>
&lt;th>í¬íŠ¸&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>airflow&lt;/code>&lt;/td>
&lt;td>DAG ì‹¤í–‰ í™˜ê²½ (webserver/scheduler)&lt;/td>
&lt;td>&lt;code>8080&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>postgres&lt;/code>&lt;/td>
&lt;td>Airflow ë©”íƒ€ë°ì´í„° ì €ì¥ìš© DB&lt;/td>
&lt;td>ë‚´ë¶€ í†µì‹ &lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>mlflow&lt;/code>&lt;/td>
&lt;td>MLflow UI + Registry ê¸°ëŠ¥&lt;/td>
&lt;td>&lt;code>5000&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fastapi&lt;/code>&lt;/td>
&lt;td>ì¶”ë¡  API ì„œë²„ (ëª¨ë¸ ë¡œë”©)&lt;/td>
&lt;td>&lt;code>8000&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>ì´ë¯¸ì§€ ì‚¬ìš©ì‹œ ì£¼ì˜ (UIë§Œ ì œê³µí•˜ëŠ” ì´ë¯¸ì§€ ì¡´ì¬)&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="-docker-composeyaml-ì „ì²´-ì˜ˆì‹œ">ğŸ“„ &lt;code>docker-compose.yaml&lt;/code> ì „ì²´ ì˜ˆì‹œ&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3.8&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ“¦ PostgreSQL: Airflow ë©”íƒ€ë°ì´í„° ì €ì¥ìš© DB&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">postgres&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">postgres:13&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env_file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">.env &lt;/span> &lt;span style="color:#75715e"># â† ë¯¼ê°ì •ë³´ ë¶„ë¦¬ (ì•„ì´ë””/ë¹„ë²ˆ)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_USER&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_USER}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_PASSWORD&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_PASSWORD}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_DB&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_DB}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>: &lt;span style="color:#75715e"># â† ì½”ë“œ/ë°ì´í„° ê³µìœ  ë° ì˜ì†ì„± ë³´ì¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">postgres_data:/var/lib/postgresql/data &lt;/span> &lt;span style="color:#75715e"># â† DB ë°ì´í„° ìœ ì§€ (ì¬ì‹œì‘ ëŒ€ë¹„)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ›« Airflow: DAG ìŠ¤ì¼€ì¤„ëŸ¬ ë° íƒœìŠ¤í¬ ì‹¤í–‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">airflow&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./airflow &lt;/span> &lt;span style="color:#75715e"># â†’ Airflow ì „ìš© Dockerfile ê²½ë¡œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.airflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">airflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#ae81ff">standalone &lt;/span> &lt;span style="color:#75715e"># â†’ ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ê°„ë‹¨ ì‹¤í–‰ ëª…ë ¹ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># (- Scheduler + Webserver + DB ì´ˆê¸°í™”ê¹Œì§€ ìë™ìœ¼ë¡œ í•œë²ˆì— ì‹¤í–‰)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># (- ì‹¤ë¬´/ìš´ì˜ì—ì„œëŠ” airflow-webserver, airflow-scheduler í•„ë“œ ë¶„ë¦¬)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8080:8080&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ Airflow ì›¹ UI (localhost:8080)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">depends_on&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">postgres &lt;/span> &lt;span style="color:#75715e"># â†’ DBê°€ ë¨¼ì € ì˜¬ë¼ì™€ì•¼ Airflow ì‹œì‘ ê°€ëŠ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env_file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">.env&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Airflow ë©”íƒ€ë°ì´í„° DB ì—°ê²° ì£¼ì†Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">AIRFLOW__CORE__SQL_ALCHEMY_CONN&lt;/span>: &lt;span style="color:#ae81ff">${AIRFLOW__CORE__SQL_ALCHEMY_CONN}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Airflow ì˜ˆì œ DAG ë¶ˆëŸ¬ì˜¬ì§€ ì—¬ë¶€&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">AIRFLOW__CORE__LOAD_EXAMPLES&lt;/span>: &lt;span style="color:#ae81ff">${AIRFLOW__CORE__LOAD_EXAMPLES} &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">MLFLOW_TRACKING_URI&lt;/span>: &lt;span style="color:#ae81ff">http://mlflow:5000 &lt;/span> &lt;span style="color:#75715e"># â†’ DAG ì½”ë“œì—ì„œ MLflow ì—°ë™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./airflow/dags:/opt/airflow/dags &lt;/span> &lt;span style="color:#75715e"># DAG íŒŒì¼ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./ml_code:/opt/airflow/ml_code &lt;/span> &lt;span style="color:#75715e"># í•™ìŠµ ì½”ë“œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ëª¨ë¸ ì €ì¥ì†Œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ”¬ MLflow: ì‹¤í—˜ ì¶”ì  + ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë²„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mlflow&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./mlflow_store &lt;/span> &lt;span style="color:#75715e"># ì»¤ìŠ¤í…€ Dockerfile ìœ„ì¹˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.mlflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;5000:5000&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ MLflow UI (localhost:5000)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ì‹¤í—˜ ë¡œê·¸ + DB + artifacts ì €ì¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">MLFLOW_TRACKING_URI=http://0.0.0.0:5000 &lt;/span> &lt;span style="color:#75715e"># ë‚´ë¶€ ì»¨í…Œì´ë„ˆ ê¸°ì¤€ URI&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># âš¡ FastAPI: ëª¨ë¸ ì„œë¹™ API&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">fastapi&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./fastapi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.api&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">fastapi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8000:8000&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ ì˜ˆì¸¡ API ì—”ë“œí¬ì¸íŠ¸ (localhost:8000)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./fastapi/app:/app/app &lt;/span> &lt;span style="color:#75715e"># FastAPI app ë””ë ‰í† ë¦¬ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./ml_code:/app/ml_code &lt;/span> &lt;span style="color:#75715e"># í•™ìŠµ/ëª¨ë¸ ì½”ë“œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ì €ì¥ëœ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•œ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ğŸ—‚ï¸ ë³¼ë¥¨ ì •ì˜ (Postgres DB ì˜ì†ì„± ìœ ì§€)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">postgres_data&lt;/span>:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ì¶”ê°€ë¡œ-í•´ì•¼-í• -ê²ƒ">ğŸ ì¶”ê°€ë¡œ í•´ì•¼ í•  ê²ƒ&lt;/h2>
&lt;ul>
&lt;li>Airflow ì²« ì‹¤í–‰ í›„ì—” ë³´í†µ &lt;strong>ê´€ë¦¬ì ê³„ì • ìƒì„±&lt;/strong>ë„ í•´ì¤˜ì•¼ í•¨:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># airflow ì»¨í…Œì´ë„ˆ ì ‘ì†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker exec -it airflow bash
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ê´€ë¦¬ì ê³„ì • ìƒì„±&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>airflow users create &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --username airflow &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --password airflow &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --firstname Keoho &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --lastname Ban &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --role Admin &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --email airflow@example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="-êµ¬ì¶•-tip-airflow-fastapi-mlflow-ê°„-ê³µìœ -ë³¼ë¥¨-êµ¬ì¡°-í™•ì¸">ğŸ” [êµ¬ì¶• Tip] &lt;strong>Airflow, FastAPI, MLflow ê°„ ê³µìœ  ë³¼ë¥¨ êµ¬ì¡° í™•ì¸&lt;/strong>&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ê³µìœ  ë¦¬ì†ŒìŠ¤&lt;/th>
&lt;th>ì„¤ëª…&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (MLflow)&lt;/td>
&lt;td>MLflow ì„œë²„ê°€ ì“°ëŠ” ë¡œê·¸/ëª¨ë¸ ì €ì¥ì†Œ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (Airflow)&lt;/td>
&lt;td>í•™ìŠµ í›„ ëª¨ë¸ ì €ì¥ ìœ„ì¹˜ ê³µìœ &lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (FastAPI)&lt;/td>
&lt;td>ëª¨ë¸ ì¶”ë¡  ì‹œ ë¡œë“œ ê²½ë¡œ ê³µìœ &lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>â¡ &lt;strong>ê²½ë¡œ í†µì¼ì„±&lt;/strong>ì´ ë§¤ìš° ì¤‘ìš”í•¨! ì§€ê¸ˆì€ ëª¨ë‘ &lt;code>./mlflow&lt;/code>ë¡œ ê³µìœ  (./mlflow í•˜ìœ„ì— /mlruns ì¡´ì¬)&lt;/p></description></item><item><title>[Airflow - 5ë‹¨ê³„: PythonOperator + MLflow Tracking ì—°ë™]</title><link>https://keonhoban.github.io/mlops-journey/posts/airflow/05/</link><pubDate>Tue, 10 Jun 2025 19:49:29 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/airflow/05/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;p>PythonOperatorë¥¼ ì‚¬ìš©í•˜ì—¬ MLflowë¡œ ì‹¤í—˜(ëª¨ë¸ í•™ìŠµ)ì„ ìë™í™”í•˜ê³ , íŒŒë¼ë¯¸í„°, ë©”íŠ¸ë¦­, ëª¨ë¸ì„ ê¸°ë¡í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤.&lt;/p>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow/05_Airflow_and_MLflow">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>[1ë‹¨ê³„] MLflow ì‹¤í—˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
[2ë‹¨ê³„] Airflow DAG êµ¬ì„±
[3ë‹¨ê³„] DAG ì‹¤í–‰ ë° íŒŒë¼ë¯¸í„°/ë©”íŠ¸ë¦­ í™•ì¸
[4ë‹¨ê³„] ëª¨ë¸ ì €ì¥ ë° ë¡œê¹… ìƒíƒœ ì ê²€
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ë””ë ‰í† ë¦¬-êµ¬ì¡°">ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°&lt;/h2>
&lt;pre tabindex="0">&lt;code>airflow/
â”œâ”€â”€ dags/
â”‚ â”œâ”€â”€ train_with_mlflow.py â† DAG íŒŒì¼
â”œâ”€â”€ ml_code/
â”‚ â”œâ”€â”€ train_mlflow.py â† MLflow ì—°ë™ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ mlruns/ â† MLflow ë¡œê¹… ê²°ê³¼ ì €ì¥ í´ë” (ìë™ ìƒì„±)
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-1ë‹¨ê³„-mlflow-í•™ìŠµ-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±">ğŸ§ª 1ë‹¨ê³„: MLflow í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># airflow/ml_code/train_mlflow.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow.sklearn
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.datasets &lt;span style="color:#f92672">import&lt;/span> load_iris
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.ensemble &lt;span style="color:#f92672">import&lt;/span> RandomForestClassifier
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.metrics &lt;span style="color:#f92672">import&lt;/span> accuracy_score
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">run_experiment&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>set_tracking_uri(&lt;span style="color:#e6db74">&amp;#34;file:/opt/airflow/mlruns&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>set_experiment(&lt;span style="color:#e6db74">&amp;#34;airflow_mlflow_example&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> mlflow&lt;span style="color:#f92672">.&lt;/span>start_run():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ë°ì´í„° ë¡œë”©&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> data &lt;span style="color:#f92672">=&lt;/span> load_iris()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> X, y &lt;span style="color:#f92672">=&lt;/span> data&lt;span style="color:#f92672">.&lt;/span>data, data&lt;span style="color:#f92672">.&lt;/span>target
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ëª¨ë¸ ì •ì˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model &lt;span style="color:#f92672">=&lt;/span> RandomForestClassifier(n_estimators&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">50&lt;/span>, max_depth&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model&lt;span style="color:#f92672">.&lt;/span>fit(X, y)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> preds &lt;span style="color:#f92672">=&lt;/span> model&lt;span style="color:#f92672">.&lt;/span>predict(X)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> acc &lt;span style="color:#f92672">=&lt;/span> accuracy_score(y, preds)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># MLflow ê¸°ë¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;n_estimators&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">50&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;max_depth&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_metric(&lt;span style="color:#e6db74">&amp;#34;accuracy&amp;#34;&lt;/span>, acc)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>sklearn&lt;span style="color:#f92672">.&lt;/span>log_model(model, &lt;span style="color:#e6db74">&amp;#34;model&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-2ë‹¨ê³„-airflow-dag-ì‘ì„±">ğŸ§ª 2ë‹¨ê³„: Airflow DAG ì‘ì„±&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># airflow/dags/train_with_mlflow.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.python &lt;span style="color:#f92672">import&lt;/span> PythonOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sys&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#34;/opt/airflow/ml_code&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> train_mlflow &lt;span style="color:#f92672">import&lt;/span> run_experiment
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;mlflow_tracking_dag&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> start_date&lt;span style="color:#f92672">=&lt;/span>datetime(&lt;span style="color:#ae81ff">2023&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule_interval&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_mlflow &lt;span style="color:#f92672">=&lt;/span> PythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;run_mlflow_training&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>run_experiment,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ì‹¤í–‰-ì ˆì°¨">âœ… ì‹¤í–‰ ì ˆì°¨&lt;/h2>
&lt;ol>
&lt;li>&lt;code>train_mlflow.py&lt;/code> ì‘ì„±&lt;/li>
&lt;li>&lt;code>train_with_mlflow.py&lt;/code> DAG ë“±ë¡&lt;/li>
&lt;li>Airflow UIì—ì„œ DAG ì‹¤í–‰&lt;/li>
&lt;li>Task ë¡œê·¸ì—ì„œ íŒŒë¼ë¯¸í„°/ë©”íŠ¸ë¦­/ëª¨ë¸ ê¸°ë¡ í™•ì¸&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="ëª¨ë“ˆ-ì—ëŸ¬ê°€-ë°œìƒí•˜ë©´">â“ëª¨ë“ˆ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´?&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>&lt;code>docker-compose.yaml&lt;/code>ì—ì„œ &lt;code>volumes:&lt;/code> í•­ëª© í™•ì¸&lt;/p></description></item><item><title>[Airflow - 4ë‹¨ê³„: BashOperatorë¡œ ì™¸ë¶€ Python í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰]</title><link>https://keonhoban.github.io/mlops-journey/posts/airflow/04/</link><pubDate>Tue, 10 Jun 2025 19:49:27 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/airflow/04/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;ol>
&lt;li>&lt;code>train.py&lt;/code> ëª¨ë¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³„ë„ íŒŒì¼ë¡œ ì‘ì„±&lt;/li>
&lt;li>Airflow DAGì—ì„œ í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ &lt;code>BashOperator&lt;/code>ë¡œ ì‹¤í–‰&lt;/li>
&lt;li>ëª¨ë¸ í•™ìŠµ ë° ê²°ê³¼ í™•ì¸&lt;/li>
&lt;/ol>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow/04_BashOperator_and_Python_ML_Script">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>[1ë‹¨ê³„] í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
[2ë‹¨ê³„] BashOperatorë¡œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ DAG êµ¬ì„±
[3ë‹¨ê³„] Airflow ì›¹ UIì—ì„œ ì‹¤í–‰ ë° ë¡œê·¸ í™•ì¸
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ë””ë ‰í† ë¦¬-êµ¬ì¡°">ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°&lt;/h2>
&lt;pre tabindex="0">&lt;code>airflow/
â”œâ”€â”€ dags/
â”‚ â””â”€â”€ run_train_script.py â† DAG íŒŒì¼
â”œâ”€â”€ ml_code/
â”‚ â”œâ”€â”€ train.py â† ëª¨ë¸ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚ â””â”€â”€ model.pkl â† í•™ìŠµëœ ëª¨ë¸ íŒŒì¼
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-1ë‹¨ê³„-í•™ìŠµ-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±-trainpy">ğŸ§ª [1ë‹¨ê³„] í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± (&lt;code>train.py&lt;/code>)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># airflow/ml_code/train.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pickle
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.datasets &lt;span style="color:#f92672">import&lt;/span> load_iris
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.ensemble &lt;span style="color:#f92672">import&lt;/span> RandomForestClassifier
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ë°ì´í„° ë¡œë”©&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>data &lt;span style="color:#f92672">=&lt;/span> load_iris()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>X, y &lt;span style="color:#f92672">=&lt;/span> data&lt;span style="color:#f92672">.&lt;/span>data, data&lt;span style="color:#f92672">.&lt;/span>target
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ëª¨ë¸ í•™ìŠµ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model &lt;span style="color:#f92672">=&lt;/span> RandomForestClassifier()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model&lt;span style="color:#f92672">.&lt;/span>fit(X, y)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ëª¨ë¸ ì €ì¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model_path &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/opt/airflow/ml_code/model.pkl&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(model_path, &lt;span style="color:#e6db74">&amp;#34;wb&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pickle&lt;span style="color:#f92672">.&lt;/span>dump(model, f)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ëª¨ë¸ì€ /opt/airflow/ml_code/model.pkl ê²½ë¡œì— ì €ì¥ë©ë‹ˆë‹¤.&lt;/p></description></item><item><title>[Airflow - 3ë‹¨ê³„: ML íŒŒì´í”„ë¼ì¸ DAG êµ¬ì„±]</title><link>https://keonhoban.github.io/mlops-journey/posts/airflow/03/</link><pubDate>Sat, 07 Jun 2025 19:30:16 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/airflow/03/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;p>ML ì›Œí¬í”Œë¡œìš°ë¥¼ DAG í˜•íƒœë¡œ êµ¬ì„±í•˜ì—¬&lt;/p>
&lt;p>ë°ì´í„° ì¤€ë¹„ â†’ ëª¨ë¸ í•™ìŠµ â†’ ëª¨ë¸ ì €ì¥ íë¦„ì„ ì‹œë®¬ë ˆì´ì…˜í•¨&lt;/p>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow/03_ML_Pipeline">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>â‘  load_data (ê°€ìƒ ë°ì´í„° ê²½ë¡œ ë¦¬í„´)
â‘¡ train_model (ë°ì´í„° ê²½ë¡œ ë°›ì•„ í•™ìŠµ í‰ë‚´)
â‘¢ save_model (ëª¨ë¸ ê²½ë¡œ ë°›ì•„ ì €ì¥ ì™„ë£Œ ë©”ì‹œì§€)
â†’ XComì„ í†µí•´ ë‹¨ê³„ë³„ ê²°ê³¼ ì „ë‹¬
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ë””ë ‰í† ë¦¬-ì˜ˆì‹œ">ğŸ“ ì‹¤ìŠµ ë””ë ‰í† ë¦¬ ì˜ˆì‹œ&lt;/h2>
&lt;pre tabindex="0">&lt;code>airflow/
â””â”€â”€ dags/
â””â”€â”€ ml_simulation.py
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì½”ë“œ-ml_simulationpy">ğŸ§ª ì‹¤ìŠµ ì½”ë“œ (ml_simulation.py)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.python &lt;span style="color:#f92672">import&lt;/span> PythonOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">load_data&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;ğŸ“¥ ë°ì´í„° ë¡œë”© ì™„ë£Œ (ê°€ìƒ)&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;data_path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/tmp/fake_data.csv&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">train_model&lt;/span>(&lt;span style="color:#f92672">**&lt;/span>context):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> data &lt;span style="color:#f92672">=&lt;/span> context[&lt;span style="color:#e6db74">&amp;#39;ti&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>xcom_pull(task_ids&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;load_data&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ğŸ§ª ë°ì´í„° ê²½ë¡œ: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>data[&lt;span style="color:#e6db74">&amp;#39;data_path&amp;#39;&lt;/span>]&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;ğŸš€ ëª¨ë¸ í•™ìŠµ ì™„ë£Œ (ê°€ìƒ)&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;model_path&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/tmp/fake_model.pkl&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">save_model&lt;/span>(&lt;span style="color:#f92672">**&lt;/span>context):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model &lt;span style="color:#f92672">=&lt;/span> context[&lt;span style="color:#e6db74">&amp;#39;ti&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>xcom_pull(task_ids&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;train_model&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ğŸ’¾ ëª¨ë¸ ì €ì¥ ê²½ë¡œ: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model[&lt;span style="color:#e6db74">&amp;#39;model_path&amp;#39;&lt;/span>]&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;âœ… ì €ì¥ ì™„ë£Œ (ê°€ìƒ)&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;ml_simulation&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> start_date&lt;span style="color:#f92672">=&lt;/span>datetime(&lt;span style="color:#ae81ff">2023&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule_interval&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1 &lt;span style="color:#f92672">=&lt;/span> PythonOperator(task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;load_data&amp;#39;&lt;/span>, python_callable&lt;span style="color:#f92672">=&lt;/span>load_data)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t2 &lt;span style="color:#f92672">=&lt;/span> PythonOperator(task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;train_model&amp;#39;&lt;/span>, python_callable&lt;span style="color:#f92672">=&lt;/span>train_model, provide_context&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t3 &lt;span style="color:#f92672">=&lt;/span> PythonOperator(task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;save_model&amp;#39;&lt;/span>, python_callable&lt;span style="color:#f92672">=&lt;/span>save_model, provide_context&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> t2 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> t3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>âœ… ì €ì¥ ê²½ë¡œ: dags/ml_simulation.py&lt;/p></description></item><item><title>[Airflow - 2ë‹¨ê³„: Python &amp; Bash Operator + XCom ë°ì´í„° ì „ë‹¬]</title><link>https://keonhoban.github.io/mlops-journey/posts/airflow/02/</link><pubDate>Sat, 07 Jun 2025 19:30:15 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/airflow/02/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;ol>
&lt;li>Python í•¨ìˆ˜ì™€ Bash ìŠ¤í¬ë¦½íŠ¸ë¥¼ í•˜ë‚˜ì˜ DAGìœ¼ë¡œ êµ¬ì„±&lt;/li>
&lt;li>XComì„ í™œìš©í•œ Task ê°„ ë°ì´í„° ì „ë‹¬ ì²´í—˜&lt;/li>
&lt;li>Web UIì—ì„œ ì‹¤í–‰ íë¦„ê³¼ ë¡œê·¸ í™•ì¸&lt;/li>
&lt;/ol>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow/02_PythonOperator_and_XCom">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>â‘  DAG ìƒì„±: PythonOperator + BashOperator ì¡°í•©
â‘¡ XComìœ¼ë¡œ íƒœìŠ¤í¬ ê°„ ë©”ì‹œì§€ ì „ë‹¬
â‘¢ ë¡œê·¸ë¡œ ì „ë‹¬ ë©”ì‹œì§€ í™•ì¸
â‘£ ì „ì²´ DAG ì‹¤í–‰ ë° ì˜ì¡´ì„± í™•ì¸
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-dag-íŒŒì¼-êµ¬ì¡°">ğŸ“ DAG íŒŒì¼ êµ¬ì¡°&lt;/h2>
&lt;pre tabindex="0">&lt;code>airflow/
â”œâ”€â”€ dags/
â”‚ â””â”€â”€ python_bash_xcom.py â† ì—¬ê¸° ì €ì¥
â””â”€â”€ docker-compose.yaml
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-dag-ì½”ë“œ-ì˜ˆì‹œ">ğŸ§± DAG ì½”ë“œ ì˜ˆì‹œ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.python &lt;span style="color:#f92672">import&lt;/span> PythonOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.bash &lt;span style="color:#f92672">import&lt;/span> BashOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">generate_message&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ğŸŒŸ Hello from PythonOperator!&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">print_xcom_message&lt;/span>(&lt;span style="color:#f92672">**&lt;/span>context):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> msg &lt;span style="color:#f92672">=&lt;/span> context[&lt;span style="color:#e6db74">&amp;#39;ti&amp;#39;&lt;/span>]&lt;span style="color:#f92672">.&lt;/span>xcom_pull(task_ids&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;generate_task&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;ğŸ“¬ XCom received message: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>msg&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;python_bash_xcom&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> start_date&lt;span style="color:#f92672">=&lt;/span>datetime(&lt;span style="color:#ae81ff">2023&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule_interval&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> generate_task &lt;span style="color:#f92672">=&lt;/span> PythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;generate_task&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>generate_message,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> consume_task &lt;span style="color:#f92672">=&lt;/span> PythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;consume_task&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>print_xcom_message,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> provide_context&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bash_task &lt;span style="color:#f92672">=&lt;/span> BashOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;bash_echo&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;echo &amp;#39;ğŸ‰ Bash task is running!&amp;#39;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> generate_task &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> consume_task &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> bash_task
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ì‹¤í–‰-ë°©ë²•-ìš”ì•½">ğŸ§ª ì‹¤í–‰ ë°©ë²• ìš”ì•½&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker-compose up -d &lt;span style="color:#75715e"># Airflow ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>ë¸Œë¼ìš°ì € ì ‘ì†: &lt;a href="http://localhost:8080/">http://localhost:8080&lt;/a>&lt;/li>
&lt;li>DAG ëª©ë¡ â†’ &lt;code>python_bash_xcom&lt;/code> ON&lt;/li>
&lt;li>â–¶ ë²„íŠ¼ í´ë¦­ â†’ Trigger DAG&lt;/li>
&lt;li>ê° Task í´ë¦­ â†’ Log íƒ­ì—ì„œ ì‹¤í–‰ ê²°ê³¼ í™•ì¸&lt;/li>
&lt;/ol>
&lt;hr>
&lt;h2 id="-ê²°ê³¼-í™•ì¸-í¬ì¸íŠ¸">ğŸ“Š ê²°ê³¼ í™•ì¸ í¬ì¸íŠ¸&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Task&lt;/th>
&lt;th>ë¡œê·¸ì—ì„œ í™•ì¸ ë‚´ìš©&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>generate_task&lt;/td>
&lt;td>&lt;code>&amp;quot;ğŸŒŸ Hello from PythonOperator!&amp;quot;&lt;/code> ë©”ì‹œì§€ ë¦¬í„´&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>consume_task&lt;/td>
&lt;td>&lt;code>ğŸ“¬ XCom received message:&lt;/code> ì¶œë ¥ í™•ì¸&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>bash_task&lt;/td>
&lt;td>&lt;code>'ğŸ‰ Bash task is running!'&lt;/code> ë¡œê·¸ í™•ì¸&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-ì‹¤ë¬´-íŒ">ğŸ§© ì‹¤ë¬´ íŒ&lt;/h2>
&lt;ul>
&lt;li>XComì€ &lt;strong>ê°„ë‹¨í•œ ë¬¸ìì—´/ê²½ë¡œ/ID ë“± ì†Œí˜• ë°ì´í„°&lt;/strong> ì „ë‹¬ì— ì í•©&lt;/li>
&lt;li>ëŒ€ìš©ëŸ‰ ê²°ê³¼ëŠ” S3/DBì— ì €ì¥ í›„ &lt;strong>ê²½ë¡œë§Œ XComìœ¼ë¡œ ì „ë‹¬&lt;/strong>í•˜ëŠ” ë°©ì‹ ì¶”ì²œ&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-mlops-ì‹¤ì „-ì—°ê²°">ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ì‹¤ë¬´ ì‹œë‚˜ë¦¬ì˜¤&lt;/th>
&lt;th>Airflow ì‚¬ìš© ë°©ì‹&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>í•™ìŠµ ê²°ê³¼ ì €ì¥&lt;/td>
&lt;td>&lt;code>train_model&lt;/code> â†’ &lt;code>register_model&lt;/code> íƒœìŠ¤í¬ë¡œ XCom ì „ë‹¬&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>íƒœìŠ¤í¬ ì—°ê²° íë¦„ ì¶”ì &lt;/td>
&lt;td>Graph Viewì—ì„œ DAG ì‹œê°í™”ë¡œ ê´€ë¦¬&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>í›„ì† ì‘ì—… ìë™í™”&lt;/td>
&lt;td>BashOperatorë¡œ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë“± ìë™í™” ê°€ëŠ¥&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>[Airflow - 1ë‹¨ê³„: ë¡œì»¬ í™˜ê²½ì—ì„œ ê¸°ë³¸ DAG ì‹¤í–‰]</title><link>https://keonhoban.github.io/mlops-journey/posts/airflow/01/</link><pubDate>Sat, 07 Jun 2025 19:29:36 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/airflow/01/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;ol>
&lt;li>Docker ê¸°ë°˜ Airflow í™˜ê²½ êµ¬ì„±&lt;/li>
&lt;li>DAG íŒŒì¼ì„ ì‘ì„±í•˜ê³  ì‹¤í–‰&lt;/li>
&lt;li>UIì—ì„œ ì›Œí¬í”Œë¡œìš° íë¦„ê³¼ ë¡œê·¸ë¥¼ ì§ì ‘ í™•ì¸&lt;/li>
&lt;/ol>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow/01_DAG_basic">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>â‘  Docker ì„¤ì¹˜ í™•ì¸
â‘¡ ê³µì‹ Airflow ì˜ˆì œ ë‹¤ìš´ë¡œë“œ
â‘¢ docker-compose ì‹¤í–‰
â‘£ DAG UI ì ‘ì† ë° ì‹¤í–‰
â‘¤ ë¡œê·¸ í™•ì¸ìœ¼ë¡œ ì •ìƒ ì—¬ë¶€ ê²€ì¦
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ë””ë ‰í† ë¦¬-êµ¬ì¡°">ğŸ“ ì‹¤ìŠµ ë””ë ‰í† ë¦¬ êµ¬ì¡°&lt;/h2>
&lt;pre tabindex="0">&lt;code>airflow/
â”œâ”€â”€ dags/ # DAG íŒŒì¼ ì‘ì„± ìœ„ì¹˜
â”œâ”€â”€ logs/ # ì‘ì—… ë¡œê·¸ ì €ì¥
â”œâ”€â”€ plugins/ # ì»¤ìŠ¤í…€ í”ŒëŸ¬ê·¸ì¸ (ì„ íƒ)
â”œâ”€â”€ docker-compose.yaml
â””â”€â”€ .env # AIRFLOW_UID í¬í•¨
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì£¼ìš”-ëª…ë ¹ì–´-ì •ë¦¬">ğŸ”§ ì£¼ìš” ëª…ë ¹ì–´ ì •ë¦¬&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Airflow ì˜ˆì œ ë‹¤ìš´ë¡œë“œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>git clone https://github.com/apache/airflow.git
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd airflow/dev &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> ./docker-compose/setup.sh
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ë˜ëŠ” ê°„ë‹¨í•œ ë²„ì „&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -LfO &lt;span style="color:#e6db74">&amp;#39;https://airflow.apache.org/docs/apache-airflow/2.8.2/docker-compose.yaml&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p ./dags ./logs ./plugins
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo -e &lt;span style="color:#e6db74">&amp;#34;AIRFLOW_UID=&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>id -u&lt;span style="color:#66d9ef">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &amp;gt; .env
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì„œë¹„ìŠ¤ ì‹¤í–‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker-compose up -d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì ‘ì†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>http://localhost:8080 &lt;span style="color:#f92672">(&lt;/span>ID/PW: airflow / airflow&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ìƒ˜í”Œ-dag-ì˜ˆì‹œ">ğŸ’¡ ìƒ˜í”Œ DAG ì˜ˆì‹œ&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.bash &lt;span style="color:#f92672">import&lt;/span> BashOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;hello_airflow&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> start_date&lt;span style="color:#f92672">=&lt;/span>datetime(&lt;span style="color:#ae81ff">2023&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#ae81ff">1&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule_interval&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;@daily&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1 &lt;span style="color:#f92672">=&lt;/span> BashOperator(task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;print_date&amp;#34;&lt;/span>, bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;date&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t2 &lt;span style="color:#f92672">=&lt;/span> BashOperator(task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;say_hello&amp;#34;&lt;/span>, bash_command&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;echo &amp;#39;Hello, Airflow!&amp;#39;&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> t1 &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> t2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ğŸ‘‰ dags/hello_airflow.py ë¡œ ì €ì¥&lt;/p></description></item></channel></rss>