<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>MLflow on ğŸ”ï¸ MLOps Journey</title><link>https://keonhoban.github.io/mlops-journey/categories/mlflow/</link><description>Recent content in MLflow on ğŸ”ï¸ MLOps Journey</description><generator>Hugo -- 0.145.0</generator><language>ko</language><lastBuildDate>Thu, 20 Nov 2025 17:10:21 +0900</lastBuildDate><atom:link href="https://keonhoban.github.io/mlops-journey/categories/mlflow/index.xml" rel="self" type="application/rss+xml"/><item><title>[MLOps í”Œë«í¼ Observability &amp; Data Pipeline - ì—í•„ë¡œê·¸]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_observability/01/</link><pubDate>Thu, 20 Nov 2025 17:10:21 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_observability/01/</guid><description>&lt;h2 id="ì—í•„ë¡œê·¸--ê´€ì¸¡ì•Œë¦¼ë°ì´í„°ê¹Œì§€-í•œ-ë²ˆì—-ì´ì–´ì§€ëŠ”-mlops-ìš´ì˜-í”Œë«í¼">ì—í•„ë¡œê·¸ â€” â€œê´€ì¸¡Â·ì•Œë¦¼Â·ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ì´ì–´ì§€ëŠ” MLOps ìš´ì˜ í”Œë«í¼â€&lt;/h2>
&lt;hr>
&lt;h2 id="-ì „ì²´-ê²½ë¡œ-ìš”ì•½">ğŸ“Œ ì „ì²´ ê²½ë¡œ ìš”ì•½&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ìˆœì„œ&lt;/th>
&lt;th>ì£¼ì œ&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/01/">ğŸ”— kube-prometheus-stack + GitOps êµ¬ì¶•&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/02/">ğŸ”— Alertmanager Slack &amp;amp; íŠ¸ëŸ¬ë¸”ìŠˆíŒ…&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/03/">ğŸ”— Prometheus/KSM/Kubelet ì™„ì „ ë¶„ë¦¬ êµ¬ì¡°&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>4&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/04/">ğŸ”— Loki/Promtail ë¡œê·¸ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/05/">ğŸ”— ìš´ì˜ ì¤‘ ë°œìƒí•œ ì‹¤ì œ ì´ìŠˆ &amp;amp; í•´ê²° ê³¼ì •&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/06/">ğŸ”— FastAPI Observability Dashboard &amp;amp; Alert Library&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>7&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/07/">ğŸ”— Data Pipeline êµ¬ì¶•&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>8&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/">ğŸ”— Data Pipeline ê³ ë„í™”&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>9&lt;/td>
&lt;td>&lt;a href="https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_observability/02/">ğŸ”— ê²€ì¦&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;hr>
&lt;h2 id="-ì „ì²´-íšŒê³ -ìš”ì•½">ğŸ¯ &lt;strong>ì „ì²´ íšŒê³  ìš”ì•½&lt;/strong>&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ë‹¨ê³„&lt;/th>
&lt;th>í•µì‹¬ ëª©í‘œ&lt;/th>
&lt;th>ì£¼ìš” ê°œì„ ì &lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>ëª¨ë‹ˆí„°ë§ ë¼ˆëŒ€ êµ¬ì¶•&lt;/td>
&lt;td>kube-prometheus-stack dev/prod ì™„ì „ ë¶„ë¦¬&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2&lt;/td>
&lt;td>Slack ì•ŒëŒ í†µí•©&lt;/td>
&lt;td>Alertmanager configSecret í‘œì¤€í™” + ì•ŒëŒ ë¼ìš°íŒ…&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>3&lt;/td>
&lt;td>ë©”íŠ¸ë¦­ êµì°¨ ìˆ˜ì§‘ ì œê±°&lt;/td>
&lt;td>KSM/Kubelet ë¼ë²¨ í†µì¼, Prometheus TSDB local-path&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>4&lt;/td>
&lt;td>ë¡œê·¸ íŒŒì´í”„ë¼ì¸ ì™„ì„±&lt;/td>
&lt;td>Loki/Promtail dev/prod ë¶„ë¦¬ + LogQL Range Query&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5&lt;/td>
&lt;td>ì‹¤ì œ ìš´ì˜ ì´ìŠˆ í•´ê²°&lt;/td>
&lt;td>ë¼ë²¨/Secret/NFS ê¶Œí•œ/NFS unmount ë¬¸ì œ ì¼ê´„ í•´ê²°&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>6&lt;/td>
&lt;td>FastAPI/Platform ê´€ì¸¡ ëŒ€ì‹œë³´ë“œ&lt;/td>
&lt;td>FastAPI ì„œë¹„ìŠ¤ + Kubernetes/Node í”Œë«í¼ ê´€ì¸¡ ì²´ê³„ ì™„ì„±&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>7&lt;/td>
&lt;td>Data Pipeline êµ¬ì¶• (v1)&lt;/td>
&lt;td>S3 Raw â†’ Feature ETL ìë™í™” (Airflow DAG)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>8&lt;/td>
&lt;td>Data Pipeline ê³ ë„í™” (v2)&lt;/td>
&lt;td>ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„° ìë™í™” + ê´€ì¸¡ ëŒ€ì‹œë³´ë“œ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>9&lt;/td>
&lt;td>ê²€ì¦&lt;/td>
&lt;td>Observability ê³„ì¸µ, Grafana ëŒ€ì‹œë³´ë“œ, Datapipeline&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;blockquote>
&lt;p>ğŸ”„ í•µì‹¬ ë¬¸ì¥:&lt;/p></description></item><item><title>[MLOps ìš´ì˜ ê³ ë„í™” - 5ë‹¨ê³„: Airflow ì•ˆì •í™” &amp; FastAPI HTTPS ë³´ì•ˆ]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/06/</link><pubDate>Mon, 18 Aug 2025 17:11:21 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/06/</guid><description>&lt;h2 id="airflow-ì•ˆì •í™”--fastapi-https-ë³´ì•ˆ-ì ìš©-cert-manager-ì–´ë…¸í…Œì´ì…˜-ë°˜ì˜-ì™„ë£Œ">Airflow ì•ˆì •í™” &amp;amp; FastAPI HTTPS ë³´ì•ˆ ì ìš© (cert-manager ì–´ë…¸í…Œì´ì…˜ ë°˜ì˜ ì™„ë£Œ)&lt;/h2>
&lt;hr>
&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>â€œëª¨ë¸ì„ ë“±ë¡í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì¤‘ìš”í•œ ê±´&lt;/p>
&lt;p>&lt;strong>ì–¸ì œ Reloadê°€ ì‹¤í–‰ë˜ëŠëƒ&lt;/strong>ì…ë‹ˆë‹¤. ì—¬ê¸°ê°€ ìš´ì˜ ì•ˆì •ì„±ì„ ë‚˜ëˆ„ëŠ” ì§€ì ì´ë‹ˆê¹Œìš”.â€&lt;/p>
&lt;p>â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” Airflow íë¦„ì„ í•œ ë²ˆ ë” ë‹¨ë‹¨íˆ ì¡°ì´ê³ ,&lt;/p>
&lt;p>FastAPI ìª½ì€ HTTPSÂ·í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ê¹Œì§€ ì ìš©í•´&lt;/p>
&lt;p>&lt;strong>â€˜ì•ˆì „í•˜ê²Œ ìë™í™”ëœë‹¤â€™ëŠ” í™•ì‹ ì„ ì£¼ëŠ” êµ¬ì¡°&lt;/strong>ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;h2 id="-í•µì‹¬-ìš”ì•½">ğŸ¯ í•µì‹¬ ìš”ì•½&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>Airflow&lt;/strong>: &lt;code>PythonSensor(mode=&amp;quot;reschedule&amp;quot;)&lt;/code>ë¡œ &lt;strong>READY ê°ì‹œ&lt;/strong>, &lt;code>TriggerRule.ALL_SUCCESS&lt;/code>ë¡œ &lt;strong>ì„±ê³µ ì²´ì¸ì—ì„œë§Œ&lt;/strong> &lt;code>/reload&lt;/code>&lt;/li>
&lt;li>&lt;strong>ë°ì´í„°/ìƒíƒœ ê¼¬ì„ ë°©ì§€&lt;/strong>: Variable ê²€ì¦ ìœ í‹¸ + XCom í‚¤ í‘œì¤€&lt;/li>
&lt;li>&lt;strong>FastAPI&lt;/strong>: Ingress &lt;strong>TLS(HTTPS) + IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸&lt;/strong> ê°•í™”&lt;/li>
&lt;li>&lt;strong>cert-manager + ClusterIssuer(self-signed)&lt;/strong> ìë™ ë°œê¸‰/ê°±ì‹ : &lt;strong>í…œí”Œë¦¿ì— ì–´ë…¸í…Œì´ì…˜ ìë™ ì£¼ì… ë°˜ì˜ ì™„ë£Œ&lt;/strong>&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="5-1-airflow-ì•ˆì •í™”-sensor-ë¦¬íŒ©í† ë§--xcomvariable-í‘œì¤€">5-1ï¸âƒ£ Airflow ì•ˆì •í™”: Sensor ë¦¬íŒ©í† ë§ &amp;amp; XCom/Variable í‘œì¤€&lt;/h2>
&lt;h3 id="1-dag-êµ¬ì¡°">1) DAG êµ¬ì¡°&lt;/h3>
&lt;p>&lt;img alt="mermaid-05-01.png" loading="lazy" src="https://keonhoban.github.io/mlops-journey/images/mermaid-05-01.png">&lt;/p></description></item><item><title>[MLOps ìš´ì˜ ê³ ë„í™” - 3ë‹¨ê³„: ëª¨ë¸ ë¡¤ë°± ìë™í™” (ë“±ë¡ ì‹¤íŒ¨ ëŒ€ë¹„ ë³µêµ¬)]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/04/</link><pubDate>Fri, 01 Aug 2025 12:15:21 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/04/</guid><description>&lt;h2 id="ëª¨ë¸-ë¡¤ë°±-ìë™í™”-ë“±ë¡-ì‹¤íŒ¨-ëŒ€ë¹„-ë³µêµ¬-ë£¨í”„-ì™„ì„±">ëª¨ë¸ ë¡¤ë°± ìë™í™”: ë“±ë¡ ì‹¤íŒ¨ ëŒ€ë¹„ ë³µêµ¬ ë£¨í”„ ì™„ì„±&lt;/h2>
&lt;hr>
&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>â€œëª¨ë¸ ë°°í¬ëŠ” ì„±ê³µí–ˆì„ ë•Œë³´ë‹¤, &lt;strong>ì‹¤íŒ¨í–ˆì„ ë•Œì˜ íšŒë³µ ì†ë„&lt;/strong>ê°€ ìš´ì˜ í’ˆì§ˆì„ ê²°ì •í•©ë‹ˆë‹¤.â€&lt;/p>
&lt;p>â€œê·¸ë˜ì„œ 3ë‹¨ê³„ì—ì„œëŠ” ë“±ë¡ì´ ì‹¤íŒ¨í•˜ëŠ” ì¦‰ì‹œ,&lt;/p>
&lt;p>ì´ì „ ì•ˆì • ë²„ì „ìœ¼ë¡œ ëŒì•„ê°€ FastAPIì— ìë™ ë°˜ì˜ë˜ëŠ” &lt;strong>ì™„ì „í•œ ë¡¤ë°± ë£¨í”„&lt;/strong>ë¥¼ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.â€&lt;/p>
&lt;p>â€œì´ êµ¬ì¡°ê°€ ìˆì–´ì•¼ ì¥ì•  ìƒí™©ì—ì„œë„ ì„œë¹„ìŠ¤ê°€ &lt;strong>ëŠê¸°ì§€ ì•Šê³  ë°”ë¡œ ë³µêµ¬&lt;/strong>ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.â€&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;h2 id="-í•µì‹¬-ìš”ì•½">ğŸ¯ í•µì‹¬ ìš”ì•½&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>ë“±ë¡ ì‹¤íŒ¨ â†’ ì¦‰ì‹œ ë¡¤ë°±&lt;/strong>: ì‹œë„ ì§ì „ &lt;strong>&lt;code>before_version&lt;/code>&lt;/strong>(aliasê°€ ê°€ë¦¬í‚¤ë˜ ë²„ì „)ìœ¼ë¡œ ë³µê·€&lt;/li>
&lt;li>&lt;strong>READY ê²€ì¦ â†’ alias ì¬í• ë‹¹ â†’ FastAPI &lt;code>/reload&lt;/code>&lt;/strong> ê¹Œì§€ ìë™ ìˆ˜í–‰(ì‹¤ì„œë¹„ìŠ¤ ë°˜ì˜ ë³´ì¥)&lt;/li>
&lt;li>&lt;strong>ìˆ˜ë™ ë¡¤ë°± ì „ìš© DAG&lt;/strong> ì œê³µ(ìš´ì˜ìê°€ ëŒ€ìƒ ë²„ì „ ëª…ì‹œ)&lt;/li>
&lt;li>&lt;strong>Slack/ë¡œê·¸ ì¶”ì &lt;/strong>(ì„±ê³µ/ì‹¤íŒ¨/ë³µêµ¬ êµ¬ë¶„), ì‹¤íŒ¨ëŠ” &lt;strong>re-raise&lt;/strong>ë¡œ ì›ì¸ ëª…í™•í™”&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="1-í”Œë¡œìš°-í•œ-ì¥-ìš”ì•½">1ï¸âƒ£ í”Œë¡œìš° í•œ ì¥ ìš”ì•½&lt;/h2>
&lt;p>&lt;img alt="mermaid-03.png" loading="lazy" src="https://keonhoban.github.io/mlops-journey/images/mermaid-03.png">&lt;/p></description></item><item><title>[MLOps ìš´ì˜ ê³ ë„í™” - 1ë‹¨ê³„: í•«ìŠ¤ì™‘ ê³ ë„í™” (/reload ë³´ì•ˆÂ·DAG ìë™í™”)]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/02/</link><pubDate>Tue, 22 Jul 2025 12:10:21 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/02/</guid><description>&lt;h2 id="í•«ìŠ¤ì™‘-ê³ ë„í™”-reload-ë³´ì•ˆ-ê°•í™”--dag-ìë™í™”-ì—°ë™">í•«ìŠ¤ì™‘ ê³ ë„í™”: &lt;code>/reload&lt;/code> ë³´ì•ˆ ê°•í™” + DAG ìë™í™” ì—°ë™&lt;/h2>
&lt;hr>
&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>â€œëª¨ë¸ì„ ì˜ í•™ìŠµì‹œí‚¤ëŠ” ê²ƒë„ ì¤‘ìš”í•˜ì§€ë§Œ,&lt;/p>
&lt;p>ì˜ëª»ëœ ëª¨ë¸ì´ ì‹¤ìˆ˜ë¡œ í•«ìŠ¤ì™‘ë˜ëŠ” ìˆœê°„ì´ ë” ì¹˜ëª…ì ì…ë‹ˆë‹¤.â€&lt;/p>
&lt;p>ê·¸ë˜ì„œ 1ë‹¨ê³„ì—ì„œëŠ” &lt;code>/reload&lt;/code>ë¥¼ í™•ì‹¤í•˜ê²Œ ì ê·¸ê³ ,&lt;/p>
&lt;p>&lt;strong>í•™ìŠµ â†’ ë“±ë¡ â†’ ê°ì‹œ â†’ í•«ìŠ¤ì™‘&lt;/strong>ê¹Œì§€ê°€ Airflowì—ì„œ ìë™ìœ¼ë¡œ í˜ëŸ¬ê°€ë„ë¡ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.&lt;/p>
&lt;p>ì´ ë‹¨ê³„ê°€ ì™„ì„±ë¼ì•¼ ì´í›„ ë‹¨ê³„ì—ì„œ **ì•ˆì „í•œ ìë™ ìš´ì˜(MLOps)**ì„ êµ¬í˜„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;h2 id="-í•µì‹¬-ìš”ì•½">ğŸ¯ í•µì‹¬ ìš”ì•½&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>ë³´ì•ˆ 3ì¢…&lt;/strong>: &lt;code>x-token&lt;/code>(SealedSecret) + Ingress &lt;strong>IP whitelist&lt;/strong> + &lt;strong>TLS&lt;/strong>&lt;/li>
&lt;li>&lt;strong>ìë™í™”&lt;/strong>: Airflow &lt;strong>Train â†’ Register â†’ Sensor(READY) â†’ Reload&lt;/strong> ì „ì²´ ì‹œí€€ìŠ¤&lt;/li>
&lt;li>&lt;strong>ì¼ê´€ì„±&lt;/strong>: MLflow &lt;strong>Alias(@A/@B)&lt;/strong> ê¸°ë°˜ ë“±ë¡Â·ì¡°íšŒÂ·í•«ìŠ¤ì™‘&lt;/li>
&lt;li>&lt;strong>ê´€ì œ&lt;/strong>: ëª¨ë“  ë‹¨ê³„ &lt;strong>ì„±ê³µ/ìŠ¤í‚µ/ì‹¤íŒ¨&lt;/strong> Slack ì•Œë¦¼&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>í™˜ê²½ ë¶„ë¦¬: dev(&lt;em>.local) / prod(&lt;/em>.prod) â€” ì˜ˆ: fastapi.local, fastapi.prod&lt;/p></description></item><item><title>[MLOps ìš´ì˜ ê³ ë„í™” - 0ë‹¨ê³„: FastAPI A/BÂ·CanaryÂ·Blue-Green ì„œë¹™ ë² ì´ìŠ¤]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/01/</link><pubDate>Fri, 18 Jul 2025 17:10:21 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/01/</guid><description>&lt;h2 id="fastapi-ì•±-ì „ë©´-ê°œí¸-ab--canary--blue-green-ì„œë¹™-ë² ì´ìŠ¤">FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤&lt;/h2>
&lt;hr>
&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,&lt;/p>
&lt;p>ê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€&lt;/p>
&lt;p>â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”&lt;/p>
&lt;p>&lt;strong>A/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°&lt;/strong>ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€&lt;/p>
&lt;p>â€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ&lt;/p>
&lt;p>**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;h3 id="-í•µì‹¬-ìš”ì•½">ğŸ¯ í•µì‹¬ ìš”ì•½&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)&lt;/strong>&lt;/p></description></item><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• : Airflow-MLflow-FastAPI (Helm)]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/helm/</link><pubDate>Tue, 15 Jul 2025 17:55:05 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/helm/</guid><description>&lt;h2 id="-ì‹¤ì „-ì‹œë‚˜ë¦¬ì˜¤-ê¸°ë°˜-êµ¬ì„±-ë°°ê²½">ğŸ§© ì‹¤ì „ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ êµ¬ì„± ë°°ê²½&lt;/h2>
&lt;blockquote>
&lt;p>ì´ í”„ë¡œì íŠ¸ëŠ” ë‹¨ìˆœ ì‹¤ìŠµì„ ë„˜ì–´ì„œ, ì‹¤ì œ ë°œìƒí•˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œë“¤ì„ í•´ê²°í•˜ê¸° ìœ„í•œ MLOps ì¸í”„ë¼ êµ¬ì¶•ì„ ëª©í‘œë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/p>&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>ì—¬ëŸ¬ ëª¨ë¸ ì‹¤í—˜ ê²°ê³¼ê°€ ë’¤ì„ì—¬ ì¶”ì ì´ ì–´ë ¤ìš´ ë¬¸ì œ&lt;/strong>&lt;br>
â†’ MLflow Tracking ì„œë²„ + PostgreSQL ë©”íƒ€ë°ì´í„° ì €ì¥ì†Œ êµ¬ì„±&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ëª¨ë¸ íŒŒì¼ ë° ë¡œê·¸ê°€ ë¡œì»¬ì—ë§Œ ì €ì¥ë˜ì–´ í˜‘ì—… ë° ì¬í˜„ì„±ì´ ë–¨ì–´ì§€ëŠ” ë¬¸ì œ&lt;/strong>&lt;br>
â†’ S3 ê¸°ë°˜ artifact store êµ¬ì„± + pyfunc ê¸°ë°˜ ëª¨ë¸ ì„œë¹™ êµ¬ì¡° ì„¤ê³„&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>ìˆ˜ì‘ì—… DAG ë“±ë¡, ëª¨ë¸ ë°°í¬ ë“±ì˜ ë¹„íš¨ìœ¨ì  ìš´ì˜ ë¬¸ì œ&lt;/strong>&lt;br>
â†’ Airflow + GitSync ì—°ë™ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ ìë™í™” ë° ë²„ì „ ê´€ë¦¬ ê°€ëŠ¥&lt;/p></description></item><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 6ë‹¨ê³„: ì‹¤ì‹œê°„ ëª¨ë¸ í•«ìŠ¤ì™‘ êµ¬ì¡° ì‹¤í—˜]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/06/</link><pubDate>Thu, 10 Jul 2025 17:12:00 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/06/</guid><description>&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ì‹¤ì„œë¹„ìŠ¤ì— ë°°í¬í•  ë•Œ,
ê¸°ì¡´ ëª¨ë¸ì„ ìƒˆ ëª¨ë¸ë¡œ ì•ˆì „í•˜ê²Œ êµì²´(hot-swap)í•˜ëŠ” ìë™í™” êµ¬ì¡°ëŠ”
ë§¤ìš° ì¤‘ìš”í•œ ìš”êµ¬ì‚¬í•­ì…ë‹ˆë‹¤.&lt;/p>&lt;/blockquote>
&lt;hr>
&lt;h2 id="-tldr">âœ… TL;DR&lt;/h2>
&lt;ul>
&lt;li>&lt;code>Airflow&lt;/code>ì—ì„œ í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ê³  ì¡°ê±´ë¶€ë¡œ ëª¨ë¸ ë“±ë¡&lt;/li>
&lt;li>ì„±ëŠ¥ ê¸°ì¤€ì„ ì¶©ì¡±í•œ ëª¨ë¸ì€ &lt;code>Staging&lt;/code>ìœ¼ë¡œ ìë™ ìŠ¹ê²©&lt;/li>
&lt;li>&lt;code>FastAPI&lt;/code>ëŠ” &lt;code>/reload&lt;/code> ìš”ì²­ ì‹œ &lt;code>Staging ëª¨ë¸&lt;/code>ì„ ë‹¤ì‹œ ë¡œë”© â†’ ì½”ë“œ ìˆ˜ì • ì—†ì´ í•«ìŠ¤ì™‘&lt;/li>
&lt;li>&lt;strong>ìš´ì˜ í™˜ê²½ì—ì„œì˜ ì‹¤í—˜ ìë™í™”, ëª¨ë¸ A/B í…ŒìŠ¤íŠ¸, ëª¨ë¸ ë¡¤ë°±&lt;/strong> ë“±ì— í™•ì¥ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ê³„&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-êµ¬ì¡°-ë‹¤ì´ì–´ê·¸ë¨-í•«ìŠ¤ì™‘-íë¦„">ğŸ§  êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨ (í•«ìŠ¤ì™‘ íë¦„)&lt;/h2>
&lt;p>&lt;img alt="06" loading="lazy" src="https://keonhoban.github.io/mlops-journey/images/06.png">&lt;/p>
&lt;hr>
&lt;h2 id="-í•µì‹¬-êµ¬ì„±-ìš”ì†Œ">ğŸ§© í•µì‹¬ êµ¬ì„± ìš”ì†Œ&lt;/h2>
&lt;h3 id="1-airflow-dag---ì¡°ê±´ë¶€-ëª¨ë¸-ë“±ë¡">1. Airflow DAG - ì¡°ê±´ë¶€ ëª¨ë¸ ë“±ë¡&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># dags/dag_ml_experiment.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow &lt;span style="color:#f92672">import&lt;/span> DAG
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.python &lt;span style="color:#f92672">import&lt;/span> PythonOperator, BranchPythonOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.operators.empty &lt;span style="color:#f92672">import&lt;/span> EmptyOperator
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> airflow.models &lt;span style="color:#f92672">import&lt;/span> Variable
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> datetime &lt;span style="color:#f92672">import&lt;/span> datetime, timedelta, timezone
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sys&lt;span style="color:#f92672">.&lt;/span>path&lt;span style="color:#f92672">.&lt;/span>append(&lt;span style="color:#e6db74">&amp;#39;/opt/airflow/dags/repo/ml_code&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> train_and_log_model_fastapi &lt;span style="color:#f92672">import&lt;/span> train_model
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>default_args &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#39;start_date&amp;#39;&lt;/span>: datetime&lt;span style="color:#f92672">.&lt;/span>now(timezone&lt;span style="color:#f92672">.&lt;/span>utc) &lt;span style="color:#f92672">-&lt;/span> timedelta(days&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">run_and_check&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Variableë¡œ íŒŒë¼ë¯¸í„° ë™ì  ì œì–´&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C &lt;span style="color:#f92672">=&lt;/span> float(Variable&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;logreg_C&amp;#34;&lt;/span>, default_var&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">1.0&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> max_iter &lt;span style="color:#f92672">=&lt;/span> int(Variable&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;logreg_max_iter&amp;#34;&lt;/span>, default_var&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">200&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">Exception&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> e:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[ERROR] íŒŒë¼ë¯¸í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>str(e)&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">. ê¸°ë³¸ê°’ ì‚¬ìš©.&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> C, max_iter &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">1.0&lt;/span>, &lt;span style="color:#ae81ff">200&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ì •í™•ë„ ê¸°ì¤€ìœ¼ë¡œ ì„±ê³µ/ì‹¤íŒ¨ ë¶„ê¸°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> acc &lt;span style="color:#f92672">=&lt;/span> train_model(C&lt;span style="color:#f92672">=&lt;/span>C, max_iter&lt;span style="color:#f92672">=&lt;/span>max_iter)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> acc &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0.9&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#39;notify_success&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#39;notify_failure&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">notify_success&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;ğŸ‰ ëª¨ë¸ ë“±ë¡ ë° í•«ìŠ¤ì™‘ ì„±ê³µ! FastAPIì— ìµœì‹  ëª¨ë¸ ë°˜ì˜ ì™„ë£Œ.&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">notify_failure&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;âŒ ì„±ëŠ¥ ê¸°ì¤€ ë¯¸ë‹¬. ëª¨ë¸ ë“±ë¡/ì„œë¹™ ìƒëµë¨.&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> DAG(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dag_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;mlflow_experiment_conditional_register_runner_fastapi&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> default_args&lt;span style="color:#f92672">=&lt;/span>default_args,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> schedule&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">None&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> catchup&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) &lt;span style="color:#66d9ef">as&lt;/span> dag:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> branch_task &lt;span style="color:#f92672">=&lt;/span> BranchPythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;branch_by_accuracy&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>run_and_check
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> success_notify_task &lt;span style="color:#f92672">=&lt;/span> PythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;notify_success&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>notify_success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> failure_notify_task &lt;span style="color:#f92672">=&lt;/span> PythonOperator(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> task_id&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;notify_failure&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> python_callable&lt;span style="color:#f92672">=&lt;/span>notify_failure
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> branch_task &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> [success_notify_task, failure_notify_task]
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="2-ëª¨ë¸-í•™ìŠµ-ë°-ë“±ë¡">2. ëª¨ë¸ í•™ìŠµ ë° ë“±ë¡&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ml_code/train_and_log_model_fastapi.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow.sklearn
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> mlflow.tracking &lt;span style="color:#f92672">import&lt;/span> MlflowClient
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.datasets &lt;span style="color:#f92672">import&lt;/span> load_iris
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.linear_model &lt;span style="color:#f92672">import&lt;/span> LogisticRegression
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.model_selection &lt;span style="color:#f92672">import&lt;/span> train_test_split
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.metrics &lt;span style="color:#f92672">import&lt;/span> accuracy_score
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> sys
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> requests
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> time
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mlflow&lt;span style="color:#f92672">.&lt;/span>set_tracking_uri(&lt;span style="color:#e6db74">&amp;#34;http://mlflow-service.mlflow.svc.cluster.local:5000&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mlflow&lt;span style="color:#f92672">.&lt;/span>set_experiment(&lt;span style="color:#e6db74">&amp;#34;train_and_register_model_exp&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">train_model&lt;/span>(C, max_iter):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> X, y &lt;span style="color:#f92672">=&lt;/span> load_iris(return_X_y&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> X_train, X_test, y_train, y_test &lt;span style="color:#f92672">=&lt;/span> train_test_split(X, y, test_size&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0.2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> mlflow&lt;span style="color:#f92672">.&lt;/span>start_run() &lt;span style="color:#66d9ef">as&lt;/span> run:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> clf &lt;span style="color:#f92672">=&lt;/span> LogisticRegression(C&lt;span style="color:#f92672">=&lt;/span>C, max_iter&lt;span style="color:#f92672">=&lt;/span>max_iter)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> clf&lt;span style="color:#f92672">.&lt;/span>fit(X_train, y_train)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> y_pred &lt;span style="color:#f92672">=&lt;/span> clf&lt;span style="color:#f92672">.&lt;/span>predict(X_test)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> acc &lt;span style="color:#f92672">=&lt;/span> accuracy_score(y_test, y_pred)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;C&amp;#34;&lt;/span>, C)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;max_iter&amp;#34;&lt;/span>, max_iter)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_metric(&lt;span style="color:#e6db74">&amp;#34;accuracy&amp;#34;&lt;/span>, acc)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>sklearn&lt;span style="color:#f92672">.&lt;/span>log_model(clf, &lt;span style="color:#e6db74">&amp;#34;model&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[INFO] Logged model with accuracy=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>acc&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> acc &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0.9&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ëª¨ë¸ ë“±ë¡&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> result &lt;span style="color:#f92672">=&lt;/span> mlflow&lt;span style="color:#f92672">.&lt;/span>register_model(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_uri&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;runs:/&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>run&lt;span style="color:#f92672">.&lt;/span>info&lt;span style="color:#f92672">.&lt;/span>run_id&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/model&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> name&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;best_model&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> version &lt;span style="color:#f92672">=&lt;/span> result&lt;span style="color:#f92672">.&lt;/span>version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[INFO] âœ… ëª¨ë¸ ë“±ë¡ ì™„ë£Œ (version=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>version&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">)&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ë“±ë¡ ì§í›„ DB ì—…ë°ì´íŠ¸ ì‹œê°„ í•„ìš”&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> time&lt;span style="color:#f92672">.&lt;/span>sleep(&lt;span style="color:#ae81ff">3&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ìŠ¤í…Œì´ì§€ ìŠ¹ê²© + ê¸°ì¡´ ë²„ì „ Archive&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client &lt;span style="color:#f92672">=&lt;/span> MlflowClient()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client&lt;span style="color:#f92672">.&lt;/span>transition_model_version_stage(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> name&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;best_model&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> version&lt;span style="color:#f92672">=&lt;/span>version,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> stage&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Staging&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> archive_existing_versions&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">False&lt;/span> &lt;span style="color:#75715e"># ìŠ¤í…Œì´ì§•ì€ ì—¬ëŸ¬ ê°œ ê°€ëŠ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[INFO] ğŸš€ ëª¨ë¸ version &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>version&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> â†’ Staging ë°˜ì˜ ì™„ë£Œ&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># FastAPI í•«ìŠ¤ì™‘ ìš”ì²­ (reload í˜¸ì¶œ)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> response &lt;span style="color:#f92672">=&lt;/span> requests&lt;span style="color:#f92672">.&lt;/span>post(&lt;span style="color:#e6db74">&amp;#34;http://fastapi.local/reload&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[INFO] ğŸ” FastAPI ëª¨ë¸ ë¦¬ë¡œë“œ ìš”ì²­ ê²°ê³¼: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>response&lt;span style="color:#f92672">.&lt;/span>status_code&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>response&lt;span style="color:#f92672">.&lt;/span>text&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">Exception&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> e:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[ERROR] âŒ FastAPI ë¦¬ë¡œë“œ ìš”ì²­ ì‹¤íŒ¨: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>str(e)&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">else&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">&amp;#34;[WARN] âŒ ì„±ëŠ¥ ê¸°ì¤€ ë¯¸ë‹¬ (accuracy &amp;lt;= 0.9)&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ëª¨ë¸ ë²„ì „ ì¶œë ¥ (ì „í›„ ë¹„êµ ê°€ëŠ¥)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client &lt;span style="color:#f92672">=&lt;/span> MlflowClient()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> versions &lt;span style="color:#f92672">=&lt;/span> client&lt;span style="color:#f92672">.&lt;/span>get_latest_versions(&lt;span style="color:#e6db74">&amp;#34;best_model&amp;#34;&lt;/span>, stages&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;None&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Staging&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Production&amp;#34;&lt;/span>])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> v &lt;span style="color:#f92672">in&lt;/span> versions:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;[INFO] ğŸ”„ ëª¨ë¸ Version=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>v&lt;span style="color:#f92672">.&lt;/span>version&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, Stage=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>v&lt;span style="color:#f92672">.&lt;/span>current_stage&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> acc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> __name__ &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#34;__main__&amp;#34;&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> acc &lt;span style="color:#f92672">=&lt;/span> train_model(float(sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">1&lt;/span>]), int(sys&lt;span style="color:#f92672">.&lt;/span>argv[&lt;span style="color:#ae81ff">2&lt;/span>]))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="3-fastapi-ëª¨ë¸-ì¬ë¡œë”©-êµ¬ì¡°">3. FastAPI ëª¨ë¸ ì¬ë¡œë”© êµ¬ì¡°&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># FastAPI app/main.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> fastapi &lt;span style="color:#f92672">import&lt;/span> FastAPI, Request
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow.pyfunc
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> mlflow.tracking &lt;span style="color:#f92672">import&lt;/span> MlflowClient
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> os
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>app &lt;span style="color:#f92672">=&lt;/span> FastAPI()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>model_info &lt;span style="color:#f92672">=&lt;/span> {}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">load_model_from_mlflow&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">global&lt;/span> model, model_info
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> tracking_uri &lt;span style="color:#f92672">=&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>environ&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;MLFLOW_TRACKING_URI&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_name &lt;span style="color:#f92672">=&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>environ&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;MODEL_NAME&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_stage &lt;span style="color:#f92672">=&lt;/span> os&lt;span style="color:#f92672">.&lt;/span>environ&lt;span style="color:#f92672">.&lt;/span>get(&lt;span style="color:#e6db74">&amp;#34;MODEL_STAGE&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Staging&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>set_tracking_uri(tracking_uri)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_uri &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;models:/&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model_name&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model_stage&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model &lt;span style="color:#f92672">=&lt;/span> mlflow&lt;span style="color:#f92672">.&lt;/span>pyfunc&lt;span style="color:#f92672">.&lt;/span>load_model(model_uri)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client &lt;span style="color:#f92672">=&lt;/span> MlflowClient()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> latest &lt;span style="color:#f92672">=&lt;/span> client&lt;span style="color:#f92672">.&lt;/span>get_latest_versions(name&lt;span style="color:#f92672">=&lt;/span>model_name, stages&lt;span style="color:#f92672">=&lt;/span>[model_stage])[&lt;span style="color:#ae81ff">0&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> run_id &lt;span style="color:#f92672">=&lt;/span> latest&lt;span style="color:#f92672">.&lt;/span>run_id
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> version &lt;span style="color:#f92672">=&lt;/span> latest&lt;span style="color:#f92672">.&lt;/span>version
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(&lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;âœ… Reloaded model: name=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model_name&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, stage=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>model_stage&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, version=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>version&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">, run_id=&lt;/span>&lt;span style="color:#e6db74">{&lt;/span>run_id&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> model_info &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_name&amp;#34;&lt;/span>: model_name,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;stage&amp;#34;&lt;/span>: model_stage,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;version&amp;#34;&lt;/span>: version,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;run_id&amp;#34;&lt;/span>: run_id,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_uri&amp;#34;&lt;/span>: model_uri,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@app.on_event&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;startup&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">startup_event&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> load_model_from_mlflow()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@app.get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">root&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;FastAPI MLOps is running!&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># í˜„ì¬ ëª¨ë¸ í™•ì¸ ê°€ëŠ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@app.get&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/model-info&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">get_model_info&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> model_info
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@app.post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/predict&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">async&lt;/span> &lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">predict&lt;/span>(request: Request):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> input_data &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">await&lt;/span> request&lt;span style="color:#f92672">.&lt;/span>json()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> prediction &lt;span style="color:#f92672">=&lt;/span> model&lt;span style="color:#f92672">.&lt;/span>predict(input_data)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;prediction&amp;#34;&lt;/span>: prediction&lt;span style="color:#f92672">.&lt;/span>tolist()}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># Staging ëª¨ë¸ ë‹¤ì‹œ ë¡œë“œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">@app.post&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;/reload&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">reload_model&lt;/span>():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">try&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> load_model_from_mlflow()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;status&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;success&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ğŸ” Model reloaded successfully.&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">except&lt;/span> &lt;span style="color:#a6e22e">Exception&lt;/span> &lt;span style="color:#66d9ef">as&lt;/span> e:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;status&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;error&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">f&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Reload failed: &lt;/span>&lt;span style="color:#e6db74">{&lt;/span>str(e)&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-í…ŒìŠ¤íŠ¸-ê²°ê³¼-ìš”ì•½">âœ… í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½&lt;/h2>
&lt;ul>
&lt;li>&lt;code>logreg_C&lt;/code>, &lt;code>logreg_max_iter&lt;/code> íŒŒë¼ë¯¸í„°ë¡œ í•™ìŠµ DAG ì„¤ì • ê°€ëŠ¥&lt;/li>
&lt;li>ëª¨ë¸ ë“±ë¡ ì‹œ &lt;code>Staging&lt;/code>ìœ¼ë¡œ ìë™ ìŠ¹ê²©&lt;/li>
&lt;li>FastAPI ì„œë²„ì— &lt;code>/reload&lt;/code> í˜¸ì¶œ ì‹œ í•«ìŠ¤ì™‘ ì ìš©ë¨&lt;/li>
&lt;li>&lt;code>/model-info&lt;/code>, &lt;code>/predict&lt;/code>ì—ì„œ ìƒˆë¡œìš´ ëª¨ë¸ ì •ë³´ ë° ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸ ì™„ë£Œ&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-í…ŒìŠ¤íŠ¸-ê²€ì¦-ëª¨ë¸-ë“±ë¡--í•«ìŠ¤ì™‘-í™•ì¸">ğŸ“ í…ŒìŠ¤íŠ¸ ê²€ì¦ (ëª¨ë¸ ë“±ë¡ + í•«ìŠ¤ì™‘ í™•ì¸)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ê¸°ì¡´ ëª¨ë¸ ë²„ì „ í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl http://fastapi.local/model-info | jq
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> % Total % Received % Xferd Average Speed Time Time Time Current
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dload Upload Total Spent Left Speed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">144&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">144&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">19251&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> --:--:-- --:--:-- --:--:-- &lt;span style="color:#ae81ff">20571&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;best_model&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;stage&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Staging&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;run_id&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;8bd09505eabf40648337e811110ab22c&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_uri&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;models:/best_model/Staging&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -X POST http://fastapi.local/predict &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -H &lt;span style="color:#e6db74">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -d &lt;span style="color:#e6db74">&amp;#39;[ [5.1, 3.5, 1.4, 0.2] ]&amp;#39;&lt;/span> | jq
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> % Total % Received % Xferd Average Speed Time Time Time Current
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dload Upload Total Spent Left Speed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">42&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">18&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">24&lt;/span> &lt;span style="color:#ae81ff">311&lt;/span> &lt;span style="color:#ae81ff">415&lt;/span> --:--:-- --:--:-- --:--:-- &lt;span style="color:#ae81ff">736&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;prediction&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ëª¨ë¸ reload (í•«ìŠ¤ì™‘)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -X POST http://fastapi.local/reload | jq
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> % Total % Received % Xferd Average Speed Time Time Time Current
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dload Upload Total Spent Left Speed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">66&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">66&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">186&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> --:--:-- --:--:-- --:--:-- &lt;span style="color:#ae81ff">186&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;status&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;success&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;message&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ğŸ” Model reloaded successfully.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì‹ ê·œ ëª¨ë¸ ë²„ì „ í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl http://fastapi.local/model-info | jq
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> % Total % Received % Xferd Average Speed Time Time Time Current
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dload Upload Total Spent Left Speed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">144&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">144&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">42985&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> --:--:-- --:--:-- --:--:-- &lt;span style="color:#ae81ff">48000&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_name&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;best_model&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;stage&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;Staging&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;version&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;run_id&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;72f388927f5749c185b828a1a16bb063&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;model_uri&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;models:/best_model/Staging&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -X POST http://fastapi.local/predict &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -H &lt;span style="color:#e6db74">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> -d &lt;span style="color:#e6db74">&amp;#39;[ [5.1, 3.5, 1.4, 0.2] ]&amp;#39;&lt;/span> | jq
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> % Total % Received % Xferd Average Speed Time Time Time Current
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Dload Upload Total Spent Left Speed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">42&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">18&lt;/span> &lt;span style="color:#ae81ff">100&lt;/span> &lt;span style="color:#ae81ff">24&lt;/span> &lt;span style="color:#ae81ff">3831&lt;/span> &lt;span style="color:#ae81ff">5108&lt;/span> --:--:-- --:--:-- --:--:-- &lt;span style="color:#ae81ff">10500&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;prediction&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 3ë‹¨ê³„: MLflow : PostgreSQL + S3 ì—°ë™ ê¸°ë°˜ Helm êµ¬ì„±]</title><link>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/03/</link><pubDate>Mon, 30 Jun 2025 17:11:51 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/03/</guid><description>&lt;h2 id="-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…">ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…&lt;/h2>
&lt;blockquote>
&lt;p>â€œMLflow Tracking ì„œë²„ëŠ” ë‹¨ìˆœ ëª¨ë¸ í•™ìŠµì´ ì•„ë‹Œ ëª¨ë¸ì˜ ì‹¤í—˜ ì´ë ¥, í•˜ì´í¼íŒŒë¼ë¯¸í„°, ì„±ëŠ¥ ì§€í‘œ ë“±ì„ ì¶”ì í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.&lt;/p>
&lt;p>ë”°ë¼ì„œ ë‹¨ì¼ ë¨¸ì‹ /ë¡œì»¬ í™˜ê²½ì´ ì•„ë‹Œ, &lt;strong>ì„œë²„ ê¸°ë°˜ Tracking í™˜ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤.&lt;/strong>â€&lt;/p>&lt;/blockquote>
&lt;ul>
&lt;li>
&lt;p>í•œ í”„ë¡œì íŠ¸ì— ì—¬ëŸ¬ ë²„ì „ì˜ ëª¨ë¸ì´ ë“±ì¥í•˜ê³ ,&lt;/p>
&lt;p>ê°ê° ì–´ë–¤ ì‹¤í—˜ìœ¼ë¡œë¶€í„° ë‚˜ì™”ëŠ”ì§€ **â€˜íšŒê³  ê°€ëŠ¥í•œ ë¡œê·¸â€™**ê°€ í•„ìš”í•¨&lt;/p>
&lt;/li>
&lt;li>
&lt;p>MLflow Tracking Server + PostgreSQL â†’ ëª¨ë¸ ì‹¤í—˜ ë¡œê·¸ ì €ì¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>S3 ì—°ë™ â†’ ëª¨ë¸ íŒŒì¼ ì €ì¥ ìœ„ì¹˜ ë¶„ë¦¬ (ì„œë¹™, ì¬ì‚¬ìš© ëŒ€ë¹„)&lt;/p>
&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-tldr">âœ¨ TL;DR&lt;/h2>
&lt;ul>
&lt;li>MLflowë¥¼ ë„ì…ì‹œ &lt;strong>PostgreSQL, S3, ì¸ì¦ ì •ë³´ ì£¼ì…, Helm ë°°í¬, Ingress ì—°ë™ ë“±&lt;/strong> ì„¤ê³„&lt;/li>
&lt;li>MLflowë¥¼ Helmìœ¼ë¡œ ë°°í¬í•˜ë©´ì„œ ê³ ë ¤í•œ í•­ëª©(ë³´ì•ˆ, ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ, UI ì ‘ê·¼ ë“±) êµ¬ì„±&lt;/li>
&lt;li>ì»¤ìŠ¤í…€ Docker ì´ë¯¸ì§€ë¡œ &lt;code>psycopg2&lt;/code> ì„¤ì¹˜, Helm chart êµ¬ì„±, Secret ì—°ê²°ê¹Œì§€ í¬í•¨&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h2 id="-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„-with-secret--ì—°ë™-íë¦„">ğŸ“ ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ (with Secret &amp;amp; ì—°ë™ íë¦„)&lt;/h2>
&lt;p>&lt;img alt="03" loading="lazy" src="https://keonhoban.github.io/mlops-journey/images/03.png">&lt;/p></description></item><item><title>[Airflow ê¸°ì´ˆ ìë™í™” - Airflow â†’ MLflow â†’ FastAPI]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/basic/</link><pubDate>Fri, 13 Jun 2025 20:58:51 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline/basic/</guid><description>&lt;h2 id="-ì „ì²´-íë¦„-ì˜ˆì‹œ">ğŸ§­ ì „ì²´ íë¦„ ì˜ˆì‹œ&lt;/h2>
&lt;pre tabindex="0">&lt;code>[AIRFLOW DAG ì‹¤í–‰]
â†“
[train_mlflow.py]
- iris ëª¨ë¸ í•™ìŠµ
- íŒŒë¼ë¯¸í„°/ë©”íŠ¸ë¦­ ë¡œê¹…
- ëª¨ë¸ Registry ë“±ë¡
â†“
[promote_mlflow.py]
- ìµœì‹  ëª¨ë¸ì„ Productionìœ¼ë¡œ ì „í™˜
â†“
[FastAPI]
- models:/IrisModel/Production â†’ ì‹¤ì‹œê°„ ì˜ˆì¸¡
&lt;/code>&lt;/pre>&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/airflow_mlflow_fastapi_dockerCompose">ğŸ”— GitHub (Airflow + MLflow + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-1ë‹¨ê³„-í”„ë¡œì íŠ¸-ê¸°ë³¸-í´ë”-êµ¬ì¡°-ì„¤ê³„">âœ… [1ë‹¨ê³„] í”„ë¡œì íŠ¸ ê¸°ë³¸ í´ë” êµ¬ì¡° ì„¤ê³„&lt;/h2>
&lt;h3 id="-1-ì „ì²´-ë””ë ‰í† ë¦¬-êµ¬ì„±ë„">ğŸ“ 1. ì „ì²´ ë””ë ‰í† ë¦¬ êµ¬ì„±ë„&lt;/h3>
&lt;pre tabindex="0">&lt;code>mlops_project/
â”œâ”€â”€ airflow/ ğŸ›« Airflow ì„¤ì • ë° DAG ìŠ¤ì¼€ì¤„ëŸ¬
â”‚ â”œâ”€â”€ dags/ â† DAG ì •ì˜ ë””ë ‰í† ë¦¬
â”‚ â”‚ â””â”€â”€ train_with_mlflow.py â† í•™ìŠµ DAG (MLflow ì—°ë™)
â”‚ â”œâ”€â”€ Dockerfile.airflow â† Airflowìš© Dockerfile
â”‚ â”œâ”€â”€ requirements.txt â† Airflow ì˜ì¡´ì„±
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ fastapi/ âš¡ FastAPI ì˜ˆì¸¡ API ì„œë²„
â”‚ â”œâ”€â”€ app/
â”‚ â”‚ â””â”€â”€ main.py â† ëª¨ë¸ ì„œë¹™ ì—”ë“œí¬ì¸íŠ¸
â”‚ â”œâ”€â”€ Dockerfile.api â† FastAPIìš© Dockerfile
â”‚ â”œâ”€â”€ requirements.txt â† FastAPI ì˜ì¡´ì„±
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ ml_code/ ğŸ§  ML í•™ìŠµ ë° í”„ë¡œëª¨ì…˜ ì½”ë“œ
â”‚ â”œâ”€â”€ train_mlflow.py â† ëª¨ë¸ í•™ìŠµ ë° MLflow ë¡œê¹…
â”‚ â””â”€â”€ promte_mlflow.py â† ëª¨ë¸ í”„ë¡œëª¨ì…˜ (Staging â†’ Production)
â”‚
â”œâ”€â”€ mlflow_store/ ğŸ—‚ï¸ MLflow ì €ì¥ì†Œ ê²½ë¡œ (ë³¼ë¥¨)
â”‚ â”œâ”€â”€ Dockerfile.mlflow â† MLflow ì„œë²„ ì»¤ìŠ¤í„°ë§ˆì´ì§•
â”‚ â”œâ”€â”€ mlflow.db â† Model Registry DB (sqlite)
â”‚ â”œâ”€â”€ mlruns/ â† ì‹¤í—˜ ë¡œê·¸ ë””ë ‰í† ë¦¬
â”‚ â”œâ”€â”€ artifacts/ â† ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ
â”‚ â””â”€â”€ .dockerignore
â”‚
â”œâ”€â”€ docker-compose.yaml ğŸ§© ì „ì²´ ì„œë¹„ìŠ¤ êµ¬ì„± ì •ì˜
â”œâ”€â”€ .env ğŸ” ë¯¼ê° ì •ë³´ (.envë¡œ ë¶„ë¦¬)
â”œâ”€â”€ README.md ğŸ“ ì „ì²´ í”„ë¡œì íŠ¸ ë¬¸ì„œí™”
â”œâ”€â”€ .gitignore
â””â”€â”€ .dockerignore
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-2ë‹¨ê³„-docker-composeyaml-í†µí•©-êµ¬ì„±">âœ… [2ë‹¨ê³„] &lt;code>docker-compose.yaml&lt;/code> í†µí•© êµ¬ì„±&lt;/h2>
&lt;h3 id="-êµ¬ì„±-ëª©í‘œ">ğŸ§­ êµ¬ì„± ëª©í‘œ&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ì„œë¹„ìŠ¤ëª…&lt;/th>
&lt;th>ì„¤ëª…&lt;/th>
&lt;th>í¬íŠ¸&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>airflow&lt;/code>&lt;/td>
&lt;td>DAG ì‹¤í–‰ í™˜ê²½ (webserver/scheduler)&lt;/td>
&lt;td>&lt;code>8080&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>postgres&lt;/code>&lt;/td>
&lt;td>Airflow ë©”íƒ€ë°ì´í„° ì €ì¥ìš© DB&lt;/td>
&lt;td>ë‚´ë¶€ í†µì‹ &lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>mlflow&lt;/code>&lt;/td>
&lt;td>MLflow UI + Registry ê¸°ëŠ¥&lt;/td>
&lt;td>&lt;code>5000&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>fastapi&lt;/code>&lt;/td>
&lt;td>ì¶”ë¡  API ì„œë²„ (ëª¨ë¸ ë¡œë”©)&lt;/td>
&lt;td>&lt;code>8000&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>ì´ë¯¸ì§€ ì‚¬ìš©ì‹œ ì£¼ì˜ (UIë§Œ ì œê³µí•˜ëŠ” ì´ë¯¸ì§€ ì¡´ì¬)&lt;/li>
&lt;/ul>
&lt;hr>
&lt;h3 id="-docker-composeyaml-ì „ì²´-ì˜ˆì‹œ">ğŸ“„ &lt;code>docker-compose.yaml&lt;/code> ì „ì²´ ì˜ˆì‹œ&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">version&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;3.8&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">services&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ“¦ PostgreSQL: Airflow ë©”íƒ€ë°ì´í„° ì €ì¥ìš© DB&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">postgres&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">image&lt;/span>: &lt;span style="color:#ae81ff">postgres:13&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">postgres&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env_file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">.env &lt;/span> &lt;span style="color:#75715e"># â† ë¯¼ê°ì •ë³´ ë¶„ë¦¬ (ì•„ì´ë””/ë¹„ë²ˆ)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_USER&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_USER}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_PASSWORD&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_PASSWORD}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">POSTGRES_DB&lt;/span>: &lt;span style="color:#ae81ff">${POSTGRES_DB}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>: &lt;span style="color:#75715e"># â† ì½”ë“œ/ë°ì´í„° ê³µìœ  ë° ì˜ì†ì„± ë³´ì¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">postgres_data:/var/lib/postgresql/data &lt;/span> &lt;span style="color:#75715e"># â† DB ë°ì´í„° ìœ ì§€ (ì¬ì‹œì‘ ëŒ€ë¹„)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ›« Airflow: DAG ìŠ¤ì¼€ì¤„ëŸ¬ ë° íƒœìŠ¤í¬ ì‹¤í–‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">airflow&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./airflow &lt;/span> &lt;span style="color:#75715e"># â†’ Airflow ì „ìš© Dockerfile ê²½ë¡œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.airflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">airflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">command&lt;/span>: &lt;span style="color:#ae81ff">standalone &lt;/span> &lt;span style="color:#75715e"># â†’ ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ê°„ë‹¨ ì‹¤í–‰ ëª…ë ¹ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># (- Scheduler + Webserver + DB ì´ˆê¸°í™”ê¹Œì§€ ìë™ìœ¼ë¡œ í•œë²ˆì— ì‹¤í–‰)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># (- ì‹¤ë¬´/ìš´ì˜ì—ì„œëŠ” airflow-webserver, airflow-scheduler í•„ë“œ ë¶„ë¦¬)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8080:8080&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ Airflow ì›¹ UI (localhost:8080)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">depends_on&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">postgres &lt;/span> &lt;span style="color:#75715e"># â†’ DBê°€ ë¨¼ì € ì˜¬ë¼ì™€ì•¼ Airflow ì‹œì‘ ê°€ëŠ¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">env_file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">.env&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Airflow ë©”íƒ€ë°ì´í„° DB ì—°ê²° ì£¼ì†Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">AIRFLOW__CORE__SQL_ALCHEMY_CONN&lt;/span>: &lt;span style="color:#ae81ff">${AIRFLOW__CORE__SQL_ALCHEMY_CONN}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># Airflow ì˜ˆì œ DAG ë¶ˆëŸ¬ì˜¬ì§€ ì—¬ë¶€&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">AIRFLOW__CORE__LOAD_EXAMPLES&lt;/span>: &lt;span style="color:#ae81ff">${AIRFLOW__CORE__LOAD_EXAMPLES} &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">MLFLOW_TRACKING_URI&lt;/span>: &lt;span style="color:#ae81ff">http://mlflow:5000 &lt;/span> &lt;span style="color:#75715e"># â†’ DAG ì½”ë“œì—ì„œ MLflow ì—°ë™&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./airflow/dags:/opt/airflow/dags &lt;/span> &lt;span style="color:#75715e"># DAG íŒŒì¼ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./ml_code:/opt/airflow/ml_code &lt;/span> &lt;span style="color:#75715e"># í•™ìŠµ ì½”ë“œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ëª¨ë¸ ì €ì¥ì†Œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># ğŸ”¬ MLflow: ì‹¤í—˜ ì¶”ì  + ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë²„&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mlflow&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./mlflow_store &lt;/span> &lt;span style="color:#75715e"># ì»¤ìŠ¤í…€ Dockerfile ìœ„ì¹˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.mlflow&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;5000:5000&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ MLflow UI (localhost:5000)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ì‹¤í—˜ ë¡œê·¸ + DB + artifacts ì €ì¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">environment&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">MLFLOW_TRACKING_URI=http://0.0.0.0:5000 &lt;/span> &lt;span style="color:#75715e"># ë‚´ë¶€ ì»¨í…Œì´ë„ˆ ê¸°ì¤€ URI&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># âš¡ FastAPI: ëª¨ë¸ ì„œë¹™ API&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">fastapi&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">build&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">context&lt;/span>: &lt;span style="color:#ae81ff">./fastapi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dockerfile&lt;/span>: &lt;span style="color:#ae81ff">Dockerfile.api&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">container_name&lt;/span>: &lt;span style="color:#ae81ff">fastapi&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ports&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;8000:8000&amp;#34;&lt;/span> &lt;span style="color:#75715e"># â†’ ì˜ˆì¸¡ API ì—”ë“œí¬ì¸íŠ¸ (localhost:8000)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./fastapi/app:/app/app &lt;/span> &lt;span style="color:#75715e"># FastAPI app ë””ë ‰í† ë¦¬ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./ml_code:/app/ml_code &lt;/span> &lt;span style="color:#75715e"># í•™ìŠµ/ëª¨ë¸ ì½”ë“œ ê³µìœ &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">./mlflow_store:/mlflow &lt;/span> &lt;span style="color:#75715e"># ì €ì¥ëœ ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•œ mount&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ğŸ—‚ï¸ ë³¼ë¥¨ ì •ì˜ (Postgres DB ì˜ì†ì„± ìœ ì§€)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">volumes&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">postgres_data&lt;/span>:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-ì¶”ê°€ë¡œ-í•´ì•¼-í• -ê²ƒ">ğŸ ì¶”ê°€ë¡œ í•´ì•¼ í•  ê²ƒ&lt;/h2>
&lt;ul>
&lt;li>Airflow ì²« ì‹¤í–‰ í›„ì—” ë³´í†µ &lt;strong>ê´€ë¦¬ì ê³„ì • ìƒì„±&lt;/strong>ë„ í•´ì¤˜ì•¼ í•¨:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># airflow ì»¨í…Œì´ë„ˆ ì ‘ì†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker exec -it airflow bash
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ê´€ë¦¬ì ê³„ì • ìƒì„±&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>airflow users create &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --username airflow &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --password airflow &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --firstname Keoho &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --lastname Ban &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --role Admin &lt;span style="color:#ae81ff">\
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">&lt;/span> --email airflow@example.com
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h3 id="-êµ¬ì¶•-tip-airflow-fastapi-mlflow-ê°„-ê³µìœ -ë³¼ë¥¨-êµ¬ì¡°-í™•ì¸">ğŸ” [êµ¬ì¶• Tip] &lt;strong>Airflow, FastAPI, MLflow ê°„ ê³µìœ  ë³¼ë¥¨ êµ¬ì¡° í™•ì¸&lt;/strong>&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ê³µìœ  ë¦¬ì†ŒìŠ¤&lt;/th>
&lt;th>ì„¤ëª…&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (MLflow)&lt;/td>
&lt;td>MLflow ì„œë²„ê°€ ì“°ëŠ” ë¡œê·¸/ëª¨ë¸ ì €ì¥ì†Œ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (Airflow)&lt;/td>
&lt;td>í•™ìŠµ í›„ ëª¨ë¸ ì €ì¥ ìœ„ì¹˜ ê³µìœ &lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>./mlflow_store:/mlflow&lt;/code> (FastAPI)&lt;/td>
&lt;td>ëª¨ë¸ ì¶”ë¡  ì‹œ ë¡œë“œ ê²½ë¡œ ê³µìœ &lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>â¡ &lt;strong>ê²½ë¡œ í†µì¼ì„±&lt;/strong>ì´ ë§¤ìš° ì¤‘ìš”í•¨! ì§€ê¸ˆì€ ëª¨ë‘ &lt;code>./mlflow&lt;/code>ë¡œ ê³µìœ  (./mlflow í•˜ìœ„ì— /mlruns ì¡´ì¬)&lt;/p></description></item><item><title>[MLflow : Tracking + FastAPI ì—°ë™]</title><link>https://keonhoban.github.io/mlops-journey/projects/mlflow/01/</link><pubDate>Fri, 06 Jun 2025 15:14:40 +0900</pubDate><guid>https://keonhoban.github.io/mlops-journey/projects/mlflow/01/</guid><description>&lt;blockquote>
&lt;p>ëª©í‘œ&lt;/p>
&lt;ol>
&lt;li>MLflow Tracking Server êµ¬ì„±&lt;/li>
&lt;li>ì‹¤í—˜(Experiment), íŒŒë¼ë¯¸í„°, ë©”íŠ¸ë¦­, ì•„í‹°íŒ©íŠ¸ ê¸°ë¡&lt;/li>
&lt;li>ëª¨ë¸ ë“±ë¡ â†’ Stage ì´ë™ â†’ API ì—°ë™ê¹Œì§€&lt;/li>
&lt;/ol>&lt;/blockquote>
&lt;p>ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” &lt;a href="https://github.com/keonhoban/mlops-infra-labs/tree/main/mlflow">ğŸ”— GitHub (Mlflow - Tracking + FastAPI)&lt;/a>&lt;/p>
&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ì „ì²´-íë¦„-ìš”ì•½">ğŸ§­ ì‹¤ìŠµ ì „ì²´ íë¦„ ìš”ì•½&lt;/h2>
&lt;pre tabindex="0">&lt;code>[1ë‹¨ê³„] MLflow Tracking Server êµ¬ì„± (ë¡œì»¬ í™˜ê²½ì—ì„œ ì‹¤í–‰)
[2ë‹¨ê³„] ì‹¤í—˜ ì‹¤í–‰ (train.py) â†’ ëª¨ë¸ í•™ìŠµ, ê¸°ë¡
[3ë‹¨ê³„] ëª¨ë¸ ë“±ë¡ ë° Stage ì„¤ì • (Production ì´ë™)
[4ë‹¨ê³„] FastAPI ì—°ë™ â†’ ì˜ˆì¸¡ API ì„œë¹„ìŠ¤
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-ì‹¤ìŠµ-ë””ë ‰í† ë¦¬-ì˜ˆì‹œ">ğŸ§© ì‹¤ìŠµ ë””ë ‰í† ë¦¬ ì˜ˆì‹œ&lt;/h2>
&lt;pre tabindex="0">&lt;code>mlops-mlflow/
â”œâ”€â”€ app/
â”‚ â”œâ”€â”€ train.py # ëª¨ë¸ í›ˆë ¨ ë° ì‹¤í—˜ ê¸°ë¡
â”‚ â””â”€â”€ model.pkl # ì €ì¥ëœ ëª¨ë¸
â”œâ”€â”€ mlruns/ # ì‹¤í—˜ ë°ì´í„° ìë™ ìƒì„±
â”œâ”€â”€ fastapi_app/
â”‚ â””â”€â”€ app.py # FastAPI ì˜ˆì¸¡ API
â”œâ”€â”€ Dockerfile (ì„ íƒ)
â””â”€â”€ README.md
&lt;/code>&lt;/pre>&lt;hr>
&lt;h2 id="-1ë‹¨ê³„-mlflow-ì„¤ì¹˜--ì‹¤í–‰">âœ… [1ë‹¨ê³„] MLflow ì„¤ì¹˜ &amp;amp; ì‹¤í–‰&lt;/h2>
&lt;h3 id="-ê°€ìƒ-í™˜ê²½-ì„¤ì •">ğŸ› ï¸ ê°€ìƒ í™˜ê²½ ì„¤ì •&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 1. venv ì„¤ì¹˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo apt install python3-venv -y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 2. ê°€ìƒí™˜ê²½ ìƒì„±&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python3 -m venv .venv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 3. ê°€ìƒí™˜ê²½ í™œì„±í™”&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>source .venv/bin/activate
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 4. íŒ¨í‚¤ì§€ ì„¤ì¹˜&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pip install mlflow scikit-learn pandas fastapi uvicorn
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 5. ë‚˜ê°ˆ ë•Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>deactivate
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="-mlflow-ì„œë²„-ì‹¤í–‰">ğŸ”§ MLflow ì„œë²„ ì‹¤í–‰&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mlflow ui --port &lt;span style="color:#ae81ff">5000&lt;/span> &lt;span style="color:#75715e"># http://localhost:5000 ì—ì„œ UI í™•ì¸&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;hr>
&lt;h2 id="-2ë‹¨ê³„-ì‹¤í—˜-ì‹¤í–‰-trainpy">ğŸ§ª [2ë‹¨ê³„] ì‹¤í—˜ ì‹¤í–‰ (train.py)&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># app/train.py&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> mlflow.sklearn
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.ensemble &lt;span style="color:#f92672">import&lt;/span> RandomForestClassifier
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.datasets &lt;span style="color:#f92672">import&lt;/span> load_iris
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> sklearn.model_selection &lt;span style="color:#f92672">import&lt;/span> train_test_split
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># MLflow ì„¤ì •&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mlflow&lt;span style="color:#f92672">.&lt;/span>set_tracking_uri(&lt;span style="color:#e6db74">&amp;#34;http://localhost:5000&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mlflow&lt;span style="color:#f92672">.&lt;/span>set_experiment(&lt;span style="color:#e6db74">&amp;#34;iris-rf-exp&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> mlflow&lt;span style="color:#f92672">.&lt;/span>start_run():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> iris &lt;span style="color:#f92672">=&lt;/span> load_iris()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> X_train, X_test, y_train, y_test &lt;span style="color:#f92672">=&lt;/span> train_test_split(iris&lt;span style="color:#f92672">.&lt;/span>data, iris&lt;span style="color:#f92672">.&lt;/span>target, test_size&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">0.2&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> clf &lt;span style="color:#f92672">=&lt;/span> RandomForestClassifier(n_estimators&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">100&lt;/span>, max_depth&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">3&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> clf&lt;span style="color:#f92672">.&lt;/span>fit(X_train, y_train)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> acc &lt;span style="color:#f92672">=&lt;/span> clf&lt;span style="color:#f92672">.&lt;/span>score(X_test, y_test)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;n_estimators&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">100&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_param(&lt;span style="color:#e6db74">&amp;#34;max_depth&amp;#34;&lt;/span>, &lt;span style="color:#ae81ff">3&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>log_metric(&lt;span style="color:#e6db74">&amp;#34;accuracy&amp;#34;&lt;/span>, acc)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mlflow&lt;span style="color:#f92672">.&lt;/span>sklearn&lt;span style="color:#f92672">.&lt;/span>log_model(clf, &lt;span style="color:#e6db74">&amp;#34;model&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ì‹¤í—˜ ì‹¤í–‰&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>python app/train.py
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>ì‹¤í—˜ì´ ëë‚˜ë©´ mlruns/ í´ë”ì— ì‹¤í—˜ ê¸°ë¡ ë° ëª¨ë¸ì´ ì €ì¥&lt;/p></description></item></channel></rss>