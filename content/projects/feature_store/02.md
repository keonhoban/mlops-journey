+++
date = '2026-01-17T16:23:10+12:00'
draft = false
title = '[Feature Store & Feast - ê²€ì¦(Proof)]'
categories = ['MLOps Pipeline', 'GitOps(ArgoCD)', 'Airflow', 'Proof of Feature Store & Feast'] 
+++

### GitOpsë¡œ ê³„ì•½ ë°°í¬ + Airflowë¡œ ë²„ì „í™”/Latest ì €ì¥ + (ì˜µì…˜ B) Feast ì¡°íšŒê¹Œì§€ E2E ì¦ëª…

---

## ğŸ§­ ëª©ì°¨

| êµ¬ë¶„ | ì¦ëª… í¬ì¸íŠ¸ |
| --- | --- |
| **A. GitOps ë¶„ë¦¬** | devÂ·prod ë…ë¦½ ë°°í¬ + ìƒíƒœ ê³ ì •(Synced/Healthy) |
| **B. Contract ê³ ì •** | ê³„ì•½(schema/repo)ì„ ìš´ì˜ ë¦¬ì†ŒìŠ¤ë¡œ ë°°í¬Â·ë§ˆìš´íŠ¸ |
| **C. íŒŒì´í”„ë¼ì¸** | Airflow DAG E2E ì„±ê³µ |
| **D. ì €ì¥ ì •ì±…** | S3 version 1ë‹¨ + latest ë™ì‹œ ìœ ì§€ |
| **E. ì¬í˜„ì„±** | schema_hashÂ·metadataë¡œ ìƒì„± ì¡°ê±´ ê¸°ë¡ |
| **F. Feast ê²€ì¦** | apply â†’ materialize â†’ online ì¡°íšŒ ì„±ê³µ |
| **G. ë³µêµ¬ ì „ëµ** | ì‹¤ì œ ì¥ì•  ì¬í˜„ â†’ í•´ê²° â†’ ê°€ë“œë ˆì¼ ê³ ì • |

> ì´ ê¸€ì€ â€œì„¤ëª…â€ì´ ì•„ë‹ˆë¼ â€œì¦ê±°â€ë§Œ ë‚¨ê¹ë‹ˆë‹¤.
> 
> 
> ìº¡ì²˜(Proof)ì™€ í•¨ê»˜ **ì„±ê³µ ì¡°ê±´ / í™•ì¸ í¬ì¸íŠ¸ / ê²°ë¡ **ì„ ì²´í¬ë¦¬ìŠ¤íŠ¸ì²˜ëŸ¼ ê³ ì •í–ˆìŠµë‹ˆë‹¤.
> 

---

# A. GitOps & Dev/Prod ë¶„ë¦¬

## A-1) ArgoCD Applications ìƒíƒœ ì¦ëª…

ğŸ“¸ **proof-fs-01.png**

- ArgoCD UIì—ì„œ `feature-store-dev`, `feature-store-prod` (ë˜ëŠ” `feast-dev`, `feast-prod`) í™•ì¸
- Status: **Synced / Healthy**

**í™•ì¸ í¬ì¸íŠ¸**

- dev/prodê°€ **ì„œë¡œ ë‹¤ë¥¸ Application**ìœ¼ë¡œ ì¡´ì¬
- Git ë³€ê²½ì´ ì—†ì„ ë•Œ **idempotent ìƒíƒœ** ìœ ì§€ (ë¶ˆí•„ìš”í•œ drift ì—†ìŒ)

**ğŸ‘‰ ê²°ë¡ **

dev/prodê°€ GitOps ê¸°ì¤€ìœ¼ë¡œ ë…ë¦½ ë°°í¬ë˜ë©°, ìš´ì˜ ìƒíƒœê°€ ì•ˆì •ì ìœ¼ë¡œ ê³ ì •ë©ë‹ˆë‹¤.

---

# B. Contract(ê³„ì•½) ìš´ì˜ ë¦¬ì†ŒìŠ¤í™” & ë§ˆìš´íŠ¸ ê²€ì¦

## B-1) (ì˜µì…˜ A) Schema/Metadata ConfigMap ë°°í¬ ì¦ëª…

ğŸ“¸ **proof-fs-02-01.png**

- ConfigMap: `feature-store-resources`
- í¬í•¨ íŒŒì¼:
    - `user_features.schema.json`
    - `metadata.json.j2`

**í™•ì¸ í¬ì¸íŠ¸**

- ê³„ì•½ì´ ì½”ë“œê°€ ì•„ë‹ˆë¼ **ìš´ì˜ ë¦¬ì†ŒìŠ¤(ConfigMap)**ë¡œ ë°°í¬ë¨
- dev/prodì— **ë™ì¼í•œ ê³„ì•½**ì´ ë°˜ì˜ë¨

**ğŸ‘‰ ê²°ë¡ **

ê³„ì•½(Contract)ì´ GitOpsë¡œ ê´€ë¦¬ë˜ë©°, íŒŒì´í”„ë¼ì¸ ì½”ë“œëŠ” ê³„ì•½ì„ **ì½ê¸°ë§Œ í•˜ëŠ” êµ¬ì¡°**ë¡œ ê³ ì •ë©ë‹ˆë‹¤.

---

## B-2) Airflow Pod ë§ˆìš´íŠ¸ ì¦ëª…

ğŸ“¸ **proof-fs-02-02.png**

- Airflow ë‚´ë¶€ íŒŒì¼ í™•ì¸:
    - `/opt/airflow/feature-store/user_features.schema.json`
    - `/opt/airflow/feature-store/metadata.json.j2`

**í™•ì¸ í¬ì¸íŠ¸**

- mountPathê°€ **í‘œì¤€í™”**ë˜ì–´ ìˆìŒ (`/opt/airflow/feature-store/`)
- ì‹¤í–‰ í™˜ê²½ì´ dev/prodì—ì„œ ë™ì¼í•˜ê²Œ ì¬í˜„ ê°€ëŠ¥

**ğŸ‘‰ ê²°ë¡ **

AirflowëŠ” GitOpsë¡œ ë°°í¬ëœ ê³„ì•½ì„ **ë™ì¼í•œ ê²½ë¡œë¡œ ë§ˆìš´íŠ¸**ë°›ì•„ ì‹¤í–‰ ì¡°ê±´ì´ ê³ ì •ë©ë‹ˆë‹¤.

---

## B-3) (ì˜µì…˜ B) Feast Repo ConfigMap(subPath) ë§ˆìš´íŠ¸ ì¦ëª…

ğŸ“¸ **proof-fs-02-03.png**

- ConfigMap: `feast-repo`
- `subPath`ë¡œ íŒŒì¼ë§Œ ë§ˆìš´íŠ¸:
    - `/feast-repo/feature_store.yaml`
    - `/feast-repo/repo.py`

**í™•ì¸ í¬ì¸íŠ¸**

- ConfigMap ì „ì²´ mount ì‹œ ìƒê¸°ëŠ” `..` ë””ë ‰í„°ë¦¬ ì´ìŠˆë¥¼ ì°¨ë‹¨
- repo íŒŒì¼ì´ â€œìš´ì˜ ê³„ì•½â€ìœ¼ë¡œ ì•ˆì •ì ìœ¼ë¡œ ê³ ì •ë¨

**ğŸ‘‰ ê²°ë¡ **

Feast repoëŠ” GitOpsë¡œ ë°°í¬ë˜ê³ , ë§ˆìš´íŠ¸ ë°©ì‹(subPath)ê¹Œì§€ í¬í•¨í•´ **ê¹¨ì§€ì§€ ì•ŠëŠ” í˜•íƒœë¡œ í‘œì¤€í™”**ë©ë‹ˆë‹¤.

---

# C. Airflow íŒŒì´í”„ë¼ì¸ E2E ê²€ì¦ (ì˜µì…˜ A ê³µí†µ)

## C-1) DAG Graph View ì„±ê³µ ì¦ëª…

ğŸ“¸ **proof-fs-03-01.png**

- DAG: `data_pipeline_daily_dev_v4` (ë˜ëŠ” `v5`)
- Task íë¦„:
    - `extract_raw_data â†’ validate_data â†’ build_features â†’ store_features â†’ summarize_run`

**í™•ì¸ í¬ì¸íŠ¸**

- DAGëŠ” ì–‡ìŒ(ì—°ê²°ë§Œ) + ë¡œì§ì€ `mlops_lib/dp/*`ë¡œ ë¶„ë¦¬
- ë§ˆì§€ë§‰ taskì—ì„œ **prefix/version/uri** ê°™ì€ â€œìš´ì˜ì— í•„ìš”í•œ ê²°ê³¼â€ê°€ ë‚¨ìŒ

**ğŸ‘‰ ê²°ë¡ **

ê³„ì•½ ê¸°ë°˜ Feature Store-lite íŒŒì´í”„ë¼ì¸ì´ E2Eë¡œ ì‹¤í–‰ë˜ì–´ ì‚°ì¶œë¬¼ì´ ì €ì¥ë¨ì´ ì¦ëª…ë©ë‹ˆë‹¤.

---

## C-2) KubernetesExecutor Task Podì—ì„œ AWS credential chain ë™ì‘ ì¦ëª…

ğŸ“¸ **proof-fs-03-02.png**

- Task Pod ë¡œê·¸ì—ì„œ `head_object/put_object` ì„±ê³µ í™•ì¸
- (shared credentials mount ê¸°ë°˜)

**í™•ì¸ í¬ì¸íŠ¸**

- â€œschedulerëŠ” ë˜ëŠ”ë° Task Podì—ì„œ ê¹¨ì§€ëŠ”â€ í”í•œ ì‹¤íŒ¨ ì§€ì ì„ í†µê³¼
- Task Pod ë‹¨ìœ„ì—ì„œ S3 ì ‘ê·¼ì´ ì‹¤ì œë¡œ ë™ì‘

**ğŸ‘‰ ê²°ë¡ **

ì‹¤ìŠµ í™˜ê²½ì—ì„œë„ **Task Pod ë ˆë²¨**ì˜ AWS ì¸ì¦ ì²´ì¸ì´ ë™ì‘í•¨ì„ í™•ì¸í–ˆê³ , ìš´ì˜ì—ì„œ í”íˆ ê¹¨ì§€ëŠ” ì§€ì ì„ ì„ ì œ ê³ ì •í–ˆìŠµë‹ˆë‹¤.

---

# D. S3 ì €ì¥ ì •ì±… ì¦ëª… (ë²„ì „í™” 1ë‹¨ + (ì˜µì…˜ B) latest)

## D-1) (ì˜µì…˜ A) ë²„ì „í™” prefix ìƒì„± ì¦ëª…

ğŸ“¸ **proof-fs-04-01.png**

- ìƒì„± ê·œì¹™:
    - `s3://<feature_base>/<feature_set>/v_YYYYMMDDTHHMMSS/`
- ë™ì¼ prefixì— **3íŒŒì¼ ì„¸íŠ¸** ì¡´ì¬:
    - `features.csv`, `schema.json`, `metadata.json`

**ğŸ‘‰ ê²°ë¡ **

ë²„ì „í™” depthëŠ” 1ë‹¨ìœ¼ë¡œ ê³ ì •ë˜ì–´ ì¬í˜„ì„±ì„ ë³´ì¥í•˜ê³ , ìš´ì˜ í‘œì¤€ìœ¼ë¡œ ìœ ì§€ë©ë‹ˆë‹¤.

---

## D-2) (ì˜µì…˜ B) version + latest overwrite ë™ì‹œ ìœ ì§€ ì¦ëª…

ğŸ“¸ **proof-fs-04-02.png**

- version ìœ ì§€:
    - `.../<feature_set>/v_YYYY.../`
- latest overwrite:
    - `.../<feature_set>/latest/`
- **4íŒŒì¼ ì„¸íŠ¸** ê³ ì •:
    - `features.parquet`, `features.csv`, `schema.json`, `metadata.json`

**ğŸ‘‰ ê²°ë¡ **

ì¬í˜„ì„±(version)ê³¼ ìš´ì˜ í¸ì˜(latest)ê°€ ë™ì‹œì— ì¶©ì¡±ë˜ì–´, Feast offlineì´ **latestë§Œ ë³´ë©´ ë˜ëŠ” êµ¬ì¡°**ê°€ ì™„ì„±ë©ë‹ˆë‹¤.

---

# E. ì¬í˜„ì„±(Operational Reproducibility) ì¦ëª…

## E-1) metadata.jsonì— ì¬í˜„ì„± í•„ë“œ ê¸°ë¡ ì¦ëª…

ğŸ“¸ **proof-fs-05-01.png**

- `metadata.json` í•„ë“œ:
    - `schema_hash`
    - `feature_uri`
    - `generated_at`
    - `source`
    - `pipeline`

**ğŸ‘‰ ê²°ë¡ **

â€œì˜¤ëŠ˜ ë§Œë“  features.csvâ€ê°€ ì•„ë‹ˆë¼, **ì–¸ì œ/ë¬´ìŠ¨ ê³„ì•½ìœ¼ë¡œ/ì–´ë–¤ ì†ŒìŠ¤ì—ì„œ ìƒì„±ëëŠ”ì§€**ê°€ ì‹œìŠ¤í…œì´ í•´ì„ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ë‚¨ìŠµë‹ˆë‹¤.

---

# F. (ì˜µì…˜ B) Feast ìš´ì˜ ê²€ì¦ (apply â†’ materialize â†’ online ì¡°íšŒ)

## F-1) Feast apply ì„±ê³µ ì¦ëª…

ğŸ“¸ **proof-fs-06-01.png**

- Feast ì„œë²„ startupì—ì„œ `feast apply` ì„±ê³µ
- registryê°€ S3ì— ìƒì„±/ê°±ì‹ ë¨

**ğŸ‘‰ ê²°ë¡ **

Feast ê³„ì•½(repo)ì´ GitOpsë¡œ ë°°í¬ë˜ê³ , ì„œë²„ ê¸°ë™ ì‹œì ì— ìë™ ì ìš©ë˜ì–´ ìš´ì˜ ìƒíƒœê°€ ê³ ì •ë©ë‹ˆë‹¤.

---

## F-2) s3fs í¬í•¨ ì´ë¯¸ì§€ ê²€ì¦ + materialize ì„±ê³µ ì¦ëª…

ğŸ“¸ **proof-fs-06-02.png**

- `ImportError: Install s3fs...` ì¬í˜„ â†’ í•´ê²°
- `s3fs` ë²„ì „ ì¶œë ¥ OK
- materialize ì‹¤í–‰ ì„±ê³µ

**ğŸ‘‰ ê²°ë¡ **

Offline(S3 parquet) â†’ Online(Redis) ì ì¬ê°€ ì‹¤ì œë¡œ ë™ì‘í•¨ì´ ì¦ëª…ë©ë‹ˆë‹¤.

---

## F-3) online(redis) ì¡°íšŒ ì„±ê³µ ì¦ëª…

ğŸ“¸ **proof-fs-06-03.png**

- `get_online_features()` ê²°ê³¼ê°€ Noneì´ ì•„ë‹Œ ì‹¤ì œ ìˆ˜ì¹˜ë¡œ ì¶œë ¥

**ğŸ‘‰ ê²°ë¡ **

Feature StoreëŠ” â€œì €ì¥â€ì—ì„œ ëë‚˜ì§€ ì•Šê³ , **ì¡°íšŒ ê°€ëŠ¥í•œ í”¼ì²˜ í”Œë«í¼**ìœ¼ë¡œ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

---

# G. ì‹¤íŒ¨/ë³µêµ¬(ìš´ì˜ ì´ìŠˆ) ì‹¤ì¦

## G-1) Airflow Variable SDK ì°¨ì´ ì´ìŠˆ ì¬í˜„/í•´ê²°

ğŸ“¸ **proof-fs-07-01.png**

- ì—ëŸ¬:
    - `Variable.get() got an unexpected keyword argument 'default_var'`
- í•´ê²°:
    - `try: Variable.get(key) except: default` íŒ¨í„´ìœ¼ë¡œ ì•ˆì „í™”

**ğŸ‘‰ ê²°ë¡ **

ë²„ì „/SDK ì°¨ì´ë¡œ ê¹¨ì§€ëŠ” ì§€ì ì„ ì‹¤í–‰ ë¡œê·¸ë¡œ í™•ì¸í–ˆê³ , ì¬ë°œ ë°©ì§€ë¥¼ ìœ„í•œ **ìš´ì˜ ì•ˆì „ íŒ¨í„´**ìœ¼ë¡œ ê³ ì •í–ˆìŠµë‹ˆë‹¤.

---

## G-2) `.airflowignore`ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìŠ¤ìº” ì°¨ë‹¨ ì¦ëª…

ğŸ“¸ **proof-fs-07-02.png**

- `mlops_lib/` ìŠ¤ìº” ì°¨ë‹¨ í›„ import ì˜¤ë¥˜ ì¬ë°œ ì—†ìŒ

**ğŸ‘‰ ê²°ë¡ **

DAG ì–‡ê²Œ/ë¡œì§ ë¶„ë¦¬ êµ¬ì¡°ê°€ Airflow ìŠ¤ìº” ì •ì±…ê³¼ ì¶©ëŒí•˜ì§€ ì•Šë„ë¡ **ìš´ì˜í˜• ê°€ë“œë ˆì¼**ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤.

---

# ğŸ ì •ë¦¬

- GitOpsë¡œ dev/prodê°€ ë¶„ë¦¬ ë°°í¬ë˜ê³ 
- ê³„ì•½(Contract)ì´ ìš´ì˜ ë¦¬ì†ŒìŠ¤ë¡œ ê³ ì •ë˜ì–´ íŒŒì´í”„ë¼ì¸ì€ ì½ê¸°ë§Œ í•˜ë©°
- Airflow íŒŒì´í”„ë¼ì¸ì€ E2Eë¡œ ì‹¤í–‰ë˜ì–´ S3ì— ë²„ì „í™” ì‚°ì¶œë¬¼ì´ ì €ì¥ë˜ê³ 
- (ì˜µì…˜ B) version + latest ì €ì¥ ì •ì±…ìœ¼ë¡œ Feastê°€ ì¦‰ì‹œ ì¡°íšŒ ê°€ëŠ¥í•˜ë©°
- schema_hash/metadataë¡œ ì¬í˜„ì„±ì´ ì¦ëª…ë˜ê³ 
- ì‹¤ì œë¡œ ê¹¨ì¡Œë˜ ìš´ì˜ ì´ìŠˆë¥¼ ì¬í˜„/í•´ê²°í•˜ì—¬ â€œê¹¨ì§€ì§€ ì•ŠëŠ” êµ¬ì¡°â€ë¡œ ê³ ì •í–ˆìŠµë‹ˆë‹¤.
