+++
date = '2025-04-25T11:07:57+09:00'
draft = false
title = '[ì…¸ ìŠ¤í¬ë¦½íŠ¸] 03. Deployment'
categories = 'Linux'
+++

# âœ… ëª¨ë¸ íŒ¨í‚¤ì§• ë° ë°°í¬

## 1. ðŸŽ¯ ëª©í‘œ

> ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì„ ìš´ì˜ í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ë°°í¬í•˜ê¸° ìœ„í•œ
> 
> 
> **ëª¨ë¸ íŒŒì¼ ì ê²€ â†’ ì••ì¶• â†’ ë³µì› â†’ ì›ê²© ë°°í¬** ê³¼ì •ì„
> 
> **í•˜ë‚˜ì˜ í†µí•© ìŠ¤í¬ë¦½íŠ¸**ë¡œ ìžë™í™”í•©ë‹ˆë‹¤.
> 

---

## 2. ðŸ§  íë¦„ ìš”ì•½

```
[ëª¨ë¸ ë””ë ‰í† ë¦¬ ì ê²€]
     â†“
[ëª¨ë¸ ì••ì¶• (archive)]
     â†“
[í•„ìš”ì‹œ ë³µì› (restore)]
     â†“
[ë°°í¬ ì„œë²„ì— SCP ì „ì†¡ (deploy)]
```

---

## 3. ðŸ”§ ì „ì²´ ì½”ë“œ (ì£¼ì„ í¬í•¨)

```bash
#!/usr/bin/env bash
set -euo pipefail

MODE=${1:-"check"}  # check, archive, restore, deploy
TARGET_DIR=${2:-"/opt/ml/models"}
ARCHIVE_FILE=${3:-"models.tar.gz"}
REQUIRED_FILES=("model.py" "requirements.txt" "config.yaml")

# ê°„ë‹¨í•œ ë¡œê·¸ í•¨ìˆ˜
log() { echo "[$(date '+%F %T')] $1"; }

# 1. í•„ìˆ˜ íŒŒì¼ ì¡´ìž¬ ì—¬ë¶€ í™•ì¸
check() {
    [[ -d "$TARGET_DIR" ]] || { log "Missing dir: $TARGET_DIR"; exit 1; }
    for file in "${REQUIRED_FILES[@]}"; do
        [[ -e "$TARGET_DIR/$file" ]] || { log "Missing file: $file"; exit 1; }
    done
    log "File check complete"
}

# 2. ëª¨ë¸ ë””ë ‰í† ë¦¬ ì••ì¶•
archive() {
    mkdir -p "$TARGET_DIR"
    tar -czf "$ARCHIVE_FILE" -C "$TARGET_DIR" .
    log "Archive created: $ARCHIVE_FILE"
}

# 3. ì••ì¶•ëœ ëª¨ë¸ ë³µì›
restore() {
    [[ -e "$ARCHIVE_FILE" ]] || { log "Missing archive: $ARCHIVE_FILE"; exit 1; }
    mkdir -p "$TARGET_DIR"
    tar -xzf "$ARCHIVE_FILE" -C "$TARGET_DIR"
    log "Restore done to $TARGET_DIR"
}

# 4. ëª¨ë¸ ì›ê²© ì„œë²„ë¡œ ì „ì†¡
deploy() {
    USER=${4:-"ubuntu"}
    HOST=${5:-"127.0.0.1"}
    DEST=${6:-"/opt/ml/models"}
    scp "$ARCHIVE_FILE" "$USER@$HOST:$DEST" \
        && log "Deployed to $HOST" \
        || { log "Deployment failed"; exit 1; }
}

# ì‹¤í–‰ ë¶„ê¸°
case "$MODE" in
    check)   check ;;
    archive) archive ;;
    restore) restore ;;
    deploy)  deploy "$@" ;;
    *)
        echo "Usage: $0 [check|archive|restore|deploy] [target_dir] [archive_file] [user] [host] [remote_path]"
        exit 1
        ;;
esac

```

---

## 4. ðŸ“Œ ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| `check` | ëª¨ë¸ ë””ë ‰í† ë¦¬ì— í•„ìˆ˜ íŒŒì¼ ì¡´ìž¬ ì—¬ë¶€ í™•ì¸ |
| `archive` | ë””ë ‰í† ë¦¬ ì „ì²´ ì••ì¶• â†’ `.tar.gz` ìƒì„± |
| `restore` | ì••ì¶• í•´ì œ í›„ ì›ìƒ ë³µì› |
| `deploy` | `scp`ë¡œ ì›ê²© ì„œë²„ ì „ì†¡, ì‚¬ìš©ìž/í˜¸ìŠ¤íŠ¸ ì§€ì • ê°€ëŠ¥ |
| `log()` | ëª¨ë“  ê²°ê³¼ ì‹œê°„ ê¸°ë¡ í¬í•¨, ìš´ì˜ ì¶”ì  ê°€ëŠ¥ |

---

## 5. ðŸ› ï¸ ì‹¤ë¬´ í™œìš© & í™•ìž¥ í¬ì¸íŠ¸

| í™•ìž¥ ë°©í–¥ | ì„¤ëª… |
| --- | --- |
| ë°°í¬ ìžë™í™” | `CI/CD` íŒŒì´í”„ë¼ì¸ì—ì„œ ì´ ìŠ¤í¬ë¦½íŠ¸ í˜¸ì¶œ |
| í™˜ê²½ ì„¤ì • ì™¸ë¶€í™” | `.env` íŒŒì¼ë¡œ ì‚¬ìš©ìž/í˜¸ìŠ¤íŠ¸ ì„¤ì • ê´€ë¦¬ |
| ë°°í¬ í™•ì¸ ë¡œì§ ì¶”ê°€ | `ssh "$HOST" "ls $DEST"`ë¡œ ì „ì†¡ ê²€ì¦ ìžë™í™” |
| ì „ì†¡ ë³´ì•ˆ ê°•í™” | `scp` â†’ `rsync`, `ssh key` ì—°ë™, `Ansible` ë“±ìœ¼ë¡œ í™•ìž¥ |

---

## 6. ðŸ”§ MLOps ì‹¤ì „ ì—°ê²°

| MLOps íë¦„ | ì ìš© ì˜ˆì‹œ |
| --- | --- |
| ëª¨ë¸ ì²´í¬í¬ì¸íŠ¸ ë³´ì¡´ | `archive`ë¥¼ í†µí•´ í•™ìŠµ ëª¨ë¸ ì••ì¶• ì €ìž¥ |
| ëª¨ë¸ ì„œë¹™ í™˜ê²½ ì´ê´€ | `deploy`ë¥¼ í†µí•´ ì„œë²„ ê°„ ëª¨ë¸ ì „ì†¡ |
| ëª¨ë¸ ë¦¬í¬ì§€í„°ë¦¬ ë°±ì—… | `restore`ë¡œ í•„ìš”ì‹œ ë³µì› ê°€ëŠ¥ |
| GitHub Actions + SCP ë°°í¬ | ë°°í¬ ìžë™í™” ìŠ¤í¬ë¦½íŠ¸ì— ì§ì ‘ ì—°ë™ ê°€ëŠ¥ |

---

## 7. âœ… ì •ë¦¬

> ë‹¨ìˆœížˆ scpë¡œ ëª¨ë¸ì„ ë³´ë‚´ëŠ” ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ë‹ˆë¼,
> 
> 
> **ëª¨ë¸ ë°°í¬ ì „ í•„ìˆ˜ ì ê²€ â†’ ì••ì¶• ë³´ì¡´ â†’ ë°°í¬ ìžë™í™”**ê¹Œì§€
> 
> í•„ìš”í•œ **ëª¨ë¸ ê´€ë¦¬ ë£¨í‹´ ì „ì²´ë¥¼ ìžë™í™”** í–ˆìŠµë‹ˆë‹¤.
> 

---

## ðŸ“Ž GitHub ë§í¬

> ðŸ‘‰ [GitHub: model_package_tool.sh](https://github.com/keonhoban/shell-scripts)
>
