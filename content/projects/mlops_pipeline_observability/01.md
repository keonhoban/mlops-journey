+++
date = '2025-11-20T17:10:21+09:00'
draft = false
title = '[MLOps í”Œë«í¼ Observability & Data Pipeline - ì—í•„ë¡œê·¸]'
categories = ['MLOps Pipeline', 'Observability', 'Data Pipeline', 'GitOps(ArgoCD)', 'Kubernetes', 'Architecture', 'FastAPI', 'Airflow', 'MLflow', 'Slack']
+++

## ì—í•„ë¡œê·¸ â€” â€œê´€ì¸¡Â·ì•Œë¦¼Â·ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ì´ì–´ì§€ëŠ” MLOps ìš´ì˜ í”Œë«í¼â€

---

## ğŸ“Œ ì „ì²´ ê²½ë¡œ ìš”ì•½

| ìˆœì„œ | ì£¼ì œ |
| --- | --- |
| 1 | [ğŸ”— kube-prometheus-stack + GitOps êµ¬ì¶•](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/01/) |
| 2 | [ğŸ”— Alertmanager Slack & íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/02/) |
| 3 | [ğŸ”— Prometheus/KSM/Kubelet ì™„ì „ ë¶„ë¦¬ êµ¬ì¡°](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/03/) |
| 4 | [ğŸ”— Loki/Promtail ë¡œê·¸ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/04/) |
| 5 | [ğŸ”— ìš´ì˜ ì¤‘ ë°œìƒí•œ ì‹¤ì œ ì´ìŠˆ & í•´ê²° ê³¼ì •](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/05/) |
| 6 | [ğŸ”— FastAPI Observability Dashboard & Alert Library](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/06/) |
| 7 | [ğŸ”— Data Pipeline êµ¬ì¶•](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/07/) |
| 8 | [ğŸ”— Data Pipeline ê³ ë„í™”](https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/) |
| 9 | [ğŸ”— ê²€ì¦](https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_observability/02/) |

---

## ğŸ¯ **ì „ì²´ íšŒê³  ìš”ì•½**

| ë‹¨ê³„ | í•µì‹¬ ëª©í‘œ | ì£¼ìš” ê°œì„ ì  |
| --- | --- | --- |
| 1 | ëª¨ë‹ˆí„°ë§ ë¼ˆëŒ€ êµ¬ì¶• | kube-prometheus-stack dev/prod ì™„ì „ ë¶„ë¦¬ |
| 2 | Slack ì•ŒëŒ í†µí•© | Alertmanager configSecret í‘œì¤€í™” + ì•ŒëŒ ë¼ìš°íŒ… |
| 3 | ë©”íŠ¸ë¦­ êµì°¨ ìˆ˜ì§‘ ì œê±° | KSM/Kubelet ë¼ë²¨ í†µì¼, Prometheus TSDB local-path |
| 4 | ë¡œê·¸ íŒŒì´í”„ë¼ì¸ ì™„ì„± | Loki/Promtail dev/prod ë¶„ë¦¬ + LogQL Range Query |
| 5 | ì‹¤ì œ ìš´ì˜ ì´ìŠˆ í•´ê²° | ë¼ë²¨/Secret/NFS ê¶Œí•œ/NFS unmount ë¬¸ì œ ì¼ê´„ í•´ê²° |
| 6 | FastAPI/Platform ê´€ì¸¡ ëŒ€ì‹œë³´ë“œ | FastAPI ì„œë¹„ìŠ¤ + Kubernetes/Node í”Œë«í¼ ê´€ì¸¡ ì²´ê³„ ì™„ì„± |
| 7 | Data Pipeline êµ¬ì¶• (v1) | S3 Raw â†’ Feature ETL ìë™í™” (Airflow DAG) |
| 8 | Data Pipeline ê³ ë„í™” (v2) | ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„° ìë™í™” + ê´€ì¸¡ ëŒ€ì‹œë³´ë“œ |
| 9 | ê²€ì¦ | Observability ê³„ì¸µ, Grafana ëŒ€ì‹œë³´ë“œ, Datapipeline |

> ğŸ”„ í•µì‹¬ ë¬¸ì¥:
> 
> 
> **â€œCommit â†’ Deploy â†’ Train â†’ Reload â†’ Observe â†’ Alert â†’ Rollbackâ€
> ì „ì²´ íë¦„ì´ í•˜ë‚˜ì˜ ë£¨í”„ë¡œ ë¬¶ì˜€ìŠµë‹ˆë‹¤.**
> 

---

## ğŸ§© Observability + Data Plane ì „ì²´ êµ¬ì¡°

![mermaid-observability-05-01.png](/mlops-journey/images/mermaid-observability-05-01.png)

**ìš”ì•½í•˜ë©´:**

- **APP ê³„ì¸µ**: FastAPI / Airflow / MLflowê°€ ëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„œë¹™ì„ ë‹´ë‹¹í•˜ê³ ,
- **DATA ê³„ì¸µ**: S3 Raw/Featureê°€ ë°ì´í„° ìˆ˜ëª…ì£¼ê¸°ë¥¼ ì±…ì„ì§€ë©°,
- **OBS ê³„ì¸µ**: Prometheus / Alertmanager / Grafana / Lokiê°€
    
    ë©”íŠ¸ë¦­Â·ì•ŒëŒÂ·ë¡œê·¸ë¥¼ dev/prod ì™„ì „íˆ ë¶„ë¦¬í•´ì„œ ëŒì–´ì•ˆê³  ìˆìŠµë‹ˆë‹¤.
    

---

## ğŸ” One Commit â†’ Observability â†’ Data Pipeline Flow

![mermaid-observability-05-02.png](/mlops-journey/images/mermaid-observability-05-02.png)

> í•œ ì¤„ë¡œ ìš”ì•½í•˜ë©´:
> 
> 
> **Commit â†’ GitOps ë°°í¬ â†’ Airflow í•™ìŠµ/ë°ì´í„° íŒŒì´í”„ë¼ì¸ â†’ FastAPI í•«ìŠ¤ì™‘ â†’
> ë©”íŠ¸ë¦­Â·ë¡œê·¸Â·ì•ŒëŒ â†’ Slack â†’ (í•„ìš” ì‹œ) ë¡¤ë°±/ì¡°ì¹˜**
> ê¹Œì§€ í•œ ë£¨í”„ ì•ˆì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ëŒë„ë¡ ì„¤ê³„í•œ ì‹œë¦¬ì¦ˆì…ë‹ˆë‹¤.
> 

---

## ğŸ§  ìš´ì˜ ì›ì¹™ ì •ë¦¬

- **í™˜ê²½ ë¶„ë¦¬**
    - `monitoring-dev / monitoring-prod`, `loki-dev / loki-prod`, `fastapi-dev / fastapi-prod`
        
        â†’ ê´€ì¸¡Â·ë¡œê·¸Â·ì„œë¹™ ëª¨ë‘ dev/prod **ë¼ë²¨Â·ì…€ë ‰í„° ê¸°ì¤€ìœ¼ë¡œ ì ˆë‹¨**
        
- **Observability í‘œì¤€**
    - ë©”íŠ¸ë¦­: Prometheus + kube-prometheus-stack
    - ë¡œê·¸: Loki + Promtail, LogQL Range Query ê¸°ì¤€
    - ì•ŒëŒ: Alertmanager â†’ Slack, WatchdogÂ·ì¡ì†ŒìŒ null receiver í•„í„°ë§
- **ì„±ëŠ¥Â·ì•ˆì •ì„±**
    - Prometheus TSDB: `local-path` (ê³  IOPS)
    - Grafana / Alertmanager / Loki: NFS(`nfs-observability`)ë¡œ ì¥ê¸° ë³´ê´€
- **FastAPI ìš´ì˜ ê·œì¹™**
    - `/metrics` â†’ Prometheus
    - `/predict`, `/variant/{alias}/predict`, `/variant/{alias}/reload` ê²½ë¡œëŠ”
        
        A/BÂ·CanaryÂ·Blue-Greenì„ ëª¨ë‘ ìˆ˜ìš©í•˜ëŠ” ë² ì´ìŠ¤ ë¼ìš°íŒ…
        
    - FastAPI ì „ìš© Dashboard & Alert Libraryë¡œ
        
        **ì§€ì—°Â·ì—ëŸ¬Â·ì¸ìŠ¤í„´ìŠ¤ ë‹¤ìš´Â·ë¡œê·¸ ìŠ¤íŒŒì´í¬**ë¥¼ ì¦‰ì‹œ ê°ì§€
        
- **ë°ì´í„° íŒŒì´í”„ë¼ì¸**
    - S3 Raw â†’ Extract/Validate/Feature/Store â†’ Feature S3 (Airflow DAG ìë™í™”)
    - ì‹¤í–‰ë§ˆë‹¤ `v_íƒ€ì„ìŠ¤íƒ¬í”„` í´ë” ìƒì„± í›„ `feature.csv / schema.json / metadata.json` ì €ì¥
    - KST ë²„ì „ ê´€ë¦¬ + ì‹¤í–‰ í’ˆì§ˆ(Log/Loki)ê¹Œì§€ í•œ ë²ˆì— ì¶”ì 
- **GitOps ë³µì›ë ¥**
    - ëª¨ë“  êµ¬ì„±(YAML / Helm values / SealedSecret)ì€ Git ê¸°ì¤€
    - ìƒˆ í´ëŸ¬ìŠ¤í„°ë¥¼ ê¹”ì•„ë„ **AÂ·BÂ·C ì‹œë¦¬ì¦ˆ ì „ì²´ë¥¼ ê·¸ëŒ€ë¡œ ì¬í˜„ ê°€ëŠ¥**

---

## âœ… ìµœì¢… ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ]  `prometheus-{dev,prod}.local` ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ namespaceë§Œ ë³´ì´ëŠ”ì§€
    
    (devì—ì„œ prod ë©”íŠ¸ë¦­ì´ ì„ì´ì§€ ì•ŠëŠ”ì§€)
    
- [ ]  Alertmanager `/api/v2/status` ì—ì„œ
    
    `configSecret=alertmanager-config-{dev,prod}` ë¡œ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€
    
- [ ]  Loki `/loki/api/v1/query_range` ë¡œ
    
    `namespace=fastapi-{dev,prod}`, `airflow-{dev,prod}` ë¡œê·¸ê°€ ì •ìƒ ì¡°íšŒë˜ëŠ”ì§€
    
- [ ]  FastAPI ëŒ€ì‹œë³´ë“œì—ì„œ RPS / p95 / ErrorRate / ë¡œê·¸ íŒ¨ë„ì´
    
    **ë™ì¼ ì‹œê°„ëŒ€ì— ê°™ì€ íŒ¨í„´**ì„ ë³´ì—¬ì£¼ëŠ”ì§€
    
- [ ]  Data Pipeline DAG(Extract â†’ Validate â†’ Build Features â†’ Store â†’ Summarize)ê°€
    
    Raw S3 â†’ Feature S3ê¹Œì§€ ì—ëŸ¬ ì—†ì´ í•œ ë²ˆì— íë¥´ëŠ”ì§€
    
- [ ]  Slackì— FastAPI / Observability / Data Pipeline ê´€ë ¨ ì•ŒëŒì´
    
    devÂ·prod ê° ì±„ë„ë¡œ **ì •í™•íˆ ë¶„ë¦¬**ë˜ì–´ ë“¤ì–´ì˜¤ëŠ”ì§€

- [ ]  Data Pipeline v2ê°€ Raw S3 â†’ Feature S3ê¹Œì§€ ì •ìƒ ì‹¤í–‰ë˜ëŠ”ì§€
(`v_íƒ€ì„ìŠ¤íƒ¬í”„` ë²„ì „ ë””ë ‰í„°ë¦¬ + 3ì¢… íŒŒì¼ ìƒì„± ì—¬ë¶€)

- [ ]  Grafana â€œLogs & Metrics (Compact)â€ì—ì„œ `[DP]` ë¡œê·¸ì™€ summarize_runì´ ì •ìƒ í‘œì‹œë˜ëŠ”ì§€    

---

## ğŸ íšŒê³ 

> ê´€ì¸¡Â·ì•Œë¦¼ ì¸í”„ë¼ì˜ ë¼ˆëŒ€ì™€ ì•ˆì •ì„±ì„ ë§Œë“¤ê³ ,
> 
> 
> **FastAPI ì¤‘ì‹¬ ê´€ì¸¡Â·ì•ŒëŒ ë ˆì´ì–´**ë¥¼ ì–¹ì—ˆìœ¼ë©°,
> 
> **ë°ì´í„° íŒŒì´í”„ë¼ì¸ ë ˆì´ì–´**ê¹Œì§€ ì™„ì„±í–ˆìŠµë‹ˆë‹¤.
> 
> êµ¬ì„±í•œ ë¡œì»¬ í´ëŸ¬ìŠ¤í„°ëŠ”
> 
> â€œëª¨ë¸ì´ í•™ìŠµë˜ê³ , ë°°í¬ë˜ê³ , ë¬¸ì œê°€ ìƒê¸°ë©´ ë°”ë¡œ ê°ì§€ë˜ê³ ,
> 
> ë°ì´í„°ë¶€í„° ë¡œê·¸Â·ë©”íŠ¸ë¦­Â·ì•ŒëŒê¹Œì§€ í•œ ë²ˆì— ì¶”ì  ê°€ëŠ¥í•œ **ìš´ì˜í˜• ML Platform**â€ ì´ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
>

## ğŸ™Œ í”„ë¡œì íŠ¸ GitHub ì €ì¥ì†Œ

- GitHub ì½”ë“œ: [[GitOps] mlops-platform](https://github.com/keonhoban/mlops-infra-labs/tree/main/mlops-platform)

