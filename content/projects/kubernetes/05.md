+++
date = '2025-06-05T20:06:43+09:00'
draft = false
title = '[Kubernetes ì‹¤ìŠµ - 5ë‹¨ê³„: Prometheus + Grafana ëª¨ë‹ˆí„°ë§]'
categories = 'Kubernetes'
+++

> ëª©í‘œ
> 
> 1. ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ ìì›(Pod, Node ë“±) ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
> 2. Prometheusë¡œ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ â†’ Grafana ëŒ€ì‹œë³´ë“œ ì‹œê°í™”
> 3. ì‹¤ë¬´ MLOps í™˜ê²½ì—ì„œ ëª¨ë‹ˆí„°ë§ ì•„í‚¤í…ì²˜ êµ¬ì¶• ê¸°ë°˜ ë‹¤ì§€ê¸°

ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œ: [ğŸ”— GitHub (Monitoring)](https://github.com/keonhoban/mlops-infra-labs/tree/main/k8s-basic/05_Prometheus_and_Grafana)

---

## ğŸ§­ ì „ì²´ íë¦„ ìš”ì•½

```
â‘  Helm ì €ì¥ì†Œ ì¶”ê°€
â‘¡ Prometheus ì„¤ì¹˜ (ë©”íŠ¸ë¦­ ìˆ˜ì§‘)
â‘¢ Grafana ì„¤ì¹˜ (ëŒ€ì‹œë³´ë“œ ì‹œê°í™”)
â‘£ Web UI ì ‘ì† â†’ Prometheus ì—°ê²° â†’ ëŒ€ì‹œë³´ë“œ ë¶ˆëŸ¬ì˜¤ê¸°
```

---

## ğŸ“‚ ë””ë ‰í† ë¦¬ êµ¬ì„±

```
k8s-monitoring/
â”œâ”€â”€ values-prometheus.yaml   # Prometheus ì»¤ìŠ¤í„°ë§ˆì´ì§• ì„¤ì •
â”œâ”€â”€ values-grafana.yaml      # Grafana ì„¤ì • + ë¹„ë°€ë²ˆí˜¸ ì§€ì •
â”œâ”€â”€ README.md
```

---

## âš™ï¸ [1ë‹¨ê³„] Helm ì €ì¥ì†Œ ì¶”ê°€

```bash
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo add grafana https://grafana.github.io/helm-charts
helm repo update
```

---

## ğŸ“¦ [2ë‹¨ê³„] Prometheus ì„¤ì¹˜

### ğŸ”¹ ê¸°ë³¸ ì„¤ì¹˜

```bash
helm install prometheus prometheus-community/prometheus
```

```bash
kubectl port-forward svc/prometheus-server 9090:80
```

ì ‘ì†: `http://localhost:9090`

---

### ğŸ”¹ NodePort ì„¤ì • (ì„ íƒ)

```yaml
# values-prometheus.yaml
server:
  service:
    type: NodePort
    nodePort: 30091
```

```bash
helm install prometheus prometheus-community/prometheus -f values-prometheus.yaml
```

ì ‘ì†: `http://<minikube-ip>:30091`

---

## ğŸ“ˆ [3ë‹¨ê³„] Grafana ì„¤ì¹˜

### ğŸ”¹ ê¸°ë³¸ ì„¤ì¹˜

```bash
helm install grafana grafana/grafana
kubectl port-forward svc/grafana 3000:80
```

ì ‘ì†: `http://localhost:3000`

- ID: `admin`
- PW: secretì—ì„œ ì¶”ì¶œ

## ğŸ” Grafana ì ‘ì† ë¹„ë°€ë²ˆí˜¸ í™•ì¸ (secret ì¶”ì¶œ)

```bash
kubectl get secret grafana -o jsonpath="{.data.admin-password}" | base64 -d
```

ë˜ëŠ” `values-grafana.yaml`ì—ì„œ ì§ì ‘ ì§€ì •

### ğŸ”¹ NodePort ì„¤ì¹˜ + ë¹„ë°€ë²ˆí˜¸ ì„¤ì •

```yaml
# values-grafana.yaml
service:
  type: NodePort
  nodePort: 30092
adminPassword: "admin1234"
```

```bash
helm install grafana grafana/grafana -f values-grafana.yaml
```

ì ‘ì†: `http://<minikube-ip>:30092`

- ID: `admin`
- PW: `admin1234` (ë˜ëŠ” secretì—ì„œ ì¶”ì¶œ)

---

## ğŸ§ª [4ë‹¨ê³„] Grafanaì—ì„œ Prometheus ì—°ê²°

1. ì¢Œì¸¡ í†±ë‹ˆë°”í€´ > **Data Sources**
2. **Prometheus** ì„ íƒ
    
    â†’ URL: `http://prometheus-server`
    

---

## ğŸ“Š [5ë‹¨ê³„] ëŒ€ì‹œë³´ë“œ ê°€ì ¸ì˜¤ê¸°

1. ì¢Œì¸¡ + ë²„íŠ¼ > Import
2. Dashboard ID:
    - `315` (Kubernetes cluster monitoring)
    - `6417` (Node Exporter Full)

---

## âœ… ì •ë¦¬ ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ì—­í•  |
| --- | --- |
| **Prometheus** | ì¿ ë²„ë„¤í‹°ìŠ¤ ìì› ëª¨ë‹ˆí„°ë§ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ |
| **Grafana** | ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ì‹œê°í™” ë„êµ¬ |
| **Helm** | íŒ¨í‚¤ì§€ ê´€ë¦¬ (ì„¤ì¹˜/ì—…ê·¸ë ˆì´ë“œ/ì‚­ì œ ìë™í™”) |
| **NodePort/port-forward** | ì›¹ UI ì ‘ì† ë°©ì‹ ì„ íƒ ê°€ëŠ¥ |

---

## ğŸ§© ì‹¤ë¬´ íŒ

- `values.yaml` í™œìš©ìœ¼ë¡œ í¬íŠ¸ ë° ë¹„ë°€ë²ˆí˜¸ ì œì–´ â†’ ìš´ì˜ í™˜ê²½ì—ì„œ í•„ìˆ˜
- ëª¨ë‹ˆí„°ë§ êµ¬ì„±ì€ **ML ì‹¤í—˜ í™˜ê²½ ì¶”ì ** + **ë°°í¬ ì„œë¹„ìŠ¤ ìƒíƒœ ì ê²€**ì— í•„ìˆ˜
- ì‹¤ë¬´ì—ì„œëŠ” Prometheus Operator, Loki(ë¡œê·¸ ìˆ˜ì§‘)ì™€ ì—°ê³„í•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ

---

## ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°

| ì‹¤ë¬´ ì‹œë‚˜ë¦¬ì˜¤ | ëª¨ë‹ˆí„°ë§ ì ìš© ë°©ì‹ |
| --- | --- |
| ML ëª¨ë¸ ì„œë¹™ ì§€ì—° ì¶”ì  | Prometheus + ì»¤ìŠ¤í…€ Exporter |
| ëª¨ë¸ ì‹¤í—˜ ëª¨ë‹ˆí„°ë§ | Pod ìƒíƒœ ë° ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì¶”ì  |
| ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ìš´ì˜ | Grafana ê³µìœ ìš© Dashboard êµ¬ì„± |
| ì¿ ë²„ë„¤í‹°ìŠ¤ í”Œë«í¼ ìƒíƒœ ì²´í¬ | kube-state-metrics, node exporter ì—°ë™ |
