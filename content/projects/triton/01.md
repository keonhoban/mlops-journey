+++
date = '2026-01-05T11:03:22+09:00'
draft = false
title = '[Triton ìš´ì˜í˜• ì„œë¹™ í”Œë«í¼ (GitOps Â· ê²€ì¦ Â· Alerting) - ì—í•„ë¡œê·¸]'
categories = ['Triton', 'GitOps(ArgoCD)', 'Helm', 'Kubernetes', 'Grafana', 'ONNX', 'NFS']
+++

## ì—í•„ë¡œê·¸ â€” â€œGitOps ê¸°ë°˜ Triton ì„œë¹™ì´ â€˜ë°°í¬â†’ê²€ì¦â†’ê´€ì¸¡â†’ì•Œë¦¼â€™ ë£¨í”„ë¡œ ê³ ì •ë˜ë‹¤â€

---

## ğŸ“Œ ì „ì²´ ê²½ë¡œ ìš”ì•½

| ìˆœì„œ | ì£¼ì œ |
| --- | --- |
| 1 | [ğŸ”— Triton (CPU-only) GitOps í†µí•©: ONNX 1ê°œ ì„œë¹™ + Prometheus/Grafana ê´€ì¸¡](https://keonhoban.github.io/mlops-journey/posts/triton/01/) |
| 2 | [ğŸ”— MLflow â†’ Triton ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶• (Airflow ê¸°ë°˜ Â· ê²€ì¦ ì²´ì¸ Â· ìµœì†Œ ë¡¤ë°±)](https://keonhoban.github.io/mlops-journey/posts/triton/02/) |
| 3 | [ğŸ”— Alerting ìš´ì˜ í‘œì¤€ ë§¤ë‰´ì–¼ (Dev/Prod ì² ë²½ ë¶„ë¦¬ + Triton Serving Alerts)](https://keonhoban.github.io/mlops-journey/posts/triton/03/) |

---

## ğŸ¯ ì „ì²´ íšŒê³  ìš”ì•½

| ë‹¨ê³„ | í•µì‹¬ ëª©í‘œ | ì£¼ìš” ê°œì„ ì  |
| --- | --- | --- |
| 1 | Triton â€œì„œë¹™ í”Œë«í¼ ë¼ˆëŒ€â€ êµ¬ì¶• | GitOpsë¡œ dev/prod ë¶„ë¦¬ ë°°í¬ + explicit load 
+ NFS model-repo + /metrics ê´€ì¸¡ |
| 2 | ìë™ ë°°í¬ íŒŒì´í”„ë¼ì¸ ìš´ì˜í™” | MLflow Registry(ë‹¨ì¼ ì†ŒìŠ¤) 
â†’ materialize 
â†’ load/ready/infer ê²€ì¦ 
â†’ commit_current, ì‹¤íŒ¨ ì‹œ minimal rollback |
| 3 | ì•ŒëŒ ì‹ ë¢°ì„±/ë¶„ë¦¬ í‘œì¤€í™” | Alertmanager null default 
+ namespace ì •ê·œì‹ í—ˆìš©ë§Œ Slack ì „ì†¡ 
+ Triton mean latency ê¸°ë°˜ ì•ŒëŸ¿ ë„ì… |

> ğŸ”„ í•µì‹¬ ë¬¸ì¥:
> 
> 
> **â€œRegister â†’ Materialize â†’ Load â†’ Ready â†’ Smoke Infer â†’ Commit â†’ Observe â†’ Alert â†’ (Fail) Rollbackâ€**
> 
> ëª¨ë¸ ë°°í¬ë¥¼ **ëª…ì‹œì  ìƒíƒœ ì „ì´(load/unload)** ë¡œ ì •ì˜í•˜ê³ ,
> 
> ëª¨ë“  ì „ì´ê°€ **ê²€ì¦ ì²´ì¸ì„ í†µê³¼í•œ ê²½ìš°ì—ë§Œ commit** ë˜ë„ë¡ ê³ ì •
> 

---

## ğŸ§© Serving + Observability ì „ì²´ êµ¬ì¡°

### âœ… ìš”ì•½í•˜ë©´

- **SERVING ê³„ì¸µ**: Triton (Inference ì „ìš©)
- **CONTROL ê³„ì¸µ**: Airflow DAG (ë°°í¬â†’ê²€ì¦â†’í™•ì •/ë¡¤ë°± ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)
- **SOURCE OF TRUTH**: MLflow Registry + `current.json`(ìš´ì˜ ëª¨ë¸ ìƒíƒœ)
- **OBS ê³„ì¸µ**: Prometheus â†’ Grafana + Alertmanager â†’ Slack
- **DEV/PROD ë¶„ë¦¬ ì›ì¹™**: namespace/label/selector ê¸°ë°˜ìœ¼ë¡œ ì™„ì „ ì ˆë‹¨

---

## ğŸ” One Commit â†’ Triton Serving Loop

- **GitOps ë°°í¬ë¡œ Triton dev/prodê°€ ì•ˆì •ì ìœ¼ë¡œ ë–  ìˆê³ **
- **Airflowê°€ MLflow Registryì—ì„œ ëª¨ë¸ì„ ë‚´ë ¤ ë°›ì•„ model-repoì— ë°°ì¹˜**
- **Triton explicit loadë¡œ â€œì›í•  ë•Œë§Œâ€ ëª¨ë¸ì„ ë¡œë”©**
- **ready + smoke infer ê²€ì¦ì„ í†µê³¼í•œ ê²½ìš°ì—ë§Œ current.jsonì— ìš´ì˜ ìƒíƒœë¥¼ í™•ì •(commit)**
- **ë©”íŠ¸ë¦­ì€ Prometheus/Grafanaì—ì„œ ê´€ì¸¡ë˜ê³ **
- **ì•ŒëŒì€ Alertmanagerê°€ ìµœì¢… í†µì œ(null default)í•˜ë©° Slackì€ ë¶„ë¦¬ ì±„ë„ë¡œë§Œ ìˆ˜ì‹ **
- ì‹¤íŒ¨ ì‹œ **ìš´ì˜ ê¸°ì¤€(current.json) ë³µêµ¬ + ì‹¤íŒ¨ ë²„ì „ ê²©ë¦¬ + best-effort unload/load**ë¡œ ìµœì†Œ ë¡¤ë°±

---

## ğŸ§  ìš´ì˜ ì›ì¹™ ì •ë¦¬

### 1) í™˜ê²½ ë¶„ë¦¬

- `triton-dev / triton-prod` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë¶„ë¦¬
- model-repoëŠ” NFSì—ì„œ **dev/prod path ìì²´ë¥¼ ë¶„ë¦¬**
    - `/model-repo/dev`, `/model-repo/prod`
- PrometheusëŠ” ServiceMonitor **release ë¼ë²¨ ë§¤ì¹­**ìœ¼ë¡œë§Œ ìŠ¤í¬ë©
    - dev: `release=monitoring-dev`
    - prod: `release=monitoring-prod`

### 2) Serving ì œì–´ ì›ì¹™ (explicit ëª¨ë“œ)

- `model-control-mode=explicit`
- ìš´ì˜ì—ì„œ ëª¨ë¸ êµì²´ëŠ” ìœ„í—˜ êµ¬ê°„ì´ë¯€ë¡œ:
    - ìë™ ë¡œë”© ëŒ€ì‹  **í•„ìš” ì‹œì—ë§Œ load/unload**
    - â€œë°°í¬ ì„±ê³µâ€ì´ ì•„ë‹ˆë¼ **ê²€ì¦ í†µê³¼ í›„ì—ë§Œ ìš´ì˜ í™•ì •**

### 3) ìš´ì˜ ìƒíƒœì˜ ë‹¨ì¼ ê¸°ì¤€ (current.json)

- `current.json`ì´ ìš´ì˜ ëª¨ë¸ ìƒíƒœì˜ **Single Source of Truth**
- ì‹¤íŒ¨ ë²„ì „ì€ ì‚­ì œê°€ ì•„ë‹ˆë¼ **ê²©ë¦¬(.failed_*)**
    
    â†’ ì¬í˜„/ì›ì¸ ë¶„ì„ ê°€ëŠ¥ì„±ì„ ìš´ì˜ ìˆ˜ì¤€ì—ì„œ ë³´ì¡´
    

### 4) Observability / Alerting í‘œì¤€

- Tritonì€ `/metrics` ìì²´ ë…¸ì¶œ(í”„ë¡œë©”í…Œìš°ìŠ¤ í¬ë§·)
- AlertmanagerëŠ” **null default**ê°€ ì¶œë°œì 
- Slack ì „ì†¡ì€ **namespace ì •ê·œì‹ matchë¡œë§Œ í—ˆìš©**
    - dev/prod êµì°¨ëŠ” â€œì‹¤ìˆ˜í•´ë„â€ ìµœì¢… ë‹¨ê³„ì—ì„œ ì°¨ë‹¨

---

## âœ… ìµœì¢… ì ê²€ ì²´í¬ë¦¬ìŠ¤íŠ¸ (E2E)

- [ ]  `triton-dev`, `triton-prod` Pod Running
- [ ]  `GET /v2/health/ready` â†’ 200 OK
- [ ]  ëª¨ë¸ load ì„±ê³µ (`POST /v2/repository/models/{model}/load`)
- [ ]  smoke infer ì„±ê³µ (`POST /v2/models/{model}/infer`)
- [ ]  `/metrics`ì—ì„œ `nv_inference_*` ê³„ì—´ ì¦ê°€ í™•ì¸(ì‹¤ì œ infer í›„)
- [ ]  Prometheus Targetsì—ì„œ triton scrape up í™•ì¸(dev/prod ê°ê°)
- [ ]  Grafanaì—ì„œ RPS/Latency/Queue/CPU/Count íŒ¨ë„ ë™ì‘ í™•ì¸
- [ ]  Triton ì•ŒëŸ¿ì´ dev/prod ì±„ë„ë¡œ ì„ì´ì§€ ì•Šê³  ë¼ìš°íŒ…ë˜ëŠ”ì§€ í™•ì¸

---

## ğŸ íšŒê³ 

> ì´ë²ˆ ì‹œë¦¬ì¦ˆì˜ ê²°ë¡ ì€ â€œTritonì„ ë„ì› ë‹¤â€ê°€ ì•„ë‹ˆë¼
> 
> 
> **ì„œë¹™ ê³„ì¸µì„ GitOpsë¡œ ì¬í˜„ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ê³ , ë°°í¬ë¥¼ ìƒíƒœ ì „ì´ë¡œ í†µì œí•˜ë©°, ê´€ì¸¡Â·ì•Œë¦¼ì„ ìš´ì˜ ì •ì±…ìœ¼ë¡œ ê³ ì •**í–ˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
> 
> Tritonì€ ëª¨ë¸ì´ ì‹¤í–‰ë˜ëŠ” ìµœì „ì„ ì´ê³ , ê·¸ ìµœì „ì„ ì„
> 
> **ê²€ì¦ ì²´ì¸(load/ready/infer) + ìµœì†Œ ë¡¤ë°±(current.json ê¸°ì¤€ ë³µêµ¬) + ì•ŒëŒ ë¼ìš°íŒ…(dev/prod ì² ë²½ ë¶„ë¦¬)** ìœ¼ë¡œ ì•ˆì •í™”í–ˆìŠµë‹ˆë‹¤.
> 
> ì´ì œ GPUÂ·ëŒ€ê·œëª¨ íŠ¸ë˜í”½Â·ê²Œì´íŠ¸ì›¨ì´ ê³„ì¸µ í™•ì¥ë„
> 
> **â€œì•ˆì „í•œ ê¸°ë°˜ ìœ„ì—ì„œâ€** ì§„í–‰í•  ìˆ˜ ìˆëŠ” ìƒíƒœì…ë‹ˆë‹¤.
> 

---

## ğŸ™Œ í”„ë¡œì íŠ¸ GitHub ì €ì¥ì†Œ

- GitHub ì½”ë“œ: [[GitOps] mlops-platform-triton](https://github.com/keonhoban/mlops-infra-labs/tree/main/mlops-platform-triton)
