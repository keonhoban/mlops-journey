+++
date = '2025-06-04T12:51:32+09:00'
draft = false
title = '[Terraform] EC2 & S3 ë¦¬ì†ŒìŠ¤ ìë™í™” êµ¬ì¶• ì‹¤ìŠµ'
categories = 'Terraform'
+++

## â˜ï¸ AWS + Terraform ì‹¤ìŠµ: EC2 & S3 ì™„ì „ ìë™í™”

> **Terraform ë„ì… ë°°ê²½**
> 
> 
> ìˆ˜ë™ ì½˜ì†” ì„¤ì •ì€ ë°˜ë³µì„±ê³¼ í™•ì¥ì„±ì— í•œê³„ê°€ ìˆìŒ
> 
> Terraformì€ **ë²„ì „ ê´€ë¦¬ê°€ ê°€ëŠ¥í•œ ì½”ë“œí˜• ì¸í”„ë¼(IaC)** ë¡œ,
> 
> **í˜‘ì—… ì‹œ ë™ì¼í•œ í™˜ê²½ì„ ë¹ ë¥´ê²Œ êµ¬ì¶•**í•  ìˆ˜ ìˆëŠ” ê°•ì ì„ ê°€ì§
> 

> **ì´ë²ˆ ì‹¤ìŠµ ëª©í‘œ**
> 
> 
> IAM ì‚¬ìš©ì ìƒì„±ë¶€í„° EC2 & S3 ìë™í™”ê¹Œì§€, Terraform ê¸°ë°˜ ì¸í”„ë¼ êµ¬ì¶• ì „ì²´ íë¦„ì„ ì‹¤ìŠµ
> 

ğŸ‘‰ ì‹¤ìŠµ ë””ë ‰í† ë¦¬ ì „ì²´ ì½”ë“œ
[ğŸ”— GitHub â€“ terraform/01-ec2-s3-basic](https://github.com/keonhoban/mlops-infra-labs/tree/main/terraform/01-ec2-s3-basic)

---

## ğŸ”­ ì „ì²´ ì‹¤ìŠµ íë¦„ ìš”ì•½

```
[1ë‹¨ê³„] IAM ì‚¬ìš©ì ìƒì„± (Access Key ë°œê¸‰)
[2ë‹¨ê³„] AWS CLI ì„¤ì¹˜ ë° configure
[3ë‹¨ê³„] Terraform ì„¤ì¹˜
[4ë‹¨ê³„] ì‹¤ìŠµ ë””ë ‰í† ë¦¬ + ì½”ë“œ êµ¬ì„±
[5ë‹¨ê³„] terraform init â†’ plan â†’ apply â†’ EC2 & S3 ìƒì„±
```

---

## ğŸ§© ì‹¤ìŠµ ì¤€ë¹„ ì²´í¬ë¦¬ìŠ¤íŠ¸

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| AWS ê³„ì • | ë£¨íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ í›„, IAM ì‚¬ìš©ì ìƒì„± |
| IAM ì‚¬ìš©ì | í”„ë¡œê·¸ë˜ë° ì ‘ê·¼ + AdministratorAccess ë¶€ì—¬ |
| AWS CLI | `aws configure`ë¡œ API í‚¤ ë“±ë¡ |
| Terraform | CLI ì„¤ì¹˜ í•„ìš” (OSë³„ ë°©ë²• ìƒì´) |
| SSH í‚¤í˜ì–´ | EC2 ì ‘ì†ìš© `.pem` í‚¤ ì§ì ‘ ìƒì„± |

---

## ğŸªª 1ë‹¨ê³„: IAM ì‚¬ìš©ì ìƒì„±

1. AWS ì½˜ì†” â†’ IAM â†’ ì‚¬ìš©ì ì¶”ê°€
2. ì•¡ì„¸ìŠ¤ ìœ í˜•: **í”„ë¡œê·¸ë˜ë° ë°©ì‹ ì•¡ì„¸ìŠ¤** ì²´í¬
3. ê¶Œí•œ: `AdministratorAccess` ì •ì±… ë¶€ì—¬
    - ì‹¤ìŠµ ëª©ì ì´ë¯€ë¡œ ê´€ë¦¬ì ê¶Œí•œì¤¬ì§€ë§Œ, ì´í›„ í•„ìš”ì‹œ Least Privilege ì›ì¹™ ì ìš©
        - ex) EC2FullAccess, S3FullAccess
4. ìƒì„± í›„ `Access Key ID`, `Secret Access Key` ë³µì‚¬ (ì¤‘ìš”!)

---

## âš™ï¸ 2ë‹¨ê³„: AWS CLI ì„¤ì¹˜ ë° êµ¬ì„±

### âœ… ì„¤ì¹˜ ëª…ë ¹ì–´

[ğŸ”— AWS CLI ì„¤ì¹˜ ê³µì‹ ë¬¸ì„œ](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html)

### âœ… êµ¬ì„± ëª…ë ¹ì–´

```bash
aws configure
```

| ì…ë ¥ í•­ëª© | ì˜ˆì‹œ |
| --- | --- |
| Access Key | `AKIA...` |
| Secret Key | `wJalrXUtnF...` |
| Region | `ap-northeast-2` (ì„œìš¸) |
| Output | `json` |

---

## ğŸ§± 3ë‹¨ê³„: Terraform ì„¤ì¹˜

### ì„¤ì¹˜ ëª…ë ¹ì–´

[ğŸ”— Terraform ì„¤ì¹˜ ê³µì‹ ë¬¸ì„œ](https://developer.hashicorp.com/terraform/install#linux)

- **Ubuntu**:

```bash
sudo apt update && sudo apt install -y gnupg curl
curl -fsSL https://apt.releases.hashicorp.com/gpg | \
  sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] \
https://apt.releases.hashicorp.com $(lsb_release -cs) main" | \
sudo tee /etc/apt/sources.list.d/hashicorp.list
sudo apt update && sudo apt install terraform
```

---

## ğŸ“ 4ë‹¨ê³„: ë””ë ‰í† ë¦¬ ë° ì½”ë“œ êµ¬ì„±

### âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
terraform-aws-basic/
â”œâ”€â”€ main.tf
â”œâ”€â”€ provider.tf
â”œâ”€â”€ variables.tf
â”œâ”€â”€ terraform.tfvars
â”œâ”€â”€ outputs.tf
â””â”€â”€ README.md

```

### âœ… ì£¼ìš” íŒŒì¼ ì„¤ëª…

- **provider.tf**: AWS ë¦¬ì „ ë° í”„ë¡œí•„ ì„¤ì •
- **variables.tf**: ë³€ìˆ˜ ì •ì˜ (`instance_type`, `key_name`, `bucket_name`)
- **terraform.tfvars**: ë³€ìˆ˜ ì‹¤ì œ ê°’ ì…ë ¥
- **main.tf**: EC2, S3 ë¦¬ì†ŒìŠ¤ ì •ì˜
- **outputs.tf**: ê²°ê³¼ ì¶œë ¥ ì„¤ì •

---

## ğŸ–¥ï¸ main.tf ì˜ˆì‹œ

```hcl
resource "aws_instance" "web" {
  ami           = "ami-0e3e8ebc5f90867c0"
  instance_type = var.instance_type
  key_name      = var.key_name

  tags = {
    Name = "Keonho-Terraform-EC2"
  }
}

resource "aws_s3_bucket" "bucket" {
  bucket = var.bucket_name

  tags = {
    Environment = "Dev"
    Owner       = "Keonho"
  }
}

```

---

## ğŸ” 5ë‹¨ê³„: Terraform ì‹¤í–‰

```bash
terraform init     # ì´ˆê¸°í™”
terraform plan     # ê³„íš í™•ì¸
terraform apply    # ì¸í”„ë¼ ìƒì„±

```

**ì‹¤í–‰ ê²°ê³¼**:

- EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì™„ë£Œ (ì½˜ì†” í™•ì¸)
- S3 ë²„í‚· ìƒì„± ì™„ë£Œ

---

## ğŸ”‘ ì¶”ê°€: í‚¤í˜ì–´ ìƒì„± ë° AMI ID

### âœ… í‚¤í˜ì–´ ìƒì„± (CLI)

```bash
aws ec2 create-key-pair \
  --key-name keonho-key \
  --query 'KeyMaterial' \
  --output text > keonho-key.pem
chmod 400 keonho-key.pem

```

### âœ… AMI ID í™•ì¸ (CLI)

```bash
aws ec2 describe-images \
  --owners amazon \
  --filters "Name=name,Values=amzn2-ami-hvm-*-x86_64-gp2" \
  --query "Images[*].[ImageId,CreationDate]" \
  --output text | sort -k2 -r | head -n 1

```

---

## ğŸ§¼ ë³´ë„ˆìŠ¤: ì‚­ì œ ë° ë³´ì•ˆ ì„¤ì •

```bash
terraform destroy  # ë¦¬ì†ŒìŠ¤ ì‚­ì œ
```

### .gitignore ì„¤ì • ì˜ˆì‹œ

```bash
vi .gitignore
.terraform/
terraform.tfstate
terraform.tfstate.backup
terraform.tfvars
.terraform.lock.hcl
# keonho-key.pem  # ë‹¤ë¥¸ ê²½ë¡œ ì´ë™ ë³´ê´€ ê¶Œì¥ (ex. ~/.ssh)
```

---

## ğŸ§© ì‹¤ë¬´ íŒ

- `terraform.tfstate`ëŠ” ë¯¼ê° ì •ë³´ í¬í•¨ â†’ Git ì—…ë¡œë“œ ì ˆëŒ€ ê¸ˆì§€
- `terraform.tfstate`ëŠ” í˜‘ì—… ì‹œ remote backendë¡œ ê´€ë¦¬í•´ì•¼ í•¨ â†’ S3 + DynamoDB ì¡°í•©
- EC2 SSH í‚¤ëŠ” `.ssh/` ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•´ ì•ˆì „í•˜ê²Œ ê´€ë¦¬
- AMI ID, í‚¤í˜ì–´ëª… ë“±ì€ í•˜ë“œì½”ë”©ë³´ë‹¤ ë³€ìˆ˜í™” ê¶Œì¥

---

## ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°

- ì¸í”„ë¼ ìë™í™”ë¥¼ í†µí•´ ML ì‹¤í—˜ í™˜ê²½ì„ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„± ê°€ëŠ¥
- ì‹¤ìŠµ êµ¬ì„±ì€ Kubeflow, MLflow ë°°í¬ ê¸°ë°˜ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥
- EC2/S3 í™œìš©: ì‹¤í—˜ ì¶”ì , ëª¨ë¸ ì €ì¥, ë°ì´í„° ìŠ¤í† ë¦¬ì§€ ê¸°ì´ˆ ì¸í”„ë¼ ì—­í• 

---

## âœ… ì •ë¦¬ ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ì—­í•  |
| --- | --- |
| EC2 | ì‹¤ìŠµ ë˜ëŠ” ML ì‹¤í—˜ í™˜ê²½ìš© ì¸ìŠ¤í„´ìŠ¤ |
| S3 | ëª¨ë¸, ë¡œê·¸, ë°ì´í„° ì €ì¥ìš© ë²„í‚· |
| Terraform | ì¸í”„ë¼ ì½”ë“œí™” ë° ìë™í™” ë„êµ¬ |
| AWS CLI | í‚¤ ë“±ë¡ ë° ìë™í™” ì§€ì› |
| SSH í‚¤ | EC2 ì ‘ì†ì„ ìœ„í•œ ë³´ì•ˆ ì¸ì¦ ìˆ˜ë‹¨ |
