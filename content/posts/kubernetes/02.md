+++
date = '2025-06-05T20:06:38+09:00'
draft = false
title = '[Kubernetes ì‹¤ìŠµ - 2ë‹¨ê³„: ConfigMap & Secret]'
categories = 'Kubernetes'
+++

## ğŸ—‚ï¸ Kubernetes ì‹¤ìŠµ â‘¡ â€“ ConfigMap & Secret í™˜ê²½ ë³€ìˆ˜ ì£¼ì…

> ëª©í‘œ
> 
> 1. í™˜ê²½ ë³€ìˆ˜ì™€ ì„¤ì •ì„ ì™¸ë¶€ë¡œ ë¶„ë¦¬í•´ì„œ ê´€ë¦¬í•˜ëŠ” ë²• ìµíˆê¸°
> 2. ë¯¼ê°í•œ ì •ë³´(ë¹„ë°€ë²ˆí˜¸ ë“±)ëŠ” Secretìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì£¼ì…
> 3. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ConfigMap/Secretì„ í™˜ê²½ ë³€ìˆ˜ ë˜ëŠ” íŒŒì¼ë¡œ ì½ëŠ” êµ¬ì¡° í•™ìŠµ

ğŸ‘‰ ì‹¤ìŠµ ì½”ë“œëŠ” [ğŸ”— GitHub (Configmap_and_Secret)](https://github.com/keonhoban/mlops-infra-labs/tree/main/k8s-basic/02_Configmap_and_Secret)

---

## ğŸ§­ ì „ì²´ íë¦„ ìš”ì•½

```
â‘  ConfigMap ìƒì„± (ì¼ë°˜ ì„¤ì •ê°’)
â‘¡ Secret ìƒì„± (ë¯¼ê° ì •ë³´ â€“ base64 ì¸ì½”ë”©)
â‘¢ Podì— í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…
â‘£ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ê°’ í™•ì¸ (env ëª…ë ¹ì–´)
â‘¤ ì‹¤ì „ ì ìš© ë° ë³´ì•ˆ ì£¼ì˜ì‚¬í•­ í•™ìŠµ
```

---

## ğŸ“‚ ì‹¤ìŠµì— ì‚¬ìš©ëœ íŒŒì¼ êµ¬ì„±

```
k8s-configmap-secret/
â”œâ”€â”€ configmap.yaml     # ì¼ë°˜ ì„¤ì •ê°’ ì •ì˜
â”œâ”€â”€ secret.yaml        # ë¯¼ê° ì •ë³´ (base64 ì¸ì½”ë”©)
â”œâ”€â”€ pod-env.yaml       # Pod í™˜ê²½ ë³€ìˆ˜ë¡œ ì£¼ì…
â””â”€â”€ README.md
```

---

## ğŸ“„ ì£¼ìš” YAML íŒŒì¼ ì •ë¦¬

### ğŸ”¹ `configmap.yaml`

```yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  APP_MODE: "production"
  APP_PORT: "8080"
```

---

### ğŸ”¹ `secret.yaml`

```yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
type: Opaque
data:
  DB_PASSWORD: c3VwZXJzZWNyZXQ=   # base64 â†’ "supersecret"
```

> âœ… ì¸ì½”ë”© ë°©ë²•: echo -n "supersecret" | base64
> 

---

### ğŸ”¹ `pod-env.yaml`

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: env-demo
spec:
  containers:
  - name: demo-container
    image: busybox
    command: [ "sh", "-c", "env; sleep 3600" ]
    env:
    - name: APP_MODE
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: APP_MODE
    - name: APP_PORT
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: APP_PORT
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: app-secret
          key: DB_PASSWORD
```

---

## ğŸ§ª ì‹¤ìŠµ ì‹¤í–‰ ëª…ë ¹ì–´

```bash
kubectl apply -f configmap.yaml
kubectl apply -f secret.yaml
kubectl apply -f pod-env.yaml

kubectl get pods
kubectl describe pod env-demo
kubectl exec -it env-demo -- sh
```

```bash
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ í™•ì¸
env

# ì¶œë ¥ ì˜ˆì‹œ (ì¤‘ê°„ ìƒëµ)
APP_MODE=production
APP_PORT=8080
DB_PASSWORD=supersecret
```

---

## ğŸ¯ ì •ë¦¬ ìš”ì•½

| êµ¬ë¶„ | ì„¤ëª… |
| --- | --- |
| ConfigMap | ë¹„ë¯¼ê° ì„¤ì •ê°’ ì €ì¥ (APP_MODE, APP_PORT ë“±) |
| Secret | ë¯¼ê°í•œ ë°ì´í„° ì €ì¥ (ë¹„ë°€ë²ˆí˜¸, API í‚¤ ë“±) â€“ base64 ì¸ì½”ë”© |
| ì£¼ì… ë°©ì‹ | `env`ë¥¼ í†µí•´ ì»¨í…Œì´ë„ˆì— ì£¼ì… |
| ë³´ì•ˆ ì£¼ì˜ | Secretì€ ì¸ì½”ë”©ì¼ ë¿, RBAC ë° ì ‘ê·¼ ì œì–´ í•„ìˆ˜ |

---

## ğŸ§© ì‹¤ë¬´ íŒ

- `.env` íŒŒì¼ ëŒ€ì‹  ì‚¬ìš© â†’ Git ì»¤ë°‹ ë°©ì§€ ë° ë¶„ë¦¬ëœ ì„¤ì • ê´€ë¦¬
- Secretì€ `Opaque` íƒ€ì… ì™¸ì—ë„ `kubernetes.io/dockerconfigjson` ë“± ë‹¤ì–‘
- ë¯¼ê° ì •ë³´ëŠ” Pod ë‚´ì— ì €ì¥ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜ (ê¶Œí•œ + ë¡¤ ë¶„ë¦¬ ì¤‘ìš”)
- Pod ì¬ì‹œì‘ ì—†ì´ ConfigMapì„ ë°˜ì˜í•˜ë ¤ë©´ Deployment + Volume ë°©ì‹ ì‚¬ìš© ê³ ë ¤

---

## ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°

| ì‹¤ë¬´ ìƒí™© | Kubernetes ì‚¬ìš© ë°©ì‹ |
| --- | --- |
| ì„œë¹„ìŠ¤ ëª¨ë“œ ì „í™˜(dev/prod) | ConfigMapì— ì„¤ì •ê°’ ì£¼ì… |
| DB ë¹„ë°€ë²ˆí˜¸, API í‚¤ | Secretìœ¼ë¡œ í™˜ê²½ ë³€ìˆ˜ ì£¼ì… |
| ì‹¤í—˜ í™˜ê²½ ìë™í™” | ì‹¤í—˜ë³„ êµ¬ì„±(ConfigMap) + ë¯¼ê°í‚¤(Secret) ì¡°í•© |
| CI/CD í™˜ê²½ êµ¬ì„± | GitOps ë°©ì‹ìœ¼ë¡œ ConfigMap/Secret ê´€ë¦¬ (ArgoCD, Flux ë“±) |
