<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content="Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„
í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©í–ˆìŠµë‹ˆë‹¤.â€
â€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€
ì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ,
ê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€

ğŸ¯ í•µì‹¬ ìš”ì•½

FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ send_slack_alert(text)ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•©
AirflowëŠ” ì „ì—­ ì‹¤íŒ¨ ì½œë°± alert_slack(context)ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´
Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(SLACK_WEBHOOK_URL)ë¡œ ì£¼ì…
dev(.local) / prod(.prod) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘


1ï¸âƒ£ êµ¬ì¡° ê°œìš”

  
      
          êµ¬ì„± ìš”ì†Œ
          ì—­í• 
      
  
  
      
          ê³µìš© í•¨ìˆ˜
          send_slack_alert(text) â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ
      
      
          Airflow ì „ì—­ ì½œë°±
          alert_slack(context) â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ
      
      
          í™˜ê²½ ì£¼ì… ë°©ì‹
          slack-webhook-{env}-secret â†’ SLACK_WEBHOOK_URL
      
      
          ë¶„ë¦¬ ì›ì¹™
          dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸)
      
  


2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„
"><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/03/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/03/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/03/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]"><meta property="og:description" content="Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„
í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©í–ˆìŠµë‹ˆë‹¤.â€
â€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€
ì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ,
ê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€
ğŸ¯ í•µì‹¬ ìš”ì•½ FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ send_slack_alert(text)ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•© AirflowëŠ” ì „ì—­ ì‹¤íŒ¨ ì½œë°± alert_slack(context)ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´ Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(SLACK_WEBHOOK_URL)ë¡œ ì£¼ì… dev(.local) / prod(.prod) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘ 1ï¸âƒ£ êµ¬ì¡° ê°œìš” êµ¬ì„± ìš”ì†Œ ì—­í•  ê³µìš© í•¨ìˆ˜ send_slack_alert(text) â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ Airflow ì „ì—­ ì½œë°± alert_slack(context) â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ í™˜ê²½ ì£¼ì… ë°©ì‹ slack-webhook-{env}-secret â†’ SLACK_WEBHOOK_URL ë¶„ë¦¬ ì›ì¹™ dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸) 2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„ "><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-26T17:10:21+09:00"><meta property="article:modified_time" content="2025-07-26T17:10:21+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]"><meta name=twitter:description content="Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„
í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©í–ˆìŠµë‹ˆë‹¤.â€
â€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€
ì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ,
ê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€

ğŸ¯ í•µì‹¬ ìš”ì•½

FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ send_slack_alert(text)ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•©
AirflowëŠ” ì „ì—­ ì‹¤íŒ¨ ì½œë°± alert_slack(context)ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´
Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(SLACK_WEBHOOK_URL)ë¡œ ì£¼ì…
dev(.local) / prod(.prod) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘


1ï¸âƒ£ êµ¬ì¡° ê°œìš”

  
      
          êµ¬ì„± ìš”ì†Œ
          ì—­í• 
      
  
  
      
          ê³µìš© í•¨ìˆ˜
          send_slack_alert(text) â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ
      
      
          Airflow ì „ì—­ ì½œë°±
          alert_slack(context) â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ
      
      
          í™˜ê²½ ì£¼ì… ë°©ì‹
          slack-webhook-{env}-secret â†’ SLACK_WEBHOOK_URL
      
      
          ë¶„ë¦¬ ì›ì¹™
          dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸)
      
  


2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://keonhoban.github.io/mlops-journey/posts/"},{"@type":"ListItem","position":2,"name":"[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]","item":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/03/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]","name":"[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]","description":"Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„\ní•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©í–ˆìŠµë‹ˆë‹¤.â€\nâ€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€\nì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ,\nê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€\nğŸ¯ í•µì‹¬ ìš”ì•½ FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ send_slack_alert(text)ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•© AirflowëŠ” ì „ì—­ ì‹¤íŒ¨ ì½œë°± alert_slack(context)ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´ Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(SLACK_WEBHOOK_URL)ë¡œ ì£¼ì… dev(.local) / prod(.prod) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘ 1ï¸âƒ£ êµ¬ì¡° ê°œìš” êµ¬ì„± ìš”ì†Œ ì—­í•  ê³µìš© í•¨ìˆ˜ send_slack_alert(text) â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ Airflow ì „ì—­ ì½œë°± alert_slack(context) â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ í™˜ê²½ ì£¼ì… ë°©ì‹ slack-webhook-{env}-secret â†’ SLACK_WEBHOOK_URL ë¶„ë¦¬ ì›ì¹™ dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸) 2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„ ","keywords":[],"articleBody":"Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„\ní•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©í–ˆìŠµë‹ˆë‹¤.â€\nâ€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€\nì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ,\nê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€\nğŸ¯ í•µì‹¬ ìš”ì•½ FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ send_slack_alert(text)ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•© AirflowëŠ” ì „ì—­ ì‹¤íŒ¨ ì½œë°± alert_slack(context)ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´ Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(SLACK_WEBHOOK_URL)ë¡œ ì£¼ì… dev(.local) / prod(.prod) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘ 1ï¸âƒ£ êµ¬ì¡° ê°œìš” êµ¬ì„± ìš”ì†Œ ì—­í•  ê³µìš© í•¨ìˆ˜ send_slack_alert(text) â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ Airflow ì „ì—­ ì½œë°± alert_slack(context) â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ í™˜ê²½ ì£¼ì… ë°©ì‹ slack-webhook-{env}-secret â†’ SLACK_WEBHOOK_URL ë¶„ë¦¬ ì›ì¹™ dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸) 2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„ 3ï¸âƒ£ FastAPI ì•Œë¦¼ ëª¨ë“ˆ # charts/fastapi/app/utils/slack_alerts.py import requests import os def send_slack_alert(text: str): slack_url = os.environ.get(\"SLACK_WEBHOOK_URL\") if not slack_url: print(\"[Slack Alert] SKIP: SLACK_WEBHOOK_URL not set\") return try: res = requests.post(slack_url, json={\"text\": text}, timeout=5) res.raise_for_status() except Exception as e: print(f\"[Slack Alert Error] {e}\") ì‚¬ìš© ì˜ˆì‹œ:\nFastAPI ì„œë²„ ì‹œì‘/í—¬ìŠ¤ ì²´í¬ /variant/{alias}/reload í•«ìŠ¤ì™‘ ì„±ê³µÂ·ì‹¤íŒ¨ ì˜ˆì¸¡ ì²˜ë¦¬ ì¤‘ ì˜ˆì™¸ ë°œìƒ ì‹œ 4ï¸âƒ£ Airflow ì•Œë¦¼ ëª¨ë“ˆ # dags/utils/slack_alerts.py import os import requests def send_slack_alert(text: str) -\u003e None: slack_url = os.environ.get(\"SLACK_WEBHOOK_URL\") if not slack_url: print(\"[Slack Alert] SKIP: SLACK_WEBHOOK_URL not set\") return try: res = requests.post(slack_url, json={\"text\": text}, timeout=5) res.raise_for_status() except Exception as e: print(f\"[Slack Alert Error] {e}\") def alert_slack(context) -\u003e None: dag = context.get(\"dag\") ti = context.get(\"task_instance\") dag_id = getattr(dag, \"dag_id\", \"unknown\") task_id = getattr(ti, \"task_id\", \"unknown\") execution_ts = context.get(\"ts\") run_id = context.get(\"run_id\") base_url = os.environ.get(\"AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL\", \"\").rstrip(\"/\") log_url = f\"{base_url}/dags/{dag_id}/runs/{run_id}/tasks/{task_id}\" if base_url else \"(base_url unset)\" text = ( \"*ğŸ”¥ Airflow DAG ì‹¤íŒ¨ ì•Œë¦¼!*\\n\" f\"*DAG*: `{dag_id}`\\n\" f\"*Task*: `{task_id}`\\n\" f\"*Time*: `{execution_ts}`\\n\" f\"*Log*: \u003c{log_url}|ë¡œê·¸ ë°”ë¡œê°€ê¸°\u003e\" ) send_slack_alert(text) ëª¨ë“  DAGì— on_failure_callback=alert_slack ì ìš©\nâ†’ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ ë§í¬ í¬í•¨ ë©”ì‹œì§€ ìë™ ì „ì†¡\n5ï¸âƒ£ Helm Values (dev/prod) â–¶ FastAPI(dev) # charts/fastapi/values/dev.yaml env: MLFLOW_TRACKING_URI: \"http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000\" MODEL_NAME: \"best_model\" DEFAULT_ALIAS: \"B\" ALIAS_SELECTION_MODE: \"blue_green\" CANARY_PERCENT: \"20\" LOG_TO_STDOUT: \"true\" LOG_LEVEL: \"info\" envFrom: - secretRef: { name: aws-credentials-secret } - secretRef: { name: fastapi-token-dev-secret } - secretRef: { name: slack-webhook-dev-secret } â–¶ FastAPI(prod) # charts/fastapi/values/prod.yaml env: MLFLOW_TRACKING_URI: \"http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000\" MODEL_NAME: \"best_model\" DEFAULT_ALIAS: \"B\" ALIAS_SELECTION_MODE: \"blue_green\" CANARY_PERCENT: \"10\" LOG_TO_STDOUT: \"true\" LOG_LEVEL: \"info\" envFrom: - secretRef: { name: aws-credentials-secret } - secretRef: { name: fastapi-token-prod-secret } - secretRef: { name: slack-webhook-prod-secret } â–¶ Airflow(dev) # charts/airflow/values/dev.yaml airflow: config: AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL: value: \"http://airflow.local\" scheduler: \u0026dev_scheduler env: - name: SLACK_WEBHOOK_URL valueFrom: secretKeyRef: name: slack-webhook-dev-secret key: SLACK_WEBHOOK_URL - name: FASTAPI_RELOAD_URL value: \"http://fastapi-dev-service.fastapi-dev.svc.cluster.local\" - name: MLFLOW_TRACKING_URI value: \"http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000\" workers: *dev_scheduler dagProcessor: *dev_scheduler â–¶ Airflow(prod) # charts/airflow/values/prod.yaml airflow: config: AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL: value: \"http://airflow.prod\" scheduler: \u0026prod_scheduler env: - name: SLACK_WEBHOOK_URL valueFrom: secretKeyRef: name: slack-webhook-prod-secret key: SLACK_WEBHOOK_URL - name: FASTAPI_RELOAD_URL value: \"http://fastapi-prod-service.fastapi-prod.svc.cluster.local\" - name: MLFLOW_TRACKING_URI value: \"http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000\" workers: *prod_scheduler dagProcessor: *prod_scheduler 6ï¸âƒ£ SealedSecret ì˜ˆì‹œ # envs/dev/sealed-secrets/airflow/sealed-slack-webhook-dev-secret.yaml apiVersion: bitnami.com/v1alpha1 kind: SealedSecret metadata: name: slack-webhook-dev-secret namespace: airflow-dev spec: encryptedData: SLACK_WEBHOOK_URL: template: type: Opaque 7ï¸âƒ£ Slack ë©”ì‹œì§€ ì˜ˆì‹œ ìƒí™© ì˜ˆì‹œ ë©”ì‹œì§€ FastAPI í•«ìŠ¤ì™‘ ì„±ê³µ ğŸ” [FastAPI] ëª¨ë¸ @A í•«ìŠ¤ì™‘ ì™„ë£Œ v9 (run_id=â€¦) FastAPI í—¬ìŠ¤ ì²´í¬ ê²½ê³  âš ï¸ [FastAPI] degraded (loaded=[â€˜Aâ€™], missing=[â€˜Bâ€™]) Airflow ë“±ë¡ ì„±ê³µ âœ… [Airflow] ëª¨ë¸ ë“±ë¡: my_model v12 â†’ @A Airflow ì„¼ì„œ ì‹¤íŒ¨ âŒ [Airflow] READY ê°ì§€ ì‹¤íŒ¨: my_model v12 DAG ì „ì—­ ì‹¤íŒ¨ ğŸ”¥ Airflow DAG ì‹¤íŒ¨ ì•Œë¦¼ (Task=check_model_ready) 8ï¸âƒ£ ì²´í¬ë¦¬ìŠ¤íŠ¸ SLACK_WEBHOOK_URL dev/prod ê°ê° ì£¼ì… í™•ì¸ Airflow DAGì— on_failure_callback=alert_slack ì„¤ì • ìœ ì§€ FastAPI ì£¼ìš” ì´ë²¤íŠ¸(í•«ìŠ¤ì™‘Â·í—¬ìŠ¤Â·ê¸°ë™)ì— send_slack_alert() í˜¸ì¶œ Airflow ê° ë‹¨ê³„(Task)ì—ì„œë„ send_slack_alert() í˜¸ì¶œ Secret ì´ë¦„(slack-webhook-{env}-secret)ì´ Helm envFromê³¼ ì¼ì¹˜ ğŸ§© íŒ Slack ì „ì†¡ ì‹¤íŒ¨ ì‹œ ì„œë¹„ìŠ¤ ë¡œì§ ì°¨ë‹¨ ê¸ˆì§€ â€” ë„¤íŠ¸ì›Œí¬ ì¥ì• ê°€ ëª¨ë¸ ì„œë¹™ì„ ë§‰ì§€ ì•Šê²Œ ë°°í¬ ì „ Webhook Secret ë¶ˆì¼ì¹˜ ì—¬ë¶€ë¥¼ devì—ì„œ ë°˜ë“œì‹œ ì ê²€ ğŸ ì •ë¦¬ ì´ì œ FastAPIì™€ Airflowê°€ í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.\në‹¨ì¼ í•¨ìˆ˜(send_slack_alert)ë§Œìœ¼ë¡œ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘ ì „ êµ¬ê°„ì˜ ê´€ì œ ì•Œë¦¼ì„ ì—°ê²°í•  ìˆ˜ ìˆìœ¼ë©°,\ní™˜ê²½ ë¶„ë¦¬ë¥¼ ìœ ì§€í•˜ë©´ì„œë„ ì‹¤ì‹œê°„ ìš´ì˜ ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.\n","wordCount":"606","inLanguage":"en","datePublished":"2025-07-26T17:10:21+09:00","dateModified":"2025-07-26T17:10:21+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/03/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[MLOps ìš´ì˜ ê³ ë„í™” - 2ë‹¨ê³„: Slack Alert í†µí•© (FastAPIÂ·Airflow ê³µìš©)]</h1><div class=post-meta><span title='2025-07-26 17:10:21 +0900 +0900'>July 26, 2025</span>&nbsp;Â·&nbsp;3 min</div></header><div class=post-content><h2 id=slack-alert-í†µí•©-fastapiairflow-ê³µìš©-êµ¬ì¡°--í…œí”Œë¦¿-í™•ì¥-ê¸°ë°˜>Slack Alert í†µí•©: FastAPIÂ·Airflow ê³µìš© êµ¬ì¡° + í…œí”Œë¦¿ í™•ì¥ ê¸°ë°˜<a hidden class=anchor aria-hidden=true href=#slack-alert-í†µí•©-fastapiairflow-ê³µìš©-êµ¬ì¡°--í…œí”Œë¦¿-í™•ì¥-ê¸°ë°˜>#</a></h2><hr><h2 id=-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…<a hidden class=anchor aria-hidden=true href=#-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>#</a></h2><blockquote><p>â€œìš´ì˜ í™˜ê²½ì—ì„œ ê°€ì¥ ë¬´ì„œìš´ ê±´ <strong>ë¬¸ì œê°€ ìƒê²¼ëŠ”ë° ì•„ë¬´ë„ ëª¨ë¥´ê³  ìˆëŠ” ìƒí™©</strong>ì…ë‹ˆë‹¤.â€</p><p>â€œê·¸ë˜ì„œ 2ë‹¨ê³„ì—ì„œëŠ” FastAPIì™€ Airflowê°€ ê°ì í©ì–´ì ¸ ë³´ë‚´ë˜ ì•Œë¦¼ì„</p><p><strong>í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ ì™„ì „íˆ í†µí•©</strong>í–ˆìŠµë‹ˆë‹¤.â€</p><p>â€œëª¨ë¸ í•™ìŠµÂ·ë“±ë¡Â·ì„¼ì„œÂ·í•«ìŠ¤ì™‘Â·í—¬ìŠ¤ì²´í¬ê¹Œì§€</p><p>ì–´ë””ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ë„ <strong>ì¦‰ì‹œ ëˆˆì— ë“¤ì–´ì˜¤ë„ë¡ ë§Œë“œëŠ” ê²ƒ</strong>,</p><p>ê·¸ê²Œ ì´ ë‹¨ê³„ì˜ í•µì‹¬ ëª©ì ì´ì—ˆìŠµë‹ˆë‹¤.â€</p></blockquote><hr><h2 id=-í•µì‹¬-ìš”ì•½>ğŸ¯ í•µì‹¬ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#-í•µì‹¬-ìš”ì•½>#</a></h2><ul><li>FastAPIì™€ Airflowê°€ ê³µí†µ í•¨ìˆ˜ <code>send_slack_alert(text)</code>ë¥¼ ì‚¬ìš©í•´ ì•Œë¦¼ ì²´ê³„ë¥¼ í†µí•©</li><li>AirflowëŠ” <strong>ì „ì—­ ì‹¤íŒ¨ ì½œë°±</strong> <code>alert_slack(context)</code>ë¡œ DAG/Task ì‹¤íŒ¨ ìë™ í†µë³´</li><li>Webhook URLì€ SealedSecret â†’ í™˜ê²½ë³€ìˆ˜(<code>SLACK_WEBHOOK_URL</code>)ë¡œ ì£¼ì…</li><li>dev(<code>.local</code>) / prod(<code>.prod</code>) í™˜ê²½ ì™„ì „ ë¶„ë¦¬: ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸ ê°ê° ëŒ€ì‘</li></ul><hr><h2 id=1-êµ¬ì¡°-ê°œìš”>1ï¸âƒ£ êµ¬ì¡° ê°œìš”<a hidden class=anchor aria-hidden=true href=#1-êµ¬ì¡°-ê°œìš”>#</a></h2><table><thead><tr><th>êµ¬ì„± ìš”ì†Œ</th><th>ì—­í• </th></tr></thead><tbody><tr><td><strong>ê³µìš© í•¨ìˆ˜</strong></td><td><code>send_slack_alert(text)</code> â€” FastAPIÂ·Airflow ëª¨ë‘ì—ì„œ í˜¸ì¶œ</td></tr><tr><td><strong>Airflow ì „ì—­ ì½œë°±</strong></td><td><code>alert_slack(context)</code> â€” DAG ì‹¤íŒ¨ ì‹œ ìë™ í˜¸ì¶œ</td></tr><tr><td><strong>í™˜ê²½ ì£¼ì… ë°©ì‹</strong></td><td><code>slack-webhook-{env}-secret</code> â†’ <code>SLACK_WEBHOOK_URL</code></td></tr><tr><td><strong>ë¶„ë¦¬ ì›ì¹™</strong></td><td>dev/prod ì™„ì „ ë¶„ë¦¬ (ë„¤ì„ìŠ¤í˜ì´ìŠ¤Â·ì‹œí¬ë¦¿Â·ë„ë©”ì¸)</td></tr></tbody></table><hr><h2 id=2-ì‹œìŠ¤í…œ-íë¦„ë„>2ï¸âƒ£ ì‹œìŠ¤í…œ íë¦„ë„<a hidden class=anchor aria-hidden=true href=#2-ì‹œìŠ¤í…œ-íë¦„ë„>#</a></h2><p><img alt=mermaid-02.png loading=lazy src=/mlops-journey/images/mermaid-02.png></p><hr><h2 id=3-fastapi-ì•Œë¦¼-ëª¨ë“ˆ>3ï¸âƒ£ FastAPI ì•Œë¦¼ ëª¨ë“ˆ<a hidden class=anchor aria-hidden=true href=#3-fastapi-ì•Œë¦¼-ëª¨ë“ˆ>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># charts/fastapi/app/utils/slack_alerts.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_slack_alert</span>(text: str):
</span></span><span style=display:flex><span>    slack_url <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;SLACK_WEBHOOK_URL&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> slack_url:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;[Slack Alert] SKIP: SLACK_WEBHOOK_URL not set&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(slack_url, json<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;text&#34;</span>: text}, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>        res<span style=color:#f92672>.</span>raise_for_status()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[Slack Alert Error] </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><blockquote><p>ì‚¬ìš© ì˜ˆì‹œ:</p><ul><li>FastAPI ì„œë²„ ì‹œì‘/í—¬ìŠ¤ ì²´í¬</li><li><code>/variant/{alias}/reload</code> í•«ìŠ¤ì™‘ ì„±ê³µÂ·ì‹¤íŒ¨</li><li>ì˜ˆì¸¡ ì²˜ë¦¬ ì¤‘ ì˜ˆì™¸ ë°œìƒ ì‹œ</li></ul></blockquote><hr><h2 id=4-airflow-ì•Œë¦¼-ëª¨ë“ˆ>4ï¸âƒ£ Airflow ì•Œë¦¼ ëª¨ë“ˆ<a hidden class=anchor aria-hidden=true href=#4-airflow-ì•Œë¦¼-ëª¨ë“ˆ>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># dags/utils/slack_alerts.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>send_slack_alert</span>(text: str) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    slack_url <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;SLACK_WEBHOOK_URL&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> slack_url:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;[Slack Alert] SKIP: SLACK_WEBHOOK_URL not set&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        res <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(slack_url, json<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;text&#34;</span>: text}, timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>        res<span style=color:#f92672>.</span>raise_for_status()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[Slack Alert Error] </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>alert_slack</span>(context) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>    dag <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;dag&#34;</span>)
</span></span><span style=display:flex><span>    ti <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;task_instance&#34;</span>)
</span></span><span style=display:flex><span>    dag_id <span style=color:#f92672>=</span> getattr(dag, <span style=color:#e6db74>&#34;dag_id&#34;</span>, <span style=color:#e6db74>&#34;unknown&#34;</span>)
</span></span><span style=display:flex><span>    task_id <span style=color:#f92672>=</span> getattr(ti, <span style=color:#e6db74>&#34;task_id&#34;</span>, <span style=color:#e6db74>&#34;unknown&#34;</span>)
</span></span><span style=display:flex><span>    execution_ts <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;ts&#34;</span>)
</span></span><span style=display:flex><span>    run_id <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;run_id&#34;</span>)
</span></span><span style=display:flex><span>    base_url <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>environ<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>)<span style=color:#f92672>.</span>rstrip(<span style=color:#e6db74>&#34;/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    log_url <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>base_url<span style=color:#e6db74>}</span><span style=color:#e6db74>/dags/</span><span style=color:#e6db74>{</span>dag_id<span style=color:#e6db74>}</span><span style=color:#e6db74>/runs/</span><span style=color:#e6db74>{</span>run_id<span style=color:#e6db74>}</span><span style=color:#e6db74>/tasks/</span><span style=color:#e6db74>{</span>task_id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#66d9ef>if</span> base_url <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;(base_url unset)&#34;</span>
</span></span><span style=display:flex><span>    text <span style=color:#f92672>=</span> (
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;*ğŸ”¥ Airflow DAG ì‹¤íŒ¨ ì•Œë¦¼!*</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;*DAG*: `</span><span style=color:#e6db74>{</span>dag_id<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;*Task*: `</span><span style=color:#e6db74>{</span>task_id<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;*Time*: `</span><span style=color:#e6db74>{</span>execution_ts<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;*Log*: &lt;</span><span style=color:#e6db74>{</span>log_url<span style=color:#e6db74>}</span><span style=color:#e6db74>|ë¡œê·¸ ë°”ë¡œê°€ê¸°&gt;&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    send_slack_alert(text)
</span></span></code></pre></div><blockquote><p>ëª¨ë“  DAGì— on_failure_callback=alert_slack ì ìš©</p><p>â†’ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ ë§í¬ í¬í•¨ ë©”ì‹œì§€ ìë™ ì „ì†¡</p></blockquote><hr><h2 id=5-helm-values-devprod>5ï¸âƒ£ Helm Values (dev/prod)<a hidden class=anchor aria-hidden=true href=#5-helm-values-devprod>#</a></h2><h3 id=-fastapidev>â–¶ FastAPI(dev)<a hidden class=anchor aria-hidden=true href=#-fastapidev>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># charts/fastapi/values/dev.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>MLFLOW_TRACKING_URI</span>: <span style=color:#e6db74>&#34;http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>MODEL_NAME</span>: <span style=color:#e6db74>&#34;best_model&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>DEFAULT_ALIAS</span>: <span style=color:#e6db74>&#34;B&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ALIAS_SELECTION_MODE</span>: <span style=color:#e6db74>&#34;blue_green&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>CANARY_PERCENT</span>: <span style=color:#e6db74>&#34;20&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>LOG_TO_STDOUT</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>LOG_LEVEL</span>: <span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>envFrom</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws-credentials-secret }</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fastapi-token-dev-secret }</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>slack-webhook-dev-secret }</span>
</span></span></code></pre></div><h3 id=-fastapiprod>â–¶ FastAPI(prod)<a hidden class=anchor aria-hidden=true href=#-fastapiprod>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># charts/fastapi/values/prod.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>MLFLOW_TRACKING_URI</span>: <span style=color:#e6db74>&#34;http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>MODEL_NAME</span>: <span style=color:#e6db74>&#34;best_model&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>DEFAULT_ALIAS</span>: <span style=color:#e6db74>&#34;B&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ALIAS_SELECTION_MODE</span>: <span style=color:#e6db74>&#34;blue_green&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>CANARY_PERCENT</span>: <span style=color:#e6db74>&#34;10&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>LOG_TO_STDOUT</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>LOG_LEVEL</span>: <span style=color:#e6db74>&#34;info&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>envFrom</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws-credentials-secret }</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>fastapi-token-prod-secret }</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>: { <span style=color:#f92672>name</span>: <span style=color:#ae81ff>slack-webhook-prod-secret }</span>
</span></span></code></pre></div><h3 id=-airflowdev>â–¶ Airflow(dev)<a hidden class=anchor aria-hidden=true href=#-airflowdev>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># charts/airflow/values/dev.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>airflow</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://airflow.local&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>scheduler</span>: <span style=color:#75715e>&amp;dev_scheduler</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SLACK_WEBHOOK_URL</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>slack-webhook-dev-secret</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>key</span>: <span style=color:#ae81ff>SLACK_WEBHOOK_URL</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>FASTAPI_RELOAD_URL</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://fastapi-dev-service.fastapi-dev.svc.cluster.local&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>MLFLOW_TRACKING_URI</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>workers</span>: <span style=color:#75715e>*dev_scheduler</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dagProcessor</span>: <span style=color:#75715e>*dev_scheduler</span>
</span></span></code></pre></div><h3 id=-airflowprod>â–¶ Airflow(prod)<a hidden class=anchor aria-hidden=true href=#-airflowprod>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># charts/airflow/values/prod.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>airflow</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>AIRFLOW__WEBSERVER__WEB_SERVER_BASE_URL</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://airflow.prod&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>scheduler</span>: <span style=color:#75715e>&amp;prod_scheduler</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SLACK_WEBHOOK_URL</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>slack-webhook-prod-secret</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>key</span>: <span style=color:#ae81ff>SLACK_WEBHOOK_URL</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>FASTAPI_RELOAD_URL</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://fastapi-prod-service.fastapi-prod.svc.cluster.local&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>MLFLOW_TRACKING_URI</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>workers</span>: <span style=color:#75715e>*prod_scheduler</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dagProcessor</span>: <span style=color:#75715e>*prod_scheduler</span>
</span></span></code></pre></div><hr><h2 id=6-sealedsecret-ì˜ˆì‹œ>6ï¸âƒ£ SealedSecret ì˜ˆì‹œ<a hidden class=anchor aria-hidden=true href=#6-sealedsecret-ì˜ˆì‹œ>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># envs/dev/sealed-secrets/airflow/sealed-slack-webhook-dev-secret.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>bitnami.com/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>SealedSecret</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>slack-webhook-dev-secret</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>airflow-dev</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>encryptedData</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>SLACK_WEBHOOK_URL</span>: <span style=color:#ae81ff>&lt;sealed payload&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>Opaque</span>
</span></span></code></pre></div><hr><h2 id=7-slack-ë©”ì‹œì§€-ì˜ˆì‹œ>7ï¸âƒ£ Slack ë©”ì‹œì§€ ì˜ˆì‹œ<a hidden class=anchor aria-hidden=true href=#7-slack-ë©”ì‹œì§€-ì˜ˆì‹œ>#</a></h2><table><thead><tr><th>ìƒí™©</th><th>ì˜ˆì‹œ ë©”ì‹œì§€</th></tr></thead><tbody><tr><td>FastAPI í•«ìŠ¤ì™‘ ì„±ê³µ</td><td>ğŸ” [FastAPI] ëª¨ë¸ @A í•«ìŠ¤ì™‘ ì™„ë£Œ v9 (run_id=&mldr;)</td></tr><tr><td>FastAPI í—¬ìŠ¤ ì²´í¬ ê²½ê³ </td><td>âš ï¸ [FastAPI] degraded (loaded=[&lsquo;A&rsquo;], missing=[&lsquo;B&rsquo;])</td></tr><tr><td>Airflow ë“±ë¡ ì„±ê³µ</td><td>âœ… [Airflow] ëª¨ë¸ ë“±ë¡: my_model v12 â†’ @A</td></tr><tr><td>Airflow ì„¼ì„œ ì‹¤íŒ¨</td><td>âŒ [Airflow] READY ê°ì§€ ì‹¤íŒ¨: my_model v12</td></tr><tr><td>DAG ì „ì—­ ì‹¤íŒ¨</td><td>ğŸ”¥ Airflow DAG ì‹¤íŒ¨ ì•Œë¦¼ (Task=check_model_ready)</td></tr></tbody></table><hr><h2 id=8-ì²´í¬ë¦¬ìŠ¤íŠ¸>8ï¸âƒ£ ì²´í¬ë¦¬ìŠ¤íŠ¸<a hidden class=anchor aria-hidden=true href=#8-ì²´í¬ë¦¬ìŠ¤íŠ¸>#</a></h2><ul><li><input disabled type=checkbox> <code>SLACK_WEBHOOK_URL</code> dev/prod ê°ê° ì£¼ì… í™•ì¸</li><li><input disabled type=checkbox> Airflow DAGì— <code>on_failure_callback=alert_slack</code> ì„¤ì • ìœ ì§€</li><li><input disabled type=checkbox> FastAPI ì£¼ìš” ì´ë²¤íŠ¸(í•«ìŠ¤ì™‘Â·í—¬ìŠ¤Â·ê¸°ë™)ì— <code>send_slack_alert()</code> í˜¸ì¶œ</li><li><input disabled type=checkbox> Airflow ê° ë‹¨ê³„(Task)ì—ì„œë„ <code>send_slack_alert()</code> í˜¸ì¶œ</li><li><input disabled type=checkbox> Secret ì´ë¦„(<code>slack-webhook-{env}-secret</code>)ì´ Helm envFromê³¼ ì¼ì¹˜</li></ul><hr><h2 id=-íŒ>ğŸ§© íŒ<a hidden class=anchor aria-hidden=true href=#-íŒ>#</a></h2><ul><li>Slack ì „ì†¡ ì‹¤íŒ¨ ì‹œ <strong>ì„œë¹„ìŠ¤ ë¡œì§ ì°¨ë‹¨ ê¸ˆì§€</strong> â€” ë„¤íŠ¸ì›Œí¬ ì¥ì• ê°€ ëª¨ë¸ ì„œë¹™ì„ ë§‰ì§€ ì•Šê²Œ</li><li>ë°°í¬ ì „ <strong>Webhook Secret ë¶ˆì¼ì¹˜</strong> ì—¬ë¶€ë¥¼ devì—ì„œ ë°˜ë“œì‹œ ì ê²€</li></ul><hr><h2 id=-ì •ë¦¬>ğŸ ì •ë¦¬<a hidden class=anchor aria-hidden=true href=#-ì •ë¦¬>#</a></h2><blockquote><p>ì´ì œ FastAPIì™€ Airflowê°€ í•˜ë‚˜ì˜ Slack ì¸í„°í˜ì´ìŠ¤ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>ë‹¨ì¼ í•¨ìˆ˜(<code>send_slack_alert</code>)ë§Œìœ¼ë¡œ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘ ì „ êµ¬ê°„ì˜ ê´€ì œ ì•Œë¦¼ì„ ì—°ê²°í•  ìˆ˜ ìˆìœ¼ë©°,</p><p>í™˜ê²½ ë¶„ë¦¬ë¥¼ ìœ ì§€í•˜ë©´ì„œë„ ì‹¤ì‹œê°„ ìš´ì˜ ëª¨ë‹ˆí„°ë§ì´ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/04/><span class=title>Â« Prev</span><br><span>[MLOps ìš´ì˜ ê³ ë„í™” - 3ë‹¨ê³„: ëª¨ë¸ ë¡¤ë°± ìë™í™” (ë“±ë¡ ì‹¤íŒ¨ ëŒ€ë¹„ ë³µêµ¬)]</span>
</a><a class=next href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/02/><span class=title>Next Â»</span><br><span>[MLOps ìš´ì˜ ê³ ë„í™” - 1ë‹¨ê³„: í•«ìŠ¤ì™‘ ê³ ë„í™” (/reload ë³´ì•ˆÂ·DAG ìë™í™”)]</span></a></nav></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>