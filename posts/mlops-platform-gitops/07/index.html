<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content="FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,
ê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”
A/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€
â€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ
**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€

ğŸ¯ í•µì‹¬ ìš”ì•½


ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)"><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/07/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/07/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/07/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]"><meta property="og:description" content="FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,
ê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”
A/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€
â€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ
**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€
ğŸ¯ í•µì‹¬ ìš”ì•½ ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)"><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-27T17:10:21+09:00"><meta property="article:modified_time" content="2025-08-27T17:10:21+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]"><meta name=twitter:description content="FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,
ê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”
A/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€
â€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ
**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€

ğŸ¯ í•µì‹¬ ìš”ì•½


ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://keonhoban.github.io/mlops-journey/posts/"},{"@type":"ListItem","position":2,"name":"[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]","item":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/07/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]","name":"[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]","description":"FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,\nê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”\nA/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€\nâ€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ\n**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€\nğŸ¯ í•µì‹¬ ìš”ì•½ ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)\n","keywords":[],"articleBody":"FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,\nê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”\nA/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€\nâ€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ\n**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€\nğŸ¯ í•µì‹¬ ìš”ì•½ ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)\n(models:/@ + get_model_version_by_alias)\nMLflow ì„œë¹„ìŠ¤ FQDN\ndev: http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000 prod: http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000 Ingress ë³´ì•ˆ í‚¤: nginx.ingress.kubernetes.io/whitelist-source-range\ní—¬ìŠ¤ ì²´í¬: ok / degraded / unhealthy 3ë‹¨ê³„ ìƒíƒœ ì™„ì „ êµ¬í˜„\nì´í›„ 1~9ë‹¨ê³„ ëª¨ë“  ì‹¤ìŠµì€ ì´ êµ¬ì¡°ë¥¼ ê³µí†µ ë² ì´ìŠ¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.\nArgoCD, Airflow, MLflow, FastAPIê°€ ì™„ì „ ë™ê¸°í™”ëœ GitOps ê¸°ë°˜ MLOps ìš´ì˜ êµ¬ì¡°ì…ë‹ˆë‹¤.\n1ï¸âƒ£ ì „ì²´ êµ¬ì¡° ìš”ì•½ flowchart LR subgraph FastAPI[\"ğŸš€ FastAPI App (charts/fastapi/app)\"] MAIN[\"main.py\"] START[\"core/startup.py (A/B ì´ˆê¸° ë¡œë”©)\"] CONF[\"core/config.py (env ì„¤ì •)\"] ROUTES[\"routes/* (predict/reload/health/models/root)\"] SVCS[\"services/* (model_loader/alias_selector)\"] UTILS[\"utils/* (logger/slack_alerts)\"] end subgraph MLPlatform[\"ğŸ§  ML Platform\"] MF[\"MLflow Registry (Alias=A/B)\"] AF[\"Airflow DAG (trainâ†’registerâ†’sensorâ†’reload)\"] end MAIN --\u003e START MAIN --\u003e ROUTES ROUTES --\u003e SVCS ROUTES --\u003e UTILS SVCS --\u003e MF AF -- \"POST /variant/{alias}/reload\" --\u003e ROUTES classDef node fill:#f7f7ff,stroke:#7aa7ff,stroke-width:1px,color:#0b318f; classDef sub fill:#eef5ff,stroke:#7aa7ff,stroke-width:1px,color:#0b318f; class MAIN,START,CONF,ROUTES,SVCS,UTILS,MF,AF node; class FastAPI,MLPlatform sub; 2ï¸âƒ£ ì½”ë“œ íŠ¸ë¦¬ charts/fastapi/app/ â”œâ”€ main.py â”œâ”€ core/ â”‚ â”œâ”€ config.py â”‚ â””â”€ startup.py â”œâ”€ routes/ â”‚ â”œâ”€ health.py â”‚ â”œâ”€ models.py â”‚ â”œâ”€ predict.py â”‚ â”œâ”€ reload.py â”‚ â””â”€ root.py â”œâ”€ services/ â”‚ â”œâ”€ alias_selector.py â”‚ â””â”€ model_loader.py â””â”€ utils/ â”œâ”€ logger.py â””â”€ slack_alerts.py ì „ì²´ ì½”ë“œëŠ” ë ˆí¬ì— ìˆìŠµë‹ˆë‹¤ (ì—í•„ë¡œê·¸ ì°¸ê³ )\n3ï¸âƒ£ í•µì‹¬ ë³€ê²½ ìš”ì•½ ìë™/ìˆ˜ë™ ë¶„ë¦¬\n/predict â†’ ìë™ ë¶„ê¸°(A/B/Canary/Blue-Green)\n/variant/{alias}/predict â†’ ìˆ˜ë™ ì§€ì •(A/B)\ní•«ìŠ¤ì™‘ êµ¬ì¡° í‘œì¤€í™”\n/variant/{alias}/reload â†’ x-token ì¸ì¦ + Slack + ë¡œê·¸(NFS)\nê¸°ë™ ì‹œ ìë™ ë¡œë”©\nA/B ë™ì‹œ ë¡œë”© â†’ ì¼ë¶€ ì‹¤íŒ¨ degraded, ì „ë¶€ ì‹¤íŒ¨ unhealthy\nìƒíƒœ ê´€ë¦¬\n/health 3ë‹¨ê³„ + /models ë©”íƒ€ì •ë³´ ì œê³µ\n4ï¸âƒ£ ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½ ë©”ì„œë“œ ê²½ë¡œ ì„¤ëª… POST /predict x-client-id ê¸°ë°˜ ìë™ ë¶„ê¸° POST /variant/{alias}/predict alias ì§€ì • ì˜ˆì¸¡ (A/B) POST /variant/{alias}/reload ëª¨ë¸ í•«ìŠ¤ì™‘ (x-token ì¸ì¦ í•„ìš”) GET /health í—¬ìŠ¤ ìƒíƒœ (ok/degraded/unhealthy) GET /models í˜„ì¬ ë¡œë”© ëª¨ë¸ ì •ë³´ GET / ì „ì²´ ì—”ë“œí¬ì¸íŠ¸ ì¸ë±ìŠ¤ 5ï¸âƒ£ ë³´ì•ˆ \u0026 ë¡œê¹… ë³´ì•ˆ /variant/{alias}/reload: x-token == RELOAD_SECRET_TOKEN ì¼ì¹˜ ì‹œì—ë§Œ ìˆ˜í–‰ Ingress ë‚´ë¶€ë§ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ + TLS ì ìš© ë¡œê¹… loguru ê¸°ë°˜ íŒŒì¼ ë¡œê·¸ â†’ PVC (/app/logs/fastapi.log) ì•Œë¦¼ Slack Webhook (ì„±ê³µ/ì‹¤íŒ¨/í—¬ìŠ¤ ìƒíƒœ í…œí”Œë¦¿í™”) 6ï¸âƒ£ ë™ì‘ ì˜ˆì‹œ # âœ… ìˆ˜ë™ ì˜ˆì¸¡ (A) curl -k -X POST https://fastapi.local/variant/A/predict \\ -H \"Content-Type: application/json\" \\ -d '{\"data\": [[5.1,3.5,1.4,0.2]]}' # âœ… ìë™ ì˜ˆì¸¡ (x-client-id ê¸°ë°˜) curl -k -X POST https://fastapi.local/predict \\ -H \"x-client-id: client_88\" \\ -H \"Content-Type: application/json\" \\ -d '{\"data\": [[5.1,3.5,1.4,0.2]]}' # âœ… ëª¨ë¸ í•«ìŠ¤ì™‘ (B) curl -k -X POST https://fastapi.local/variant/B/reload \\ -H \"x-token: \" -k ì˜µì…˜ì€ self-signed ì¸ì¦ì„œìš© í…ŒìŠ¤íŠ¸ í”Œë˜ê·¸ì…ë‹ˆë‹¤.\n7ï¸âƒ£ ì²´í¬ë¦¬ìŠ¤íŠ¸ ALIAS_SELECTION_MODE = \"ab_test\" | \"canary\" | \"blue_green\" /variant/{alias}/reload í† í° í™•ì¸ (RELOAD_SECRET_TOKEN) Ingress í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (nginx.ingress.kubernetes.io/whitelist-source-range) Slack Secret (dev/prod ë¶„ë¦¬) PVC ê¶Œí•œ (fsGroup, runAsUser) MLflow Alias(@A/@B) ê¸°ë°˜ ì „í™˜ ë¡œì§ 8ï¸âƒ£ êµì°¨ ê²€ì¦ ê²°ê³¼ dev env ALIAS_SELECTION_MODE=blue_green, DEFAULT_ALIAS=B, CANARY_PERCENT=20 MLFLOW_TRACKING_URI=http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000 ë¶„ë°° ë¡œê·¸ ab_test_result.log 500ê±´ ì „ëŸ‰ B â†’ Blue-Green + DEFAULT_ALIAS=B ì •ìƒ ë™ì‘ PVC fastapi-logs-pvc-dev/prod ë‘˜ ë‹¤ Bound ìƒíƒœ í™•ì¸ 9ï¸âƒ£ ëŒ€í‘œ ì½”ë“œ ìŠ¤ëƒ…ìƒ· (1) services/alias_selector.py import hashlib from core.config import settings def get_alias(client_id: str | None) -\u003e str: mode = settings.alias_selection_mode if mode == \"blue_green\": return settings.default_alias if not client_id: return settings.default_alias hashed = int(hashlib.sha256(client_id.encode()).hexdigest(), 16) bucket = hashed % 100 if mode == \"ab_test\": return \"A\" if bucket \u003c 90 else \"B\" elif mode == \"canary\": return \"B\" if bucket \u003c settings.canary_percent else \"A\" else: return settings.default_alias (2) routes/predict.py from fastapi import APIRouter, Header, HTTPException, Request import pandas as pd from services.alias_selector import get_alias from core.config import settings from utils.logger import logger from utils.slack_alerts import send_slack_alert router = APIRouter() @router.post(\"/predict\") async def predict(request: Request, input_data: dict, x_client_id: str | None = Header(default=None)): models = getattr(request.app.state, \"models\", {}) if not models: raise HTTPException(status_code=503, detail=\"ëª¨ë¸ ë¯¸ë¡œë”© ìƒíƒœ\") alias = get_alias(x_client_id) model_entry = models.get(alias) if not model_entry: raise HTTPException(status_code=503, detail=f\"ëª¨ë¸ {alias} ë¯¸ë¡œë”© ìƒíƒœ\") try: df = pd.DataFrame(input_data.get(\"data\", [])) prediction = model_entry[\"model\"].predict(df) logger.info(f\"[Predict] alias={alias}, mode={settings.alias_selection_mode}, client_id={x_client_id}\") return {\"variant\": alias, \"mode\": settings.alias_selection_mode, \"prediction\": prediction.tolist()} except Exception as e: logger.exception(\"ì˜ˆì¸¡ ì‹¤íŒ¨\") send_slack_alert(f\"âŒ ì˜ˆì¸¡ ì‹¤íŒ¨ (alias={alias}): {e}\") raise HTTPException(status_code=500, detail=\"ì˜ˆì¸¡ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜\") (3) services/model_loader.py import mlflow.pyfunc from mlflow.tracking import MlflowClient from utils.slack_alerts import send_slack_alert from loguru import logger from core.config import settings def load_model_by_alias(alias: str): try: mlflow.set_tracking_uri(settings.mlflow_tracking_uri) client = MlflowClient() model_uri = f\"models:/{settings.model_name}@{alias}\" model = mlflow.pyfunc.load_model(model_uri) version_info = client.get_model_version_by_alias(settings.model_name, alias) logger.info(f\"âœ… ëª¨ë¸ ë¡œë”© ì„±ê³µ: alias={alias}, version={version_info.version}\") return { \"model\": model, \"info\": { \"model_name\": settings.model_name, \"alias\": alias, \"version\": version_info.version, \"run_id\": version_info.run_id, \"model_uri\": model_uri, } } except Exception as e: logger.error(f\"âŒ ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨: {e}\") send_slack_alert(f\"âŒ ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨: alias={alias}, {e}\") return None (4) routes/health.py from fastapi import APIRouter, Request router = APIRouter() @router.get(\"/health\") def health_check(request: Request): models = getattr(request.app.state, \"models\", {}) if not models: return {\"status\": \"unhealthy\", \"loaded\": []} missing = [v for v in [\"A\", \"B\"] if v not in models] if missing: return {\"status\": \"degraded\", \"loaded\": list(models.keys()), \"missing\": missing} return {\"status\": \"ok\", \"loaded\": list(models.keys())} ğŸ”Ÿ Helm ì£¼ìš” ê°’ â–¶ dev env: MLFLOW_TRACKING_URI: \"http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000\" MODEL_NAME: \"best_model\" DEFAULT_ALIAS: \"B\" ALIAS_SELECTION_MODE: \"blue_green\" CANARY_PERCENT: \"20\" â–¶ prod env: MLFLOW_TRACKING_URI: \"http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000\" MODEL_NAME: \"best_model\" DEFAULT_ALIAS: \"B\" ALIAS_SELECTION_MODE: \"blue_green\" CANARY_PERCENT: \"10\" ğŸ§© íŒ ğŸ§© Secret ì´ë¦„ ì¼ì¹˜ì„±: envFrom.secretRef.name â†” ì‹¤ì œ Secret metadata.name ğŸ”§ Blue-Green ëª¨ë“œì—ì„œëŠ” CANARY_PERCENT ë¯¸ì‚¬ìš© ğŸ”§ ê¸°ë™ ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ ì¢…ë£Œ(sys.exit) â†’ Health ë…¸ì´ì¦ˆ ì°¨ë‹¨ ğŸ§­ ê²€ì¦ ëª…ë ¹ ëª¨ìŒ # FastAPI env í™•ì¸ kubectl -n fastapi-dev exec $(kubectl -n fastapi-dev get po -l app=fastapi-dev -o name | head -1) -- \\ printenv | egrep 'ALIAS_SELECTION_MODE|DEFAULT_ALIAS|CANARY_PERCENT|MLFLOW_TRACKING_URI|MODEL_NAME' # MLflow ì„œë¹„ìŠ¤ DNS í™•ì¸ kubectl -n mlflow-dev get svc mlflow-dev-service -o wide kubectl -n mlflow-prod get svc mlflow-prod-service -o wide # Ingress í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ í™•ì¸ kubectl -n fastapi-dev get ing -o yaml | egrep 'ingressClassName|whitelist-source-range|host:' # í—¬ìŠ¤ ìƒíƒœ í™•ì¸ curl -sk https://fastapi.local/health ğŸ ì •ë¦¬ FastAPIì˜ A/B/Canary/Blue-Green êµ¬ì¡°ê°€ Helm, MLflow, Slack, PVC, ArgoCDì™€ ì™„ì „ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.\nIngress, Secrets, MLflow Aliasê¹Œì§€ ëª¨ë‘ ì‹¤í™˜ê²½ ê¸°ì¤€ìœ¼ë¡œ ê²€ì¦ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\n","wordCount":"943","inLanguage":"en","datePublished":"2025-08-27T17:10:21+09:00","dateModified":"2025-08-27T17:10:21+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/07/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[MLOps ìš´ì˜ ê³ ë„í™” - 6ë‹¨ê³„: GitOps ê³ ë„í™” (Argo CDÂ·MetalLBÂ·ApplicationSet)]</h1><div class=post-meta><span title='2025-08-27 17:10:21 +0900 +0900'>August 27, 2025</span>&nbsp;Â·&nbsp;5 min</div></header><div class=post-content><h2 id=fastapi-ì•±-ì „ë©´-ê°œí¸-ab--canary--blue-green-ì„œë¹™-ë² ì´ìŠ¤>FastAPI ì•± ì „ë©´ ê°œí¸: A/B Â· Canary Â· Blue-Green ì„œë¹™ ë² ì´ìŠ¤<a hidden class=anchor aria-hidden=true href=#fastapi-ì•±-ì „ë©´-ê°œí¸-ab--canary--blue-green-ì„œë¹™-ë² ì´ìŠ¤>#</a></h2><hr><h2 id=-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…<a hidden class=anchor aria-hidden=true href=#-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>#</a></h2><blockquote><p>â€œìš´ì˜ í™˜ê²½ì—ì„œ ëª¨ë¸ì€ ì–¸ì œë“  êµì²´ë  ìˆ˜ ìˆê³ ,</p><p>ê·¸ ìˆœê°„ì´ ì„œë¹„ìŠ¤ í’ˆì§ˆì´ ê°€ì¥ í¬ê²Œ í”ë“¤ë¦¬ëŠ” ìœ„í—˜ êµ¬ê°„ì…ë‹ˆë‹¤.â€</p><p>â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ì´í›„ ëª¨ë“  ìë™í™”(í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°±)ì˜ ê¸°ë°˜ì´ ë˜ëŠ”</p><p><strong>A/B Â· Canary Â· Blue-Green ì „ëµì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” FastAPI ì„œë¹™ êµ¬ì¡°</strong>ë¶€í„° ì¡ì•˜ìŠµë‹ˆë‹¤.â€</p><p>â€œì´ ë¼ˆëŒ€ê°€ ì™„ì„±ë¼ì•¼ Airflow, MLflow, ArgoCDì™€ ì—°ê²°ëœ</p><p>**ì§„ì§œ â€˜ìš´ì˜í˜• MLOps íŒŒì´í”„ë¼ì¸â€™**ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.â€</p></blockquote><hr><h3 id=-í•µì‹¬-ìš”ì•½>ğŸ¯ í•µì‹¬ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#-í•µì‹¬-ìš”ì•½>#</a></h3><ul><li><p><strong>ì „í™˜ ê¸°ì¤€ = MLflow Alias(@A/@B)</strong></p><p>(<code>models:/&lt;name>@&lt;alias></code> + <code>get_model_version_by_alias</code>)</p></li><li><p><strong>MLflow ì„œë¹„ìŠ¤ FQDN</strong></p><ul><li>dev: <code>http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000</code></li><li>prod: <code>http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000</code></li></ul></li><li><p><strong>Ingress ë³´ì•ˆ í‚¤</strong>: <code>nginx.ingress.kubernetes.io/whitelist-source-range</code></p></li><li><p><strong>í—¬ìŠ¤ ì²´í¬</strong>: <code>ok / degraded / unhealthy</code> 3ë‹¨ê³„ ìƒíƒœ ì™„ì „ êµ¬í˜„</p></li></ul><blockquote><p>ì´í›„ 1~9ë‹¨ê³„ ëª¨ë“  ì‹¤ìŠµì€ ì´ êµ¬ì¡°ë¥¼ ê³µí†µ ë² ì´ìŠ¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</p><p>ArgoCD, Airflow, MLflow, FastAPIê°€ ì™„ì „ ë™ê¸°í™”ëœ GitOps ê¸°ë°˜ MLOps ìš´ì˜ êµ¬ì¡°ì…ë‹ˆë‹¤.</p></blockquote><hr><h2 id=1-ì „ì²´-êµ¬ì¡°-ìš”ì•½>1ï¸âƒ£ ì „ì²´ êµ¬ì¡° ìš”ì•½<a hidden class=anchor aria-hidden=true href=#1-ì „ì²´-êµ¬ì¡°-ìš”ì•½>#</a></h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>flowchart LR
  subgraph FastAPI[&#34;ğŸš€ FastAPI App (charts/fastapi/app)&#34;]
    MAIN[&#34;main.py&#34;]
    START[&#34;core/startup.py (A/B ì´ˆê¸° ë¡œë”©)&#34;]
    CONF[&#34;core/config.py (env ì„¤ì •)&#34;]
    ROUTES[&#34;routes/* (predict/reload/health/models/root)&#34;]
    SVCS[&#34;services/* (model_loader/alias_selector)&#34;]
    UTILS[&#34;utils/* (logger/slack_alerts)&#34;]
  end

  subgraph MLPlatform[&#34;ğŸ§  ML Platform&#34;]
    MF[&#34;MLflow Registry (Alias=A/B)&#34;]
    AF[&#34;Airflow DAG (trainâ†’registerâ†’sensorâ†’reload)&#34;]
  end

  MAIN --&gt; START
  MAIN --&gt; ROUTES
  ROUTES --&gt; SVCS
  ROUTES --&gt; UTILS
  SVCS --&gt; MF
  AF -- &#34;POST /variant/{alias}/reload&#34; --&gt; ROUTES

  classDef node fill:#f7f7ff,stroke:#7aa7ff,stroke-width:1px,color:#0b318f;
  classDef sub fill:#eef5ff,stroke:#7aa7ff,stroke-width:1px,color:#0b318f;
  class MAIN,START,CONF,ROUTES,SVCS,UTILS,MF,AF node;
  class FastAPI,MLPlatform sub;
</code></pre><hr><h2 id=2-ì½”ë“œ-íŠ¸ë¦¬>2ï¸âƒ£ ì½”ë“œ íŠ¸ë¦¬<a hidden class=anchor aria-hidden=true href=#2-ì½”ë“œ-íŠ¸ë¦¬>#</a></h2><pre tabindex=0><code>charts/fastapi/app/
â”œâ”€ main.py
â”œâ”€ core/
â”‚  â”œâ”€ config.py
â”‚  â””â”€ startup.py
â”œâ”€ routes/
â”‚  â”œâ”€ health.py
â”‚  â”œâ”€ models.py
â”‚  â”œâ”€ predict.py
â”‚  â”œâ”€ reload.py
â”‚  â””â”€ root.py
â”œâ”€ services/
â”‚  â”œâ”€ alias_selector.py
â”‚  â””â”€ model_loader.py
â””â”€ utils/
   â”œâ”€ logger.py
   â””â”€ slack_alerts.py
</code></pre><blockquote><p>ì „ì²´ ì½”ë“œëŠ” ë ˆí¬ì— ìˆìŠµë‹ˆë‹¤ (ì—í•„ë¡œê·¸ ì°¸ê³ )</p></blockquote><hr><h2 id=3-í•µì‹¬-ë³€ê²½-ìš”ì•½>3ï¸âƒ£ í•µì‹¬ ë³€ê²½ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#3-í•µì‹¬-ë³€ê²½-ìš”ì•½>#</a></h2><ul><li><p><strong>ìë™/ìˆ˜ë™ ë¶„ë¦¬</strong></p><p><code>/predict</code> â†’ ìë™ ë¶„ê¸°(A/B/Canary/Blue-Green)</p><p><code>/variant/{alias}/predict</code> â†’ ìˆ˜ë™ ì§€ì •(A/B)</p></li><li><p><strong>í•«ìŠ¤ì™‘ êµ¬ì¡° í‘œì¤€í™”</strong></p><p><code>/variant/{alias}/reload</code> â†’ <code>x-token</code> ì¸ì¦ + Slack + ë¡œê·¸(NFS)</p></li><li><p><strong>ê¸°ë™ ì‹œ ìë™ ë¡œë”©</strong></p><p><code>A/B</code> ë™ì‹œ ë¡œë”© â†’ ì¼ë¶€ ì‹¤íŒ¨ <code>degraded</code>, ì „ë¶€ ì‹¤íŒ¨ <code>unhealthy</code></p></li><li><p><strong>ìƒíƒœ ê´€ë¦¬</strong></p><p><code>/health</code> 3ë‹¨ê³„ + <code>/models</code> ë©”íƒ€ì •ë³´ ì œê³µ</p></li></ul><hr><h2 id=4-ì—”ë“œí¬ì¸íŠ¸-ìš”ì•½>4ï¸âƒ£ ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#4-ì—”ë“œí¬ì¸íŠ¸-ìš”ì•½>#</a></h2><table><thead><tr><th>ë©”ì„œë“œ</th><th>ê²½ë¡œ</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td><code>POST</code></td><td><code>/predict</code></td><td><code>x-client-id</code> ê¸°ë°˜ ìë™ ë¶„ê¸°</td></tr><tr><td><code>POST</code></td><td><code>/variant/{alias}/predict</code></td><td>alias ì§€ì • ì˜ˆì¸¡ (A/B)</td></tr><tr><td><code>POST</code></td><td><code>/variant/{alias}/reload</code></td><td>ëª¨ë¸ í•«ìŠ¤ì™‘ (<code>x-token</code> ì¸ì¦ í•„ìš”)</td></tr><tr><td><code>GET</code></td><td><code>/health</code></td><td>í—¬ìŠ¤ ìƒíƒœ (ok/degraded/unhealthy)</td></tr><tr><td><code>GET</code></td><td><code>/models</code></td><td>í˜„ì¬ ë¡œë”© ëª¨ë¸ ì •ë³´</td></tr><tr><td><code>GET</code></td><td><code>/</code></td><td>ì „ì²´ ì—”ë“œí¬ì¸íŠ¸ ì¸ë±ìŠ¤</td></tr></tbody></table><hr><h2 id=5-ë³´ì•ˆ--ë¡œê¹…>5ï¸âƒ£ ë³´ì•ˆ & ë¡œê¹…<a hidden class=anchor aria-hidden=true href=#5-ë³´ì•ˆ--ë¡œê¹…>#</a></h2><ul><li><strong>ë³´ì•ˆ</strong><ul><li><code>/variant/{alias}/reload</code>: <code>x-token == RELOAD_SECRET_TOKEN</code> ì¼ì¹˜ ì‹œì—ë§Œ ìˆ˜í–‰</li><li>Ingress ë‚´ë¶€ë§ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ + TLS ì ìš©</li></ul></li><li><strong>ë¡œê¹…</strong><ul><li><code>loguru</code> ê¸°ë°˜ íŒŒì¼ ë¡œê·¸ â†’ PVC (<code>/app/logs/fastapi.log</code>)</li></ul></li><li><strong>ì•Œë¦¼</strong><ul><li>Slack Webhook (ì„±ê³µ/ì‹¤íŒ¨/í—¬ìŠ¤ ìƒíƒœ í…œí”Œë¦¿í™”)</li></ul></li></ul><hr><h2 id=6-ë™ì‘-ì˜ˆì‹œ>6ï¸âƒ£ ë™ì‘ ì˜ˆì‹œ<a hidden class=anchor aria-hidden=true href=#6-ë™ì‘-ì˜ˆì‹œ>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># âœ… ìˆ˜ë™ ì˜ˆì¸¡ (A)</span>
</span></span><span style=display:flex><span>curl -k -X POST https://fastapi.local/variant/A/predict <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d <span style=color:#e6db74>&#39;{&#34;data&#34;: [[5.1,3.5,1.4,0.2]]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># âœ… ìë™ ì˜ˆì¸¡ (x-client-id ê¸°ë°˜)</span>
</span></span><span style=display:flex><span>curl -k -X POST https://fastapi.local/predict <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;x-client-id: client_88&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -d <span style=color:#e6db74>&#39;{&#34;data&#34;: [[5.1,3.5,1.4,0.2]]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># âœ… ëª¨ë¸ í•«ìŠ¤ì™‘ (B)</span>
</span></span><span style=display:flex><span>curl -k -X POST https://fastapi.local/variant/B/reload <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;x-token: &lt;RELOAD_SECRET_TOKEN&gt;&#34;</span>
</span></span></code></pre></div><blockquote><p>-k ì˜µì…˜ì€ self-signed ì¸ì¦ì„œìš© í…ŒìŠ¤íŠ¸ í”Œë˜ê·¸ì…ë‹ˆë‹¤.</p></blockquote><hr><h2 id=7-ì²´í¬ë¦¬ìŠ¤íŠ¸>7ï¸âƒ£ ì²´í¬ë¦¬ìŠ¤íŠ¸<a hidden class=anchor aria-hidden=true href=#7-ì²´í¬ë¦¬ìŠ¤íŠ¸>#</a></h2><ul><li><input disabled type=checkbox> <code>ALIAS_SELECTION_MODE</code> = <code>"ab_test" | "canary" | "blue_green"</code></li><li><input disabled type=checkbox> <code>/variant/{alias}/reload</code> í† í° í™•ì¸ (<code>RELOAD_SECRET_TOKEN</code>)</li><li><input disabled type=checkbox> Ingress í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (<code>nginx.ingress.kubernetes.io/whitelist-source-range</code>)</li><li><input disabled type=checkbox> Slack Secret (dev/prod ë¶„ë¦¬)</li><li><input disabled type=checkbox> PVC ê¶Œí•œ (<code>fsGroup</code>, <code>runAsUser</code>)</li><li><input disabled type=checkbox> MLflow Alias(@A/@B) ê¸°ë°˜ ì „í™˜ ë¡œì§</li></ul><hr><h2 id=8-êµì°¨-ê²€ì¦-ê²°ê³¼>8ï¸âƒ£ êµì°¨ ê²€ì¦ ê²°ê³¼<a hidden class=anchor aria-hidden=true href=#8-êµì°¨-ê²€ì¦-ê²°ê³¼>#</a></h2><ul><li><strong>dev env</strong><ul><li><code>ALIAS_SELECTION_MODE=blue_green</code>, <code>DEFAULT_ALIAS=B</code>, <code>CANARY_PERCENT=20</code></li><li><code>MLFLOW_TRACKING_URI=http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000</code></li></ul></li><li><strong>ë¶„ë°° ë¡œê·¸</strong><ul><li><code>ab_test_result.log</code> 500ê±´ ì „ëŸ‰ B â†’ Blue-Green + DEFAULT_ALIAS=B ì •ìƒ ë™ì‘</li></ul></li><li><strong>PVC</strong><ul><li><code>fastapi-logs-pvc-dev/prod</code> ë‘˜ ë‹¤ Bound ìƒíƒœ í™•ì¸</li></ul></li></ul><hr><h2 id=9-ëŒ€í‘œ-ì½”ë“œ-ìŠ¤ëƒ…ìƒ·>9ï¸âƒ£ ëŒ€í‘œ ì½”ë“œ ìŠ¤ëƒ…ìƒ·<a hidden class=anchor aria-hidden=true href=#9-ëŒ€í‘œ-ì½”ë“œ-ìŠ¤ëƒ…ìƒ·>#</a></h2><h3 id=1-servicesalias_selectorpy>(1) <code>services/alias_selector.py</code><a hidden class=anchor aria-hidden=true href=#1-servicesalias_selectorpy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> core.config <span style=color:#f92672>import</span> settings
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_alias</span>(client_id: str <span style=color:#f92672>|</span> <span style=color:#66d9ef>None</span>) <span style=color:#f92672>-&gt;</span> str:
</span></span><span style=display:flex><span>    mode <span style=color:#f92672>=</span> settings<span style=color:#f92672>.</span>alias_selection_mode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> mode <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;blue_green&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> settings<span style=color:#f92672>.</span>default_alias
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> client_id:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> settings<span style=color:#f92672>.</span>default_alias
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    hashed <span style=color:#f92672>=</span> int(hashlib<span style=color:#f92672>.</span>sha256(client_id<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>hexdigest(), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>    bucket <span style=color:#f92672>=</span> hashed <span style=color:#f92672>%</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> mode <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;ab_test&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;A&#34;</span> <span style=color:#66d9ef>if</span> bucket <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>90</span> <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;B&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> mode <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;canary&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;B&#34;</span> <span style=color:#66d9ef>if</span> bucket <span style=color:#f92672>&lt;</span> settings<span style=color:#f92672>.</span>canary_percent <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;A&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> settings<span style=color:#f92672>.</span>default_alias
</span></span></code></pre></div><h3 id=2-routespredictpy>(2) <code>routes/predict.py</code><a hidden class=anchor aria-hidden=true href=#2-routespredictpy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> fastapi <span style=color:#f92672>import</span> APIRouter, Header, HTTPException, Request
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> services.alias_selector <span style=color:#f92672>import</span> get_alias
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> core.config <span style=color:#f92672>import</span> settings
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> utils.logger <span style=color:#f92672>import</span> logger
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> utils.slack_alerts <span style=color:#f92672>import</span> send_slack_alert
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>router <span style=color:#f92672>=</span> APIRouter()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@router.post</span>(<span style=color:#e6db74>&#34;/predict&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>predict</span>(request: Request, input_data: dict, x_client_id: str <span style=color:#f92672>|</span> <span style=color:#66d9ef>None</span> <span style=color:#f92672>=</span> Header(default<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>)):
</span></span><span style=display:flex><span>    models <span style=color:#f92672>=</span> getattr(request<span style=color:#f92672>.</span>app<span style=color:#f92672>.</span>state, <span style=color:#e6db74>&#34;models&#34;</span>, {})
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> models:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> HTTPException(status_code<span style=color:#f92672>=</span><span style=color:#ae81ff>503</span>, detail<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ëª¨ë¸ ë¯¸ë¡œë”© ìƒíƒœ&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    alias <span style=color:#f92672>=</span> get_alias(x_client_id)
</span></span><span style=display:flex><span>    model_entry <span style=color:#f92672>=</span> models<span style=color:#f92672>.</span>get(alias)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> model_entry:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> HTTPException(status_code<span style=color:#f92672>=</span><span style=color:#ae81ff>503</span>, detail<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;ëª¨ë¸ </span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74> ë¯¸ë¡œë”© ìƒíƒœ&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(input_data<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;data&#34;</span>, []))
</span></span><span style=display:flex><span>        prediction <span style=color:#f92672>=</span> model_entry[<span style=color:#e6db74>&#34;model&#34;</span>]<span style=color:#f92672>.</span>predict(df)
</span></span><span style=display:flex><span>        logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;[Predict] alias=</span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74>, mode=</span><span style=color:#e6db74>{</span>settings<span style=color:#f92672>.</span>alias_selection_mode<span style=color:#e6db74>}</span><span style=color:#e6db74>, client_id=</span><span style=color:#e6db74>{</span>x_client_id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;variant&#34;</span>: alias, <span style=color:#e6db74>&#34;mode&#34;</span>: settings<span style=color:#f92672>.</span>alias_selection_mode, <span style=color:#e6db74>&#34;prediction&#34;</span>: prediction<span style=color:#f92672>.</span>tolist()}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        logger<span style=color:#f92672>.</span>exception(<span style=color:#e6db74>&#34;ì˜ˆì¸¡ ì‹¤íŒ¨&#34;</span>)
</span></span><span style=display:flex><span>        send_slack_alert(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âŒ ì˜ˆì¸¡ ì‹¤íŒ¨ (alias=</span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74>): </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> HTTPException(status_code<span style=color:#f92672>=</span><span style=color:#ae81ff>500</span>, detail<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ì˜ˆì¸¡ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜&#34;</span>)
</span></span></code></pre></div><h3 id=3-servicesmodel_loaderpy>(3) <code>services/model_loader.py</code><a hidden class=anchor aria-hidden=true href=#3-servicesmodel_loaderpy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> mlflow.pyfunc
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> mlflow.tracking <span style=color:#f92672>import</span> MlflowClient
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> utils.slack_alerts <span style=color:#f92672>import</span> send_slack_alert
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> loguru <span style=color:#f92672>import</span> logger
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> core.config <span style=color:#f92672>import</span> settings
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_model_by_alias</span>(alias: str):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        mlflow<span style=color:#f92672>.</span>set_tracking_uri(settings<span style=color:#f92672>.</span>mlflow_tracking_uri)
</span></span><span style=display:flex><span>        client <span style=color:#f92672>=</span> MlflowClient()
</span></span><span style=display:flex><span>        model_uri <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;models:/</span><span style=color:#e6db74>{</span>settings<span style=color:#f92672>.</span>model_name<span style=color:#e6db74>}</span><span style=color:#e6db74>@</span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        model <span style=color:#f92672>=</span> mlflow<span style=color:#f92672>.</span>pyfunc<span style=color:#f92672>.</span>load_model(model_uri)
</span></span><span style=display:flex><span>        version_info <span style=color:#f92672>=</span> client<span style=color:#f92672>.</span>get_model_version_by_alias(settings<span style=color:#f92672>.</span>model_name, alias)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        logger<span style=color:#f92672>.</span>info(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âœ… ëª¨ë¸ ë¡œë”© ì„±ê³µ: alias=</span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74>, version=</span><span style=color:#e6db74>{</span>version_info<span style=color:#f92672>.</span>version<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;model&#34;</span>: model,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;model_name&#34;</span>: settings<span style=color:#f92672>.</span>model_name,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;alias&#34;</span>: alias,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;version&#34;</span>: version_info<span style=color:#f92672>.</span>version,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;run_id&#34;</span>: version_info<span style=color:#f92672>.</span>run_id,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;model_uri&#34;</span>: model_uri,
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>Exception</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        logger<span style=color:#f92672>.</span>error(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âŒ ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨: </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        send_slack_alert(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;âŒ ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨: alias=</span><span style=color:#e6db74>{</span>alias<span style=color:#e6db74>}</span><span style=color:#e6db74>, </span><span style=color:#e6db74>{</span>e<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>None</span>
</span></span></code></pre></div><h3 id=4-routeshealthpy>(4) <code>routes/health.py</code><a hidden class=anchor aria-hidden=true href=#4-routeshealthpy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> fastapi <span style=color:#f92672>import</span> APIRouter, Request
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>router <span style=color:#f92672>=</span> APIRouter()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@router.get</span>(<span style=color:#e6db74>&#34;/health&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>health_check</span>(request: Request):
</span></span><span style=display:flex><span>    models <span style=color:#f92672>=</span> getattr(request<span style=color:#f92672>.</span>app<span style=color:#f92672>.</span>state, <span style=color:#e6db74>&#34;models&#34;</span>, {})
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> models:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;unhealthy&#34;</span>, <span style=color:#e6db74>&#34;loaded&#34;</span>: []}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    missing <span style=color:#f92672>=</span> [v <span style=color:#66d9ef>for</span> v <span style=color:#f92672>in</span> [<span style=color:#e6db74>&#34;A&#34;</span>, <span style=color:#e6db74>&#34;B&#34;</span>] <span style=color:#66d9ef>if</span> v <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> models]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> missing:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;degraded&#34;</span>, <span style=color:#e6db74>&#34;loaded&#34;</span>: list(models<span style=color:#f92672>.</span>keys()), <span style=color:#e6db74>&#34;missing&#34;</span>: missing}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#e6db74>&#34;ok&#34;</span>, <span style=color:#e6db74>&#34;loaded&#34;</span>: list(models<span style=color:#f92672>.</span>keys())}
</span></span></code></pre></div><hr><h2 id=-helm-ì£¼ìš”-ê°’>ğŸ”Ÿ Helm ì£¼ìš” ê°’<a hidden class=anchor aria-hidden=true href=#-helm-ì£¼ìš”-ê°’>#</a></h2><h3 id=-dev>â–¶ dev<a hidden class=anchor aria-hidden=true href=#-dev>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>MLFLOW_TRACKING_URI</span>: <span style=color:#e6db74>&#34;http://mlflow-dev-service.mlflow-dev.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>MODEL_NAME</span>: <span style=color:#e6db74>&#34;best_model&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>DEFAULT_ALIAS</span>: <span style=color:#e6db74>&#34;B&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ALIAS_SELECTION_MODE</span>: <span style=color:#e6db74>&#34;blue_green&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>CANARY_PERCENT</span>: <span style=color:#e6db74>&#34;20&#34;</span>
</span></span></code></pre></div><h3 id=-prod>â–¶ prod<a hidden class=anchor aria-hidden=true href=#-prod>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>MLFLOW_TRACKING_URI</span>: <span style=color:#e6db74>&#34;http://mlflow-prod-service.mlflow-prod.svc.cluster.local:5000&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>MODEL_NAME</span>: <span style=color:#e6db74>&#34;best_model&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>DEFAULT_ALIAS</span>: <span style=color:#e6db74>&#34;B&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ALIAS_SELECTION_MODE</span>: <span style=color:#e6db74>&#34;blue_green&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>CANARY_PERCENT</span>: <span style=color:#e6db74>&#34;10&#34;</span>
</span></span></code></pre></div><hr><h2 id=-íŒ>ğŸ§© íŒ<a hidden class=anchor aria-hidden=true href=#-íŒ>#</a></h2><ul><li>ğŸ§© <strong>Secret ì´ë¦„ ì¼ì¹˜ì„±</strong>: <code>envFrom.secretRef.name</code> â†” ì‹¤ì œ Secret <code>metadata.name</code></li><li>ğŸ”§ <strong>Blue-Green ëª¨ë“œì—ì„œëŠ” <code>CANARY_PERCENT</code> ë¯¸ì‚¬ìš©</strong></li><li>ğŸ”§ <strong>ê¸°ë™ ì‹¤íŒ¨ ì‹œ ì¦‰ì‹œ ì¢…ë£Œ(sys.exit)</strong> â†’ Health ë…¸ì´ì¦ˆ ì°¨ë‹¨</li></ul><hr><h2 id=-ê²€ì¦-ëª…ë ¹-ëª¨ìŒ>ğŸ§­ ê²€ì¦ ëª…ë ¹ ëª¨ìŒ<a hidden class=anchor aria-hidden=true href=#-ê²€ì¦-ëª…ë ¹-ëª¨ìŒ>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># FastAPI env í™•ì¸</span>
</span></span><span style=display:flex><span>kubectl -n fastapi-dev exec <span style=color:#66d9ef>$(</span>kubectl -n fastapi-dev get po -l app<span style=color:#f92672>=</span>fastapi-dev -o name | head -1<span style=color:#66d9ef>)</span> -- <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>printenv | egrep <span style=color:#e6db74>&#39;ALIAS_SELECTION_MODE|DEFAULT_ALIAS|CANARY_PERCENT|MLFLOW_TRACKING_URI|MODEL_NAME&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># MLflow ì„œë¹„ìŠ¤ DNS í™•ì¸</span>
</span></span><span style=display:flex><span>kubectl -n mlflow-dev  get svc mlflow-dev-service  -o wide
</span></span><span style=display:flex><span>kubectl -n mlflow-prod get svc mlflow-prod-service -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Ingress í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ í™•ì¸</span>
</span></span><span style=display:flex><span>kubectl -n fastapi-dev get ing -o yaml | egrep <span style=color:#e6db74>&#39;ingressClassName|whitelist-source-range|host:&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># í—¬ìŠ¤ ìƒíƒœ í™•ì¸</span>
</span></span><span style=display:flex><span>curl -sk https://fastapi.local/health
</span></span></code></pre></div><hr><h2 id=-ì •ë¦¬>ğŸ ì •ë¦¬<a hidden class=anchor aria-hidden=true href=#-ì •ë¦¬>#</a></h2><blockquote><p>FastAPIì˜ A/B/Canary/Blue-Green êµ¬ì¡°ê°€ Helm, MLflow, Slack, PVC, ArgoCDì™€ ì™„ì „ ë™ê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</p><p>Ingress, Secrets, MLflow Aliasê¹Œì§€ ëª¨ë‘ ì‹¤í™˜ê²½ ê¸°ì¤€ìœ¼ë¡œ ê²€ì¦ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/08/><span class=title>Â« Prev</span><br><span>[MLOps ìš´ì˜ ê³ ë„í™” - 7ë‹¨ê³„: Argo CD Notifications ìë™í™” (Slack ì—°ë™)]</span>
</a><a class=next href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-gitops/06/><span class=title>Next Â»</span><br><span>[MLOps ìš´ì˜ ê³ ë„í™” - 5ë‹¨ê³„: Airflow ì•ˆì •í™” & FastAPI HTTPS ë³´ì•ˆ]</span></a></nav></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>