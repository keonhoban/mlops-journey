<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content='âœ¨ TL;DR

ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±ì„ ë„˜ì–´ì„œ, ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€ ì§„í–‰
MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ  êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ 


ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„
graph TD

%% NFS êµ¬ì¡°
subgraph NFS_VM["NFS VM"]
  NFS[(ğŸ“‚ Logs)]
end

%% PostgreSQL êµ¬ì¡°
subgraph DB_VM["PostgreSQL VM"]
  airflow_db[(ğŸ—„ï¸ airflow_db)]
  mlflow_db[(ğŸ—„ï¸ mlflow_db)]
end

%% AWS êµ¬ì¡°
subgraph AWS["AWS"]
  S3[(ğŸª£ S3 / MLflow_artifacts)]
end

%% í´ëŸ¬ìŠ¤í„°
subgraph K8s_Cluster["ğŸ“¦ K8s Cluster"]
  Airflow[Airflow Pod]
  MLflow[MLflow Pod]
  FastAPI[FastAPI Pod]
end

%% ì™¸ë¶€ ì—°ë™
Airflow --> NFS
Airflow --> airflow_db
Airflow --> S3

MLflow --> mlflow_db
MLflow --> S3

FastAPI --> S3
FastAPI --> MLflow

ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš”

  
      
          êµ¬ì„± ìš”ì†Œ
          ì„¤ëª…
      
  
  
      
          Kubernetes í´ëŸ¬ìŠ¤í„°
          ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm & Ingress í™œìš©
      
      
          MLflow ì„œë²„
          ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬
      
      
          Airflow ì„œë²„
          DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš©
      
      
          FastAPI ì„œë²„
          MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ
      
      
          NFS ì„œë²„
          Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸)
      
      
          AWS S3
          MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš©
      
      
          PostgreSQL
          MLflow & Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨
      
  


ğŸ“‚ NFS ì„œë²„ êµ¬ì„±
âœ… ì„¤ì¹˜ & ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€)
sudo apt update
sudo apt install -y nfs-kernel-server

sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs
sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow  # ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš”
sudo chmod -R 775 /mnt/nfs_share/mlops/airflow
ğŸ“„ /etc/exports ì„¤ì •
# ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥)
/mnt/nfs_share/mlops/airflow/logs  192.168.18.0/24(rw,sync,no_subtree_check,root_squash)

# ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ)
/mnt/nfs_share/mlops 192.168.18.0/24(rw,sync,no_subtree_check,root_squash)
# ì ìš©
sudo exportfs -rav
sudo systemctl restart nfs-kernel-server
ğŸ“„ PV&amp;PVC ì„¤ì •'><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]"><meta property="og:description" content='âœ¨ TL;DR ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±ì„ ë„˜ì–´ì„œ, ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€ ì§„í–‰ MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ graph TD %% NFS êµ¬ì¡° subgraph NFS_VM["NFS VM"] NFS[(ğŸ“‚ Logs)] end %% PostgreSQL êµ¬ì¡° subgraph DB_VM["PostgreSQL VM"] airflow_db[(ğŸ—„ï¸ airflow_db)] mlflow_db[(ğŸ—„ï¸ mlflow_db)] end %% AWS êµ¬ì¡° subgraph AWS["AWS"] S3[(ğŸª£ S3 / MLflow_artifacts)] end %% í´ëŸ¬ìŠ¤í„° subgraph K8s_Cluster["ğŸ“¦ K8s Cluster"] Airflow[Airflow Pod] MLflow[MLflow Pod] FastAPI[FastAPI Pod] end %% ì™¸ë¶€ ì—°ë™ Airflow --> NFS Airflow --> airflow_db Airflow --> S3 MLflow --> mlflow_db MLflow --> S3 FastAPI --> S3 FastAPI --> MLflow ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš” êµ¬ì„± ìš”ì†Œ ì„¤ëª… Kubernetes í´ëŸ¬ìŠ¤í„° ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm & Ingress í™œìš© MLflow ì„œë²„ ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬ Airflow ì„œë²„ DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš© FastAPI ì„œë²„ MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ NFS ì„œë²„ Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸) AWS S3 MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš© PostgreSQL MLflow & Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨ ğŸ“‚ NFS ì„œë²„ êµ¬ì„± âœ… ì„¤ì¹˜ & ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€) sudo apt update sudo apt install -y nfs-kernel-server sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow # ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš” sudo chmod -R 775 /mnt/nfs_share/mlops/airflow ğŸ“„ /etc/exports ì„¤ì • # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥) /mnt/nfs_share/mlops/airflow/logs 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ) /mnt/nfs_share/mlops 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ì ìš© sudo exportfs -rav sudo systemctl restart nfs-kernel-server ğŸ“„ PV&amp;PVC ì„¤ì •'><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-23T17:11:47+09:00"><meta property="article:modified_time" content="2025-06-23T17:11:47+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]"><meta name=twitter:description content='âœ¨ TL;DR

ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±ì„ ë„˜ì–´ì„œ, ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€ ì§„í–‰
MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ  êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ 


ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„
graph TD

%% NFS êµ¬ì¡°
subgraph NFS_VM["NFS VM"]
  NFS[(ğŸ“‚ Logs)]
end

%% PostgreSQL êµ¬ì¡°
subgraph DB_VM["PostgreSQL VM"]
  airflow_db[(ğŸ—„ï¸ airflow_db)]
  mlflow_db[(ğŸ—„ï¸ mlflow_db)]
end

%% AWS êµ¬ì¡°
subgraph AWS["AWS"]
  S3[(ğŸª£ S3 / MLflow_artifacts)]
end

%% í´ëŸ¬ìŠ¤í„°
subgraph K8s_Cluster["ğŸ“¦ K8s Cluster"]
  Airflow[Airflow Pod]
  MLflow[MLflow Pod]
  FastAPI[FastAPI Pod]
end

%% ì™¸ë¶€ ì—°ë™
Airflow --> NFS
Airflow --> airflow_db
Airflow --> S3

MLflow --> mlflow_db
MLflow --> S3

FastAPI --> S3
FastAPI --> MLflow

ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš”

  
      
          êµ¬ì„± ìš”ì†Œ
          ì„¤ëª…
      
  
  
      
          Kubernetes í´ëŸ¬ìŠ¤í„°
          ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm & Ingress í™œìš©
      
      
          MLflow ì„œë²„
          ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬
      
      
          Airflow ì„œë²„
          DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš©
      
      
          FastAPI ì„œë²„
          MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ
      
      
          NFS ì„œë²„
          Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸)
      
      
          AWS S3
          MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš©
      
      
          PostgreSQL
          MLflow & Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨
      
  


ğŸ“‚ NFS ì„œë²„ êµ¬ì„±
âœ… ì„¤ì¹˜ & ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€)
sudo apt update
sudo apt install -y nfs-kernel-server

sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs
sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow  # ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš”
sudo chmod -R 775 /mnt/nfs_share/mlops/airflow
ğŸ“„ /etc/exports ì„¤ì •
# ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥)
/mnt/nfs_share/mlops/airflow/logs  192.168.18.0/24(rw,sync,no_subtree_check,root_squash)

# ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ)
/mnt/nfs_share/mlops 192.168.18.0/24(rw,sync,no_subtree_check,root_squash)
# ì ìš©
sudo exportfs -rav
sudo systemctl restart nfs-kernel-server
ğŸ“„ PV&amp;PVC ì„¤ì •'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://keonhoban.github.io/mlops-journey/posts/"},{"@type":"ListItem","position":2,"name":"[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]","item":"https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]","name":"[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]","description":"âœ¨ TL;DR ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±ì„ ë„˜ì–´ì„œ, ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€ ì§„í–‰ MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ graph TD %% NFS êµ¬ì¡° subgraph NFS_VM[\u0026#34;NFS VM\u0026#34;] NFS[(ğŸ“‚ Logs)] end %% PostgreSQL êµ¬ì¡° subgraph DB_VM[\u0026#34;PostgreSQL VM\u0026#34;] airflow_db[(ğŸ—„ï¸ airflow_db)] mlflow_db[(ğŸ—„ï¸ mlflow_db)] end %% AWS êµ¬ì¡° subgraph AWS[\u0026#34;AWS\u0026#34;] S3[(ğŸª£ S3 / MLflow_artifacts)] end %% í´ëŸ¬ìŠ¤í„° subgraph K8s_Cluster[\u0026#34;ğŸ“¦ K8s Cluster\u0026#34;] Airflow[Airflow Pod] MLflow[MLflow Pod] FastAPI[FastAPI Pod] end %% ì™¸ë¶€ ì—°ë™ Airflow --\u0026gt; NFS Airflow --\u0026gt; airflow_db Airflow --\u0026gt; S3 MLflow --\u0026gt; mlflow_db MLflow --\u0026gt; S3 FastAPI --\u0026gt; S3 FastAPI --\u0026gt; MLflow ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš” êµ¬ì„± ìš”ì†Œ ì„¤ëª… Kubernetes í´ëŸ¬ìŠ¤í„° ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm \u0026amp; Ingress í™œìš© MLflow ì„œë²„ ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬ Airflow ì„œë²„ DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš© FastAPI ì„œë²„ MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ NFS ì„œë²„ Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸) AWS S3 MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš© PostgreSQL MLflow \u0026amp; Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨ ğŸ“‚ NFS ì„œë²„ êµ¬ì„± âœ… ì„¤ì¹˜ \u0026amp; ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€) sudo apt update sudo apt install -y nfs-kernel-server sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow # ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš” sudo chmod -R 775 /mnt/nfs_share/mlops/airflow ğŸ“„ /etc/exports ì„¤ì • # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥) /mnt/nfs_share/mlops/airflow/logs 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ) /mnt/nfs_share/mlops 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ì ìš© sudo exportfs -rav sudo systemctl restart nfs-kernel-server ğŸ“„ PV\u0026amp;PVC ì„¤ì •\n","keywords":[],"articleBody":"âœ¨ TL;DR ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±ì„ ë„˜ì–´ì„œ, ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€ ì§„í–‰ MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ graph TD %% NFS êµ¬ì¡° subgraph NFS_VM[\"NFS VM\"] NFS[(ğŸ“‚ Logs)] end %% PostgreSQL êµ¬ì¡° subgraph DB_VM[\"PostgreSQL VM\"] airflow_db[(ğŸ—„ï¸ airflow_db)] mlflow_db[(ğŸ—„ï¸ mlflow_db)] end %% AWS êµ¬ì¡° subgraph AWS[\"AWS\"] S3[(ğŸª£ S3 / MLflow_artifacts)] end %% í´ëŸ¬ìŠ¤í„° subgraph K8s_Cluster[\"ğŸ“¦ K8s Cluster\"] Airflow[Airflow Pod] MLflow[MLflow Pod] FastAPI[FastAPI Pod] end %% ì™¸ë¶€ ì—°ë™ Airflow --\u003e NFS Airflow --\u003e airflow_db Airflow --\u003e S3 MLflow --\u003e mlflow_db MLflow --\u003e S3 FastAPI --\u003e S3 FastAPI --\u003e MLflow ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš” êµ¬ì„± ìš”ì†Œ ì„¤ëª… Kubernetes í´ëŸ¬ìŠ¤í„° ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm \u0026 Ingress í™œìš© MLflow ì„œë²„ ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬ Airflow ì„œë²„ DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš© FastAPI ì„œë²„ MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ NFS ì„œë²„ Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸) AWS S3 MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš© PostgreSQL MLflow \u0026 Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨ ğŸ“‚ NFS ì„œë²„ êµ¬ì„± âœ… ì„¤ì¹˜ \u0026 ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€) sudo apt update sudo apt install -y nfs-kernel-server sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow # ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš” sudo chmod -R 775 /mnt/nfs_share/mlops/airflow ğŸ“„ /etc/exports ì„¤ì • # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥) /mnt/nfs_share/mlops/airflow/logs 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ) /mnt/nfs_share/mlops 192.168.18.0/24(rw,sync,no_subtree_check,root_squash) # ì ìš© sudo exportfs -rav sudo systemctl restart nfs-kernel-server ğŸ“„ PV\u0026PVC ì„¤ì •\n# cat airflow-logs-pv.yaml apiVersion: v1 kind: PersistentVolume metadata: name: airflow-logs-pv spec: capacity: storage: 5Gi accessModes: - ReadWriteMany nfs: server: 192.168.18.141 path: /mnt/nfs_share/mlops/airflow/logs persistentVolumeReclaimPolicy: Retain --- apiVersion: v1 kind: PersistentVolumeClaim metadata: name: airflow-logs-pvc namespace: airflow spec: accessModes: - ReadWriteMany resources: requests: storage: 5Gi # ì ìš© kubectl apply -f airflow-logs-pv.yaml ğŸ—„ PostgreSQL ì™¸ë¶€ DB êµ¬ì„± âœ… ì„¤ì¹˜ ë° ì‚¬ìš©ì/DB ìƒì„± sudo apt install postgresql -y sudo -u postgres psql -- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± CREATE DATABASE airflow_db; CREATE DATABASE mlflow_db; -- DBë³„ ì‚¬ìš©ì ìƒì„± CREATE USER airflow_user WITH PASSWORD 'airflow1234'; CREATE USER mlflow_user WITH PASSWORD 'mlflow1234'; -- DBë³„ ê¶Œí•œ ë¶€ì—¬ GRANT ALL PRIVILEGES ON DATABASE airflow_db TO airflow_user; GRANT ALL PRIVILEGES ON DATABASE mlflow_db TO mlflow_user; ğŸ” ì™¸ë¶€ ì ‘ì† í—ˆìš© /etc/postgresql/14/main/postgresql.conf listen_addresses = '*' /etc/postgresql/14/main/pg_hba.conf host airflow_db airflow_user 192.168.18.0/24 scram-sha-256 host mlflow_db mlflow_user 192.168.18.0/24 scram-sha-256 sudo systemctl restart postgresql ğŸª£ S3 ë²„í‚· ì¤€ë¹„ (MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ) âœ… AWS S3 ë²„í‚· ìƒì„± ë²„í‚· ì´ë¦„: mlflow-artifacts-keonho ë¦¬ì „: ap-northeast-2 í¼ë¸”ë¦­ ì°¨ë‹¨ ìœ ì§€, ê¸°ë³¸ ì•”í˜¸í™” ì‚¬ìš© âœ… IAM ì‚¬ìš©ì ìƒì„± ë° ê¶Œí•œ ë¶€ì—¬ ì´ë¦„: mlflow-airflow-user ê¶Œí•œ: AmazonS3FullAccess (ì‹¤ìŠµìš©) AWS_ACCESS_KEY_ID / AWS_SECRET_ACCESS_KEY ì €ì¥ ğŸ§© Tip NFSëŠ” ì—¬ëŸ¬ Podì—ì„œ ë¡œê·¸ë‚˜ íŒŒì¼ì„ ê³µìœ í•´ì•¼ í•  ë•Œ, PVCë¡œ ì—°ê²°í•´ë‘ë©´ ê´€ë¦¬ê°€ ì‰¬ì›€ PostgreSQLì„ ì™¸ë¶€ DBë¡œ ì“°ë©´ Helm chart ë°°í¬ ë•Œ ë‚´ë¶€ DB ì„¤ì •ì„ êº¼ì•¼ í•¨ (enabled: false) AWS S3ëŠ” ë°˜ë“œì‹œ í™˜ê²½ë³€ìˆ˜ ë°©ì‹ ë˜ëŠ” ë§ˆìš´íŠ¸ ë°©ì‹ìœ¼ë¡œ ë³´ì•ˆ ì„¤ì •í•  ê²ƒ (ì‹¤ë¬´ì—ì„œ .aws/credentialsëŠ” ìµœì†Œí™”) ğŸ”§ MLOps ì‹¤ì „ ì—°ê²° êµ¬ì„± ìš”ì†Œ ì‹¤ì „ ì ìš© ì‚¬ë¡€ NFS ì„œë²„ Airflow ë¡œê·¸ ê³µìœ  â†’ DAG ì‹¤íŒ¨ ë¡œê·¸ ë¶„ì„ ê°€ëŠ¥ PostgreSQL ì™¸ë¶€ ì—°ë™ MLflow/Airflow í™•ì¥ ì‹œ DB ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ê³¼ ì—°ê²°ë¨ S3 ì•„í‹°íŒ©íŠ¸ ì €ì¥ ëª¨ë¸ ë²„ì „ ê´€ë¦¬ + ëŒ€ìš©ëŸ‰ ì €ì¥ì†Œ í™œìš© (ëª¨ë¸ ì„œë¹™ ì‹œ URIë¡œ ì ‘ê·¼ ê°€ëŠ¥) ğŸ§­ ë‹¤ìŒ í¬ìŠ¤íŠ¸ ì˜ˆê³  ğŸ” S3 \u0026 PostgreSQL ì—°ë™ì„ ìœ„í•œ ë³´ì•ˆ êµ¬ì„± ë° Secret ê´€ë¦¬\nâ†’ ì‹¤ì œë¡œ AWS í‚¤ì™€ DB URIë¥¼ ì–´ë–»ê²Œ Kubernetes í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê³  ì£¼ì…í•˜ëŠ”ì§€, Helmì—ì„œ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.\n","wordCount":"564","inLanguage":"en","datePublished":"2025-06-23T17:11:47+09:00","dateModified":"2025-06-23T17:11:47+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]</h1><div class=post-meta><span title='2025-06-23 17:11:47 +0900 +0900'>June 23, 2025</span>&nbsp;Â·&nbsp;3 min</div></header><div class=post-content><h2 id=-tldr>âœ¨ TL;DR<a hidden class=anchor aria-hidden=true href=#-tldr>#</a></h2><ul><li><strong>ë‹¨ìˆœí•œ ML íŒŒì´í”„ë¼ì¸ êµ¬ì„±</strong>ì„ ë„˜ì–´ì„œ, <strong>ì¸í”„ë¼ ì„¤ê³„ë¶€í„° êµ¬ì¶•ê¹Œì§€</strong> ì§„í–‰</li><li>MLflow, Airflow, FastAPIë¥¼ ë¡œì»¬ ì¿ ë²„ë„¤í‹°ìŠ¤ ìœ„ì—ì„œ êµ¬ì„±, ì‹¤ë¬´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„/êµ¬í˜„</li><li>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” <strong>MLOps ì¸í”„ë¼ ì „ì²´ êµ¬ì¡°</strong>, ê·¸ë¦¬ê³  ê·¸ ê¸°ë°˜ì´ ë˜ëŠ” NFS ì„œë²„, PostgreSQL, S3 ë²„í‚·, Kubernetes í´ëŸ¬ìŠ¤í„° í™˜ê²½ ê³µìœ </li></ul><hr><h2 id=-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„>ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„<a hidden class=anchor aria-hidden=true href=#-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„>#</a></h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph TD

%% NFS êµ¬ì¡°
subgraph NFS_VM[&#34;NFS VM&#34;]
  NFS[(ğŸ“‚ Logs)]
end

%% PostgreSQL êµ¬ì¡°
subgraph DB_VM[&#34;PostgreSQL VM&#34;]
  airflow_db[(ğŸ—„ï¸ airflow_db)]
  mlflow_db[(ğŸ—„ï¸ mlflow_db)]
end

%% AWS êµ¬ì¡°
subgraph AWS[&#34;AWS&#34;]
  S3[(ğŸª£ S3 / MLflow_artifacts)]
end

%% í´ëŸ¬ìŠ¤í„°
subgraph K8s_Cluster[&#34;ğŸ“¦ K8s Cluster&#34;]
  Airflow[Airflow Pod]
  MLflow[MLflow Pod]
  FastAPI[FastAPI Pod]
end

%% ì™¸ë¶€ ì—°ë™
Airflow --&gt; NFS
Airflow --&gt; airflow_db
Airflow --&gt; S3

MLflow --&gt; mlflow_db
MLflow --&gt; S3

FastAPI --&gt; S3
FastAPI --&gt; MLflow
</code></pre><hr><h2 id=-ì¸í”„ë¼-ì„¤ê³„-ê°œìš”>ğŸ”§ ì¸í”„ë¼ ì„¤ê³„ ê°œìš”<a hidden class=anchor aria-hidden=true href=#-ì¸í”„ë¼-ì„¤ê³„-ê°œìš”>#</a></h2><table><thead><tr><th>êµ¬ì„± ìš”ì†Œ</th><th>ì„¤ëª…</th></tr></thead><tbody><tr><td>Kubernetes í´ëŸ¬ìŠ¤í„°</td><td>ë¡œì»¬ í™˜ê²½ (VMware) ê¸°ë°˜. Helm & Ingress í™œìš©</td></tr><tr><td>MLflow ì„œë²„</td><td>ì™¸ë¶€ PostgreSQL + S3 ì—°ë™. ëª¨ë¸ ë“±ë¡, ì¶”ì , ì•„í‹°íŒ©íŠ¸ ê´€ë¦¬</td></tr><tr><td>Airflow ì„œë²„</td><td>DAG GitSync + S3 ì—°ë™ + PostgreSQL ì™¸ë¶€ DB ì‚¬ìš©</td></tr><tr><td>FastAPI ì„œë²„</td><td>MLflow ëª¨ë¸ í˜¸ì¶œìš© ì˜ˆì¸¡ API. Ingressë¡œ ì™¸ë¶€ ë…¸ì¶œ</td></tr><tr><td>NFS ì„œë²„</td><td>Airflow ë¡œê·¸ ì €ì¥ì†Œë¡œ ì‚¬ìš©. PVCë¡œ ì—°ê²°ë¨ (S3 ê°€ëŠ¥í•˜ì§€ë§Œ, pvc í…ŒìŠ¤íŠ¸)</td></tr><tr><td>AWS S3</td><td>MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í™œìš©</td></tr><tr><td>PostgreSQL</td><td>MLflow & Airflowì˜ metadata ì €ì¥ì†Œ. ì™¸ë¶€ VMì—ì„œ í˜¸ìŠ¤íŒ…ë¨</td></tr></tbody></table><hr><h2 id=-nfs-ì„œë²„-êµ¬ì„±>ğŸ“‚ NFS ì„œë²„ êµ¬ì„±<a hidden class=anchor aria-hidden=true href=#-nfs-ì„œë²„-êµ¬ì„±>#</a></h2><h3 id=-ì„¤ì¹˜--ê³µìœ -ë””ë ‰í† ë¦¬-ìƒì„±-ubuntu-ê¸°ì¤€>âœ… ì„¤ì¹˜ & ê³µìœ  ë””ë ‰í† ë¦¬ ìƒì„± (Ubuntu ê¸°ì¤€)<a hidden class=anchor aria-hidden=true href=#-ì„¤ì¹˜--ê³µìœ -ë””ë ‰í† ë¦¬-ìƒì„±-ubuntu-ê¸°ì¤€>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install -y nfs-kernel-server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo mkdir -p /mnt/nfs_share/mlops/airflow/logs
</span></span><span style=display:flex><span>sudo chown -R 50000:root /mnt/nfs_share/mlops/airflow  <span style=color:#75715e># ì‚¬ìš©í•  ìœ ì € UID, GID í™•ì¸ í•„ìš”</span>
</span></span><span style=display:flex><span>sudo chmod -R <span style=color:#ae81ff>775</span> /mnt/nfs_share/mlops/airflow
</span></span></code></pre></div><h3 id=-etcexports-ì„¤ì •>ğŸ“„ <code>/etc/exports</code> ì„¤ì •<a hidden class=anchor aria-hidden=true href=#-etcexports-ì„¤ì •>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ë§ˆìš´íŠ¸ ìˆ˜ê°€ ì ì€ ê²½ìš° (í”„ë¡œë•ì…˜ í™˜ê²½ ì ìš©ì‹œ root_squash ê¶Œì¥)</span>
</span></span><span style=display:flex><span>/mnt/nfs_share/mlops/airflow/logs  192.168.18.0/24<span style=color:#f92672>(</span>rw,sync,no_subtree_check,root_squash<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ë§ˆìš´íŠ¸ ìˆ˜ê°€ ë§ì€ ê²½ìš° (í•„ìš”ì‹œ)</span>
</span></span><span style=display:flex><span>/mnt/nfs_share/mlops 192.168.18.0/24<span style=color:#f92672>(</span>rw,sync,no_subtree_check,root_squash<span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ì ìš©</span>
</span></span><span style=display:flex><span>sudo exportfs -rav
</span></span><span style=display:flex><span>sudo systemctl restart nfs-kernel-server
</span></span></code></pre></div><p>ğŸ“„ PV&amp;PVC ì„¤ì •</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat airflow-logs-pv.yaml</span>
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: PersistentVolume
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: airflow-logs-pv
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  capacity:
</span></span><span style=display:flex><span>    storage: 5Gi
</span></span><span style=display:flex><span>  accessModes:
</span></span><span style=display:flex><span>    - ReadWriteMany
</span></span><span style=display:flex><span>  nfs:
</span></span><span style=display:flex><span>    server: 192.168.18.141
</span></span><span style=display:flex><span>    path: /mnt/nfs_share/mlops/airflow/logs
</span></span><span style=display:flex><span>  persistentVolumeReclaimPolicy: Retain
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: PersistentVolumeClaim
</span></span><span style=display:flex><span>metadata:
</span></span><span style=display:flex><span>  name: airflow-logs-pvc
</span></span><span style=display:flex><span>  namespace: airflow
</span></span><span style=display:flex><span>spec:
</span></span><span style=display:flex><span>  accessModes:
</span></span><span style=display:flex><span>    - ReadWriteMany
</span></span><span style=display:flex><span>  resources:
</span></span><span style=display:flex><span>    requests:
</span></span><span style=display:flex><span>      storage: 5Gi
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ì ìš©</span>
</span></span><span style=display:flex><span>kubectl apply -f airflow-logs-pv.yaml
</span></span></code></pre></div><hr><h2 id=-postgresql-ì™¸ë¶€-db-êµ¬ì„±>ğŸ—„ PostgreSQL ì™¸ë¶€ DB êµ¬ì„±<a hidden class=anchor aria-hidden=true href=#-postgresql-ì™¸ë¶€-db-êµ¬ì„±>#</a></h2><h3 id=-ì„¤ì¹˜-ë°-ì‚¬ìš©ìdb-ìƒì„±>âœ… ì„¤ì¹˜ ë° ì‚¬ìš©ì/DB ìƒì„±<a hidden class=anchor aria-hidden=true href=#-ì„¤ì¹˜-ë°-ì‚¬ìš©ìdb-ìƒì„±>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install postgresql -y
</span></span><span style=display:flex><span>sudo -u postgres psql
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> airflow_db;
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> mlflow_db;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- DBë³„ ì‚¬ìš©ì ìƒì„±
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> airflow_user <span style=color:#66d9ef>WITH</span> PASSWORD <span style=color:#e6db74>&#39;airflow1234&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> mlflow_user <span style=color:#66d9ef>WITH</span> PASSWORD <span style=color:#e6db74>&#39;mlflow1234&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- DBë³„ ê¶Œí•œ ë¶€ì—¬
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>DATABASE</span> airflow_db <span style=color:#66d9ef>TO</span> airflow_user;
</span></span><span style=display:flex><span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>DATABASE</span> mlflow_db <span style=color:#66d9ef>TO</span> mlflow_user;
</span></span></code></pre></div><h3 id=-ì™¸ë¶€-ì ‘ì†-í—ˆìš©>ğŸ” ì™¸ë¶€ ì ‘ì† í—ˆìš©<a hidden class=anchor aria-hidden=true href=#-ì™¸ë¶€-ì ‘ì†-í—ˆìš©>#</a></h3><ul><li><code>/etc/postgresql/14/main/postgresql.conf</code></li></ul><pre tabindex=0><code>listen_addresses = &#39;*&#39;
</code></pre><ul><li><code>/etc/postgresql/14/main/pg_hba.conf</code></li></ul><pre tabindex=0><code>host    airflow_db     airflow_user     192.168.18.0/24   scram-sha-256
host    mlflow_db      mlflow_user      192.168.18.0/24   scram-sha-256
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl restart postgresql
</span></span></code></pre></div><hr><h2 id=-s3-ë²„í‚·-ì¤€ë¹„-mlflow-ì•„í‹°íŒ©íŠ¸-ì €ì¥ì†Œ>ğŸª£ S3 ë²„í‚· ì¤€ë¹„ (MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ)<a hidden class=anchor aria-hidden=true href=#-s3-ë²„í‚·-ì¤€ë¹„-mlflow-ì•„í‹°íŒ©íŠ¸-ì €ì¥ì†Œ>#</a></h2><h3 id=-aws-s3-ë²„í‚·-ìƒì„±>âœ… AWS S3 ë²„í‚· ìƒì„±<a hidden class=anchor aria-hidden=true href=#-aws-s3-ë²„í‚·-ìƒì„±>#</a></h3><ul><li>ë²„í‚· ì´ë¦„: <code>mlflow-artifacts-keonho</code></li><li>ë¦¬ì „: <code>ap-northeast-2</code></li><li>í¼ë¸”ë¦­ ì°¨ë‹¨ ìœ ì§€, ê¸°ë³¸ ì•”í˜¸í™” ì‚¬ìš©</li></ul><h3 id=-iam-ì‚¬ìš©ì-ìƒì„±-ë°-ê¶Œí•œ-ë¶€ì—¬>âœ… IAM ì‚¬ìš©ì ìƒì„± ë° ê¶Œí•œ ë¶€ì—¬<a hidden class=anchor aria-hidden=true href=#-iam-ì‚¬ìš©ì-ìƒì„±-ë°-ê¶Œí•œ-ë¶€ì—¬>#</a></h3><ul><li>ì´ë¦„: <code>mlflow-airflow-user</code></li><li>ê¶Œí•œ: <code>AmazonS3FullAccess</code> (ì‹¤ìŠµìš©)</li><li><code>AWS_ACCESS_KEY_ID</code> / <code>AWS_SECRET_ACCESS_KEY</code> ì €ì¥</li></ul><hr><h2 id=-tip>ğŸ§© Tip<a hidden class=anchor aria-hidden=true href=#-tip>#</a></h2><ul><li><code>NFS</code>ëŠ” ì—¬ëŸ¬ Podì—ì„œ ë¡œê·¸ë‚˜ íŒŒì¼ì„ ê³µìœ í•´ì•¼ í•  ë•Œ, PVCë¡œ ì—°ê²°í•´ë‘ë©´ ê´€ë¦¬ê°€ ì‰¬ì›€</li><li><code>PostgreSQL</code>ì„ ì™¸ë¶€ DBë¡œ ì“°ë©´ Helm chart ë°°í¬ ë•Œ ë‚´ë¶€ DB ì„¤ì •ì„ êº¼ì•¼ í•¨ (<code>enabled: false</code>)</li><li><code>AWS S3</code>ëŠ” ë°˜ë“œì‹œ <strong>í™˜ê²½ë³€ìˆ˜ ë°©ì‹</strong> ë˜ëŠ” <strong>ë§ˆìš´íŠ¸ ë°©ì‹</strong>ìœ¼ë¡œ ë³´ì•ˆ ì„¤ì •í•  ê²ƒ (ì‹¤ë¬´ì—ì„œ <code>.aws/credentials</code>ëŠ” ìµœì†Œí™”)</li></ul><hr><h2 id=-mlops-ì‹¤ì „-ì—°ê²°>ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°<a hidden class=anchor aria-hidden=true href=#-mlops-ì‹¤ì „-ì—°ê²°>#</a></h2><table><thead><tr><th>êµ¬ì„± ìš”ì†Œ</th><th>ì‹¤ì „ ì ìš© ì‚¬ë¡€</th></tr></thead><tbody><tr><td>NFS ì„œë²„</td><td>Airflow ë¡œê·¸ ê³µìœ  â†’ DAG ì‹¤íŒ¨ ë¡œê·¸ ë¶„ì„ ê°€ëŠ¥</td></tr><tr><td>PostgreSQL ì™¸ë¶€ ì—°ë™</td><td>MLflow/Airflow í™•ì¥ ì‹œ <strong>DB ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§</strong>ê³¼ ì—°ê²°ë¨</td></tr><tr><td>S3 ì•„í‹°íŒ©íŠ¸ ì €ì¥</td><td>ëª¨ë¸ ë²„ì „ ê´€ë¦¬ + ëŒ€ìš©ëŸ‰ ì €ì¥ì†Œ í™œìš© (ëª¨ë¸ ì„œë¹™ ì‹œ URIë¡œ ì ‘ê·¼ ê°€ëŠ¥)</td></tr></tbody></table><hr><h2 id=-ë‹¤ìŒ-í¬ìŠ¤íŠ¸-ì˜ˆê³ >ğŸ§­ ë‹¤ìŒ í¬ìŠ¤íŠ¸ ì˜ˆê³ <a hidden class=anchor aria-hidden=true href=#-ë‹¤ìŒ-í¬ìŠ¤íŠ¸-ì˜ˆê³ >#</a></h2><blockquote><p>ğŸ” S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ ë³´ì•ˆ êµ¬ì„± ë° Secret ê´€ë¦¬</p><p>â†’ ì‹¤ì œë¡œ AWS í‚¤ì™€ DB URIë¥¼ ì–´ë–»ê²Œ Kubernetes í™˜ê²½ì—ì„œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬í•˜ê³  ì£¼ì…í•˜ëŠ”ì§€, Helmì—ì„œ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/><span class=title>Â« Prev</span><br><span>[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ ë³´ì•ˆ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]</span>
</a><a class=next href=https://keonhoban.github.io/mlops-journey/posts/troubleshoot/01/><span class=title>Next Â»</span><br><span>[TS] Airflow ê¸°ì´ˆ ìë™í™” - Airflow â†’ MLflow â†’ FastAPI</span></a></nav></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>