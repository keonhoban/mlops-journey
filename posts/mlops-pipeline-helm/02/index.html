<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content="âœ¨ TL;DR

ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜
Kubernetesì—ì„œëŠ” Secretê³¼ ConfigMap, ê·¸ë¦¬ê³  envFrom, volumeMount ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 & PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ Secret êµ¬ì„± ì „ëµê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ 


ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„


ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€?

  
      
          í•­ëª©
          ì´ìœ 
      
  
  
      
          AWS Access Key
          ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ
      
      
          PostgreSQL ì ‘ì† URI
          ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜
      
      
          MLflow Tracking URI
          ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥
      
  


âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨"><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]"><meta property="og:description" content="âœ¨ TL;DR ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜ Kubernetesì—ì„œëŠ” Secretê³¼ ConfigMap, ê·¸ë¦¬ê³  envFrom, volumeMount ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 & PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ Secret êµ¬ì„± ì „ëµê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€? í•­ëª© ì´ìœ  AWS Access Key ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ PostgreSQL ì ‘ì† URI ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜ MLflow Tracking URI ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥ âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨"><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-26T17:11:49+09:00"><meta property="article:modified_time" content="2025-06-26T17:11:49+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]"><meta name=twitter:description content="âœ¨ TL;DR

ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜
Kubernetesì—ì„œëŠ” Secretê³¼ ConfigMap, ê·¸ë¦¬ê³  envFrom, volumeMount ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 & PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ Secret êµ¬ì„± ì „ëµê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ 


ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„


ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€?

  
      
          í•­ëª©
          ì´ìœ 
      
  
  
      
          AWS Access Key
          ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ
      
      
          PostgreSQL ì ‘ì† URI
          ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜
      
      
          MLflow Tracking URI
          ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥
      
  


âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://keonhoban.github.io/mlops-journey/posts/"},{"@type":"ListItem","position":2,"name":"[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 \u0026 PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]","item":"https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 \u0026 PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]","name":"[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 \u0026 PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]","description":"âœ¨ TL;DR ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜ Kubernetesì—ì„œëŠ” Secretê³¼ ConfigMap, ê·¸ë¦¬ê³  envFrom, volumeMount ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 \u0026amp; PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ Secret êµ¬ì„± ì „ëµê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€? í•­ëª© ì´ìœ  AWS Access Key ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ PostgreSQL ì ‘ì† URI ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜ MLflow Tracking URI ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥ âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨\n","keywords":[],"articleBody":"âœ¨ TL;DR ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜ Kubernetesì—ì„œëŠ” Secretê³¼ ConfigMap, ê·¸ë¦¬ê³  envFrom, volumeMount ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 \u0026 PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ Secret êµ¬ì„± ì „ëµê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ  ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„ ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€? í•­ëª© ì´ìœ  AWS Access Key ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ PostgreSQL ì ‘ì† URI ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜ MLflow Tracking URI ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥ âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨\në¶€ë“ì´í•˜ê²Œ gitì— ì—…ë¡œë“œí•´ì•¼í•  ê²½ìš° SealedSecret ë˜ëŠ” SOPS ì‚¬ìš©í•´ ì•”í˜¸í™” ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ .gitignore ë“±ìœ¼ë¡œ ì•„ì˜ˆ ì œì™¸í•˜ëŠ” ë°©ë²•ë„ ê°€ëŠ¥ ğŸ“¦ S3 ì¸ì¦ ì •ë³´ ì²˜ë¦¬ ì „ëµ ğŸ”¸ ì‹¤ìŠµ í™˜ê²½ ì¡°ê±´ MLflow, FastAPI, Airflowì—ì„œ ëª¨ë‘ boto3ë¡œ S3ì— ì ‘ê·¼í•´ì•¼ í•¨ FastAPIëŠ” env ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬, AirflowëŠ” volumeMount ë°©ì‹ì´ ì•ˆì •ì ì„ âœ… Secret ìƒì„± (env ë°©ì‹ - MLflow \u0026 FastAPI) kubectl create secret generic aws-credentials-secret \\ --from-literal=AWS_ACCESS_KEY_ID=your-access-key \\ --from-literal=AWS_SECRET_ACCESS_KEY=your-secret-key \\ --from-literal=MLFLOW_S3_ENDPOINT_URL=https://s3.ap-northeast-2.amazonaws.com \\ -n mlflow ğŸ” envFrom.secretRefë¡œ ì‚¬ìš©í•˜ë©´ í™˜ê²½ë³€ìˆ˜ë¡œ ë°”ë¡œ ì£¼ì…ë¨ â†’ boto3ê°€ ìë™ ì¸ì‹\nenvFrom: - secretRef: name: aws-credentials-secret âœ… Secret ìƒì„± (volumeMount ë°©ì‹ - Airflow ì „ìš©) # .aws/credentials íŒŒì¼ ì˜ˆì‹œ [default] aws_access_key_id = your-access-key aws_secret_access_key = your-secret-key region = ap-northeast-2 kubectl create secret generic aws-credentials-secret \\ --from-file=credentials=.aws/credentials \\ -n airflow AirflowëŠ” Taskë§ˆë‹¤ ìƒˆ Podê°€ ëœ¨ê³  mlflow ì™€ S3 ì—°ë™ì‹œ boto3 ì‚¬ìš© ë”°ë¼ì„œ, AWS EKSê°€ ì•„ë‹Œ ë¡œì»¬ k8s í™˜ê²½êµ¬ì¡°ìƒ .aws ê²½ë¡œ ë§ˆìš´íŠ¸ ë°©ì‹ì´ ì•ˆì •ì \nextraVolumes: - name: aws-credentials secret: secretName: aws-credentials-secret extraVolumeMounts: - name: aws-credentials mountPath: /home/airflow/.aws readOnly: true ğŸ—„ PostgreSQL ì ‘ì† ì •ë³´ ê´€ë¦¬ ì „ëµ ğŸ”¸ ëª©í‘œ Helm ì°¨íŠ¸ ë‚´ë¶€ì—ì„œ backend-store-uri í˜¹ì€ sql_alchemy_conn ê°’ì„ ì§ì ‘ ë„£ì§€ ì•ŠìŒ ëŒ€ì‹  Secretì´ë‚˜ ConfigMapìœ¼ë¡œ êµ¬ì„± ìš”ì†Œ ë¶„ë¦¬ ğŸ” 1. MLflow ì ‘ì† ì •ë³´ êµ¬ì„± (ğŸ”€ Secret + ConfigMap ë¶„ë¦¬ ë°©ì‹) ëª©í‘œ: ì‹¤í—˜ metadata ì €ì¥ì†Œ(PostgreSQL)ì— ëŒ€í•œ ì•ˆì „í•œ ì—°ê²° ì„¤ì •\nğŸ§± ì‹œí¬ë¦¿ \u0026 ì„¤ì • ë¶„ë¦¬ ë°©ì‹ # 1-1. Secret: ì¸ì¦ ì •ë³´ (username/password) kubectl create secret generic mlflow-db-secret \\ --from-literal=username=mlflow_user \\ --from-literal=password=mlflow1234 \\ -n mlflow # 1-2. ConfigMap: ì¼ë°˜ ì •ë³´ (host/port/dbname) kubectl create configmap mlflow-db-config \\ --from-literal=host=192.168.18.142 \\ --from-literal=port=5432 \\ --from-literal=dbname=mlflow_db \\ -n mlflow ğŸ“¦ Helm chartì—ì„œ env.valueFromìœ¼ë¡œ ì¡°í•©í•˜ì—¬ ì£¼ì… ê°€ëŠ¥\n- name: DB_USER valueFrom: secretKeyRef: name: mlflow-db-secret key: username - name: DB_PASSWORD valueFrom: secretKeyRef: name: mlflow-db-secret key: password - name: DB_HOST valueFrom: configMapKeyRef: name: mlflow-db-config key: host - name: DB_PORT valueFrom: configMapKeyRef: name: mlflow-db-config key: port - name: DB_NAME valueFrom: configMapKeyRef: name: mlflow-db-config key: dbname ğŸ” 2. Airflow ì ‘ì† ì •ë³´ êµ¬ì„± (ğŸ§© í†µí•© URI ë°©ì‹) ëª©í‘œ: Airflow ë©”íƒ€ DB(PostgreSQL) URIë¥¼ ë‹¨ì¼ ë¬¸ìì—´ë¡œ ê´€ë¦¬\nkubectl create secret generic airflow-db-secret \\ --from-literal=connection=\"postgresql://airflow_user:airflow1234@192.168.18.142:5432/airflow_db\" \\ -n airflow ğŸ“¦ Helm values.yamlì—ì„œ metadataSecretName ìœ¼ë¡œ ì°¸ì¡°\ndata: metadataSecretName: airflow-db-secret â†’ ë‚´ë¶€ì ìœ¼ë¡œ AIRFLOW__DATABASE__SQL_ALCHEMY_CONN í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì •ë¨\nğŸ”„ Secret ë°©ì‹ ì •ë¦¬ ë¹„êµ ë°©ì‹ ëŒ€ìƒ ì¥ì  ë‹¨ì  envFrom.secretRef MLflow, FastAPI ê¹”ë”í•˜ê³  ê°€ë…ì„± ì¢‹ìŒ Airflowì—ì„œëŠ” ì‹¤íŒ¨ ê°€ëŠ¥ì„± ì¡´ì¬ .aws ë§ˆìš´íŠ¸ Airflow Task Podì—ì„œë„ ì•ˆì •ì  ê²½ë¡œ êµ¬ì¡° ëª…í™•íˆ ë§ì¶°ì•¼ í•¨ (boto3 ëŒ€ë¹„) base64 Secret DB URI, ë¯¼ê°í•œ í‚¤ Helmì—ì„œ ê¹”ë”íˆ ê´€ë¦¬ Gitì— ì˜¬ë¦¬ë©´ ì•”í˜¸í™” ì—†ì´ ë…¸ì¶œë¨ (ì£¼ì˜) ğŸ§© ì‹¤ë¬´ íŒ kubectl create secret í›„ì—ëŠ” ë°˜ë“œì‹œ kubectl describe secret ë˜ëŠ” env ëª…ë ¹ì–´ë¡œ ì‹¤ì œ ì£¼ì… ì—¬ë¶€ë¥¼ í™•ì¸í•  ê²ƒ ë¯¼ê°í•œ í‚¤ê°€ ë‹´ê¸´ .aws/credentials, values.yaml íŒŒì¼ì€ .gitignoreì— í¬í•¨í•˜ê³  ì‘ì—… ì™„ë£Œ í›„ ì‚­ì œ ì‹¤ë¬´ì—ì„œëŠ” SealedSecret, SOPS, External Secrets Operator ë“±ì„ ì´ìš©í•œ ì•”í˜¸í™” ì—°ë™ ê³ ë ¤í•´ì•¼ í•¨ ğŸ”§ MLOps ì‹¤ì „ ì—°ê²° ì—°ê²° ëŒ€ìƒ ì‹¤ì „ì—ì„œì˜ ì˜ë¯¸ S3 + MLflow ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í•„ìˆ˜. ì¸ì¦ ì‹¤íŒ¨ ì‹œ ì‹¤í—˜/ëª¨ë¸ ë¡œê¹… ì „ë¶€ ì‹¤íŒ¨ S3 + Airflow S3 ë²„í‚·ì—ì„œ Data Load, Export ì‘ì—… ìˆ˜í–‰ DB URI + MLflow/Airflow backend-store-uri ì„¤ì • ì‹¤íŒ¨ ì‹œ ì „ì²´ ì„œë¹„ìŠ¤ ë¡œë”© ì‹¤íŒ¨ ë°œìƒ ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì˜ˆì‹œ ğŸ”» TS_01: Airflow DAG Taskì—ì„œ boto3 ì¸ì¦ ì‹¤íŒ¨ ì¦ìƒ ì›ì¸ í•´ê²° botocore.exceptions.NoCredentialsError env ë°©ì‹ìœ¼ë¡œ ì£¼ì…í–ˆì§€ë§Œ Task Podì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ .aws/credentials ê²½ë¡œë¡œ ë§ˆìš´íŠ¸ ë°©ì‹ ì‚¬ìš©í•´ì•¼ í•¨ ğŸ§­ ë‹¤ìŒ í¬ìŠ¤íŠ¸ ì˜ˆê³  ğŸ“¦ MLflow ì‹¤ì „ ë°°í¬: PostgreSQL + S3 ì—°ë™, Helm êµ¬ì„±, ì»¤ìŠ¤í…€ ì´ë¯¸ì§€, Ingress êµ¬ì„±ê¹Œì§€\nâ†’ MLflowë¥¼ Helmìœ¼ë¡œ ì™„ì „í•˜ê²Œ ë°°í¬í•˜ëŠ” ê³¼ì •ì„ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.\n","wordCount":"621","inLanguage":"en","datePublished":"2025-06-26T17:11:49+09:00","dateModified":"2025-06-26T17:11:49+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/02/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[MLOps í”Œë«í¼ êµ¬ì¶• - 2ë‹¨ê³„: S3 & PostgreSQL ì—°ë™ì„ ìœ„í•œ êµ¬ì„± ë° Secret ê´€ë¦¬ ì „ëµ]</h1><div class=post-meta><span title='2025-06-26 17:11:49 +0900 +0900'>June 26, 2025</span>&nbsp;Â·&nbsp;3 min</div></header><div class=post-content><h2 id=-tldr>âœ¨ TL;DR<a hidden class=anchor aria-hidden=true href=#-tldr>#</a></h2><ul><li>ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(AWS S3, DB ë“±)ì™€ ì—°ê²°í•  ë•Œ, ì¸ì¦ ì •ë³´ë¥¼ ì§ì ‘ ì½”ë“œë‚˜ YAMLì— ë…¸ì¶œí•˜ëŠ” ê±´ ë³´ì•ˆìƒ ìœ„í—˜</li><li>Kubernetesì—ì„œëŠ” <code>Secret</code>ê³¼ <code>ConfigMap</code>, ê·¸ë¦¬ê³  <code>envFrom</code>, <code>volumeMount</code> ë°©ì‹ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥</li><li>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” MLflow, Airflow, FastAPIì™€ AWS S3 & PostgreSQLì„ ì—°ë™í•  ë•Œ ì‚¬ìš©í•œ <strong>Secret êµ¬ì„± ì „ëµ</strong>ê³¼ ë§ˆì£¼ì¹œ ì´ìŠˆ ë° í•´ê²°ì±… ê³µìœ </li></ul><hr><h2 id=-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„>ğŸ§± ì•„í‚¤í…ì²˜ êµ¬ì„±ë„<a hidden class=anchor aria-hidden=true href=#-ì•„í‚¤í…ì²˜-êµ¬ì„±ë„>#</a></h2><p><img alt=02 loading=lazy src=/mlops-journey/images/02.png></p><hr><h2 id=-ì™œ-secret-ì²˜ë¦¬ê°€-ì¤‘ìš”í•œê°€>ğŸ” ì™œ Secret ì²˜ë¦¬ê°€ ì¤‘ìš”í•œê°€?<a hidden class=anchor aria-hidden=true href=#-ì™œ-secret-ì²˜ë¦¬ê°€-ì¤‘ìš”í•œê°€>#</a></h2><table><thead><tr><th>í•­ëª©</th><th>ì´ìœ </th></tr></thead><tbody><tr><td>AWS Access Key</td><td>ë…¸ì¶œ ì‹œ ë°ì´í„° ì‚­ì œ/íƒˆì·¨ ìœ„í—˜ ìˆìŒ</td></tr><tr><td>PostgreSQL ì ‘ì† URI</td><td>ë‚´ë¶€ë§ DB êµ¬ì¡° ë…¸ì¶œ + Credential ìœ ì¶œ ìœ„í—˜</td></tr><tr><td>MLflow Tracking URI</td><td>ë‚´ë¶€ ì‹œìŠ¤í…œ êµ¬ì¡° ë…¸ì¶œ ê°€ëŠ¥</td></tr></tbody></table><blockquote><p>âœ… ì‹¤ë¬´ì—ì„  ë°˜ë“œì‹œ ì¸ì¦ì •ë³´ë¥¼ Gitì— ë…¸ì¶œí•˜ì§€ ì•Šê³ , í™˜ê²½ì— ì•ˆì „í•˜ê²Œ ì£¼ì…í•  ìˆ˜ ìˆì–´ì•¼ í•¨</p></blockquote><ul><li>ë¶€ë“ì´í•˜ê²Œ gitì— ì—…ë¡œë“œí•´ì•¼í•  ê²½ìš° SealedSecret ë˜ëŠ” SOPS ì‚¬ìš©í•´ ì•”í˜¸í™” ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ<ul><li>.gitignore ë“±ìœ¼ë¡œ ì•„ì˜ˆ ì œì™¸í•˜ëŠ” ë°©ë²•ë„ ê°€ëŠ¥</li></ul></li></ul><hr><h2 id=-s3-ì¸ì¦-ì •ë³´-ì²˜ë¦¬-ì „ëµ>ğŸ“¦ S3 ì¸ì¦ ì •ë³´ ì²˜ë¦¬ ì „ëµ<a hidden class=anchor aria-hidden=true href=#-s3-ì¸ì¦-ì •ë³´-ì²˜ë¦¬-ì „ëµ>#</a></h2><h3 id=-ì‹¤ìŠµ-í™˜ê²½-ì¡°ê±´>ğŸ”¸ ì‹¤ìŠµ í™˜ê²½ ì¡°ê±´<a hidden class=anchor aria-hidden=true href=#-ì‹¤ìŠµ-í™˜ê²½-ì¡°ê±´>#</a></h3><ul><li>MLflow, FastAPI, Airflowì—ì„œ ëª¨ë‘ <code>boto3</code>ë¡œ S3ì— ì ‘ê·¼í•´ì•¼ í•¨</li><li>FastAPIëŠ” <code>env</code> ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬, AirflowëŠ” <code>volumeMount</code> ë°©ì‹ì´ ì•ˆì •ì ì„</li></ul><hr><h3 id=-secret-ìƒì„±-env-ë°©ì‹---mlflow--fastapi>âœ… Secret ìƒì„± (env ë°©ì‹ - MLflow & FastAPI)<a hidden class=anchor aria-hidden=true href=#-secret-ìƒì„±-env-ë°©ì‹---mlflow--fastapi>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create secret generic aws-credentials-secret <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>AWS_ACCESS_KEY_ID<span style=color:#f92672>=</span>your-access-key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>AWS_SECRET_ACCESS_KEY<span style=color:#f92672>=</span>your-secret-key <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>MLFLOW_S3_ENDPOINT_URL<span style=color:#f92672>=</span>https://s3.ap-northeast-2.amazonaws.com <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n mlflow
</span></span></code></pre></div><blockquote><p>ğŸ” envFrom.secretRefë¡œ ì‚¬ìš©í•˜ë©´ í™˜ê²½ë³€ìˆ˜ë¡œ ë°”ë¡œ ì£¼ì…ë¨ â†’ boto3ê°€ ìë™ ì¸ì‹</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>envFrom</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>secretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws-credentials-secret</span>
</span></span></code></pre></div><hr><h3 id=-secret-ìƒì„±-volumemount-ë°©ì‹---airflow-ì „ìš©>âœ… Secret ìƒì„± (volumeMount ë°©ì‹ - Airflow ì „ìš©)<a hidden class=anchor aria-hidden=true href=#-secret-ìƒì„±-volumemount-ë°©ì‹---airflow-ì „ìš©>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># .aws/credentials íŒŒì¼ ì˜ˆì‹œ</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>default<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>aws_access_key_id <span style=color:#f92672>=</span> your-access-key
</span></span><span style=display:flex><span>aws_secret_access_key <span style=color:#f92672>=</span> your-secret-key
</span></span><span style=display:flex><span>region <span style=color:#f92672>=</span> ap-northeast-2
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create secret generic aws-credentials-secret <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-file<span style=color:#f92672>=</span>credentials<span style=color:#f92672>=</span>.aws/credentials <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n airflow
</span></span></code></pre></div><blockquote><p>AirflowëŠ” Taskë§ˆë‹¤ ìƒˆ Podê°€ ëœ¨ê³  mlflow ì™€ S3 ì—°ë™ì‹œ boto3 ì‚¬ìš©
ë”°ë¼ì„œ, AWS EKSê°€ ì•„ë‹Œ ë¡œì»¬ k8s í™˜ê²½êµ¬ì¡°ìƒ .aws ê²½ë¡œ ë§ˆìš´íŠ¸ ë°©ì‹ì´ ì•ˆì •ì </p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>extraVolumes</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws-credentials</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>secret</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>aws-credentials-secret</span>
</span></span><span style=display:flex><span><span style=color:#f92672>extraVolumeMounts</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>aws-credentials</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/home/airflow/.aws</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>readOnly</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><hr><h2 id=-postgresql-ì ‘ì†-ì •ë³´-ê´€ë¦¬-ì „ëµ>ğŸ—„ PostgreSQL ì ‘ì† ì •ë³´ ê´€ë¦¬ ì „ëµ<a hidden class=anchor aria-hidden=true href=#-postgresql-ì ‘ì†-ì •ë³´-ê´€ë¦¬-ì „ëµ>#</a></h2><h3 id=-ëª©í‘œ>ğŸ”¸ ëª©í‘œ<a hidden class=anchor aria-hidden=true href=#-ëª©í‘œ>#</a></h3><ul><li>Helm ì°¨íŠ¸ ë‚´ë¶€ì—ì„œ <code>backend-store-uri</code> í˜¹ì€ <code>sql_alchemy_conn</code> ê°’ì„ ì§ì ‘ ë„£ì§€ ì•ŠìŒ</li><li>ëŒ€ì‹  <code>Secret</code>ì´ë‚˜ <code>ConfigMap</code>ìœ¼ë¡œ êµ¬ì„± ìš”ì†Œ ë¶„ë¦¬</li></ul><hr><h2 id=-1-mlflow-ì ‘ì†-ì •ë³´-êµ¬ì„±--secret--configmap-ë¶„ë¦¬-ë°©ì‹>ğŸ” 1. MLflow ì ‘ì† ì •ë³´ êµ¬ì„± (ğŸ”€ Secret + ConfigMap ë¶„ë¦¬ ë°©ì‹)<a hidden class=anchor aria-hidden=true href=#-1-mlflow-ì ‘ì†-ì •ë³´-êµ¬ì„±--secret--configmap-ë¶„ë¦¬-ë°©ì‹>#</a></h2><blockquote><p>ëª©í‘œ: ì‹¤í—˜ metadata ì €ì¥ì†Œ(PostgreSQL)ì— ëŒ€í•œ ì•ˆì „í•œ ì—°ê²° ì„¤ì •</p></blockquote><h3 id=-ì‹œí¬ë¦¿--ì„¤ì •-ë¶„ë¦¬-ë°©ì‹>ğŸ§± ì‹œí¬ë¦¿ & ì„¤ì • ë¶„ë¦¬ ë°©ì‹<a hidden class=anchor aria-hidden=true href=#-ì‹œí¬ë¦¿--ì„¤ì •-ë¶„ë¦¬-ë°©ì‹>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 1-1. Secret: ì¸ì¦ ì •ë³´ (username/password)</span>
</span></span><span style=display:flex><span>kubectl create secret generic mlflow-db-secret <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>username<span style=color:#f92672>=</span>mlflow_user <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>password<span style=color:#f92672>=</span>mlflow1234 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n mlflow
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1-2. ConfigMap: ì¼ë°˜ ì •ë³´ (host/port/dbname)</span>
</span></span><span style=display:flex><span>kubectl create configmap mlflow-db-config <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>host<span style=color:#f92672>=</span>192.168.18.142 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>port<span style=color:#f92672>=</span><span style=color:#ae81ff>5432</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>dbname<span style=color:#f92672>=</span>mlflow_db <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n mlflow
</span></span></code></pre></div><blockquote><p>ğŸ“¦ Helm chartì—ì„œ env.valueFromìœ¼ë¡œ ì¡°í•©í•˜ì—¬ ì£¼ì… ê°€ëŠ¥</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DB_USER</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>mlflow-db-secret</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>username</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DB_PASSWORD</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>mlflow-db-secret</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>password</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DB_HOST</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>configMapKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>mlflow-db-config</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>host</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DB_PORT</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>configMapKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>mlflow-db-config</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>port</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>DB_NAME</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>configMapKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>mlflow-db-config</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>dbname</span>
</span></span></code></pre></div><hr><h2 id=-2-airflow-ì ‘ì†-ì •ë³´-êµ¬ì„±--í†µí•©-uri-ë°©ì‹>ğŸ” 2. Airflow ì ‘ì† ì •ë³´ êµ¬ì„± (ğŸ§© í†µí•© URI ë°©ì‹)<a hidden class=anchor aria-hidden=true href=#-2-airflow-ì ‘ì†-ì •ë³´-êµ¬ì„±--í†µí•©-uri-ë°©ì‹>#</a></h2><blockquote><p>ëª©í‘œ: Airflow ë©”íƒ€ DB(PostgreSQL) URIë¥¼ ë‹¨ì¼ ë¬¸ìì—´ë¡œ ê´€ë¦¬</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl create secret generic airflow-db-secret <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --from-literal<span style=color:#f92672>=</span>connection<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;postgresql://airflow_user:airflow1234@192.168.18.142:5432/airflow_db&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -n airflow
</span></span></code></pre></div><blockquote><p>ğŸ“¦ Helm values.yamlì—ì„œ metadataSecretName ìœ¼ë¡œ ì°¸ì¡°</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>data</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadataSecretName</span>: <span style=color:#ae81ff>airflow-db-secret</span>
</span></span></code></pre></div><p>â†’ ë‚´ë¶€ì ìœ¼ë¡œ <code>AIRFLOW__DATABASE__SQL_ALCHEMY_CONN</code> í™˜ê²½ë³€ìˆ˜ë¡œ ì„¤ì •ë¨</p><hr><h2 id=-secret-ë°©ì‹-ì •ë¦¬-ë¹„êµ>ğŸ”„ Secret ë°©ì‹ ì •ë¦¬ ë¹„êµ<a hidden class=anchor aria-hidden=true href=#-secret-ë°©ì‹-ì •ë¦¬-ë¹„êµ>#</a></h2><table><thead><tr><th>ë°©ì‹</th><th>ëŒ€ìƒ</th><th>ì¥ì </th><th>ë‹¨ì </th></tr></thead><tbody><tr><td><code>envFrom.secretRef</code></td><td>MLflow, FastAPI</td><td>ê¹”ë”í•˜ê³  ê°€ë…ì„± ì¢‹ìŒ</td><td>Airflowì—ì„œëŠ” ì‹¤íŒ¨ ê°€ëŠ¥ì„± ì¡´ì¬</td></tr><tr><td><code>.aws</code> ë§ˆìš´íŠ¸</td><td>Airflow</td><td>Task Podì—ì„œë„ ì•ˆì •ì </td><td>ê²½ë¡œ êµ¬ì¡° ëª…í™•íˆ ë§ì¶°ì•¼ í•¨ (boto3 ëŒ€ë¹„)</td></tr><tr><td>base64 <code>Secret</code></td><td>DB URI, ë¯¼ê°í•œ í‚¤</td><td>Helmì—ì„œ ê¹”ë”íˆ ê´€ë¦¬</td><td>Gitì— ì˜¬ë¦¬ë©´ ì•”í˜¸í™” ì—†ì´ ë…¸ì¶œë¨ (ì£¼ì˜)</td></tr></tbody></table><hr><h2 id=-ì‹¤ë¬´-íŒ>ğŸ§© ì‹¤ë¬´ íŒ<a hidden class=anchor aria-hidden=true href=#-ì‹¤ë¬´-íŒ>#</a></h2><ul><li><code>kubectl create secret</code> í›„ì—ëŠ” ë°˜ë“œì‹œ <code>kubectl describe secret</code> ë˜ëŠ” <code>env</code> ëª…ë ¹ì–´ë¡œ ì‹¤ì œ ì£¼ì… ì—¬ë¶€ë¥¼ í™•ì¸í•  ê²ƒ</li><li>ë¯¼ê°í•œ í‚¤ê°€ ë‹´ê¸´ <code>.aws/credentials</code>, <code>values.yaml</code> íŒŒì¼ì€ <code>.gitignore</code>ì— í¬í•¨í•˜ê³  ì‘ì—… ì™„ë£Œ í›„ ì‚­ì œ</li><li>ì‹¤ë¬´ì—ì„œëŠ” <strong>SealedSecret</strong>, <strong>SOPS</strong>, <strong>External Secrets Operator</strong> ë“±ì„ ì´ìš©í•œ ì•”í˜¸í™” ì—°ë™ ê³ ë ¤í•´ì•¼ í•¨</li></ul><hr><h2 id=-mlops-ì‹¤ì „-ì—°ê²°>ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°<a hidden class=anchor aria-hidden=true href=#-mlops-ì‹¤ì „-ì—°ê²°>#</a></h2><table><thead><tr><th>ì—°ê²° ëŒ€ìƒ</th><th>ì‹¤ì „ì—ì„œì˜ ì˜ë¯¸</th></tr></thead><tbody><tr><td>S3 + MLflow</td><td>ëª¨ë¸ ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œë¡œ í•„ìˆ˜. ì¸ì¦ ì‹¤íŒ¨ ì‹œ ì‹¤í—˜/ëª¨ë¸ ë¡œê¹… ì „ë¶€ ì‹¤íŒ¨</td></tr><tr><td>S3 + Airflow</td><td>S3 ë²„í‚·ì—ì„œ Data Load, Export ì‘ì—… ìˆ˜í–‰</td></tr><tr><td>DB URI + MLflow/Airflow</td><td><code>backend-store-uri</code> ì„¤ì • ì‹¤íŒ¨ ì‹œ ì „ì²´ ì„œë¹„ìŠ¤ ë¡œë”© ì‹¤íŒ¨ ë°œìƒ</td></tr></tbody></table><hr><h2 id=-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ì˜ˆì‹œ>ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì˜ˆì‹œ<a hidden class=anchor aria-hidden=true href=#-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…-ì˜ˆì‹œ>#</a></h2><h3 id=-ts_01-airflow-dag-taskì—ì„œ-boto3-ì¸ì¦-ì‹¤íŒ¨>ğŸ”» TS_01: Airflow DAG Taskì—ì„œ <code>boto3</code> ì¸ì¦ ì‹¤íŒ¨<a hidden class=anchor aria-hidden=true href=#-ts_01-airflow-dag-taskì—ì„œ-boto3-ì¸ì¦-ì‹¤íŒ¨>#</a></h3><table><thead><tr><th>ì¦ìƒ</th><th>ì›ì¸</th><th>í•´ê²°</th></tr></thead><tbody><tr><td><code>botocore.exceptions.NoCredentialsError</code></td><td><code>env</code> ë°©ì‹ìœ¼ë¡œ ì£¼ì…í–ˆì§€ë§Œ Task Podì—ëŠ” ì ìš©ë˜ì§€ ì•ŠìŒ</td><td><code>.aws/credentials</code> ê²½ë¡œë¡œ ë§ˆìš´íŠ¸ ë°©ì‹ ì‚¬ìš©í•´ì•¼ í•¨</td></tr></tbody></table><hr><h2 id=-ë‹¤ìŒ-í¬ìŠ¤íŠ¸-ì˜ˆê³ >ğŸ§­ ë‹¤ìŒ í¬ìŠ¤íŠ¸ ì˜ˆê³ <a hidden class=anchor aria-hidden=true href=#-ë‹¤ìŒ-í¬ìŠ¤íŠ¸-ì˜ˆê³ >#</a></h2><blockquote><p>ğŸ“¦ MLflow ì‹¤ì „ ë°°í¬: PostgreSQL + S3 ì—°ë™, Helm êµ¬ì„±, ì»¤ìŠ¤í…€ ì´ë¯¸ì§€, Ingress êµ¬ì„±ê¹Œì§€</p><p>â†’ MLflowë¥¼ Helmìœ¼ë¡œ ì™„ì „í•˜ê²Œ ë°°í¬í•˜ëŠ” ê³¼ì •ì„ ì‘ì„±í•  ì˜ˆì •ì…ë‹ˆë‹¤.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/03/><span class=title>Â« Prev</span><br><span>[MLOps í”Œë«í¼ êµ¬ì¶• - 3ë‹¨ê³„: MLflow : PostgreSQL + S3 ì—°ë™ ê¸°ë°˜ Helm êµ¬ì„±]</span>
</a><a class=next href=https://keonhoban.github.io/mlops-journey/posts/mlops-pipeline-helm/01/><span class=title>Next Â»</span><br><span>[MLOps í”Œë«í¼ êµ¬ì¶• - 1ë‹¨ê³„: ì¸í”„ë¼ ì„¤ê³„ ë° í™˜ê²½ ì¤€ë¹„]</span></a></nav></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>