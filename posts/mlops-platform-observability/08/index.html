<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps í”Œë«í¼ Observability & Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content="Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œì´ì „ MLOps í”Œë«í¼ Observability & Data Pipeline - 7ë‹¨ê³„ì—ì„œ
ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€
ë™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€
â€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,
â€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€
ì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ ,
ê·¸ ìœ„ì— ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸ì„ ì–¹ì–´"><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps í”Œë«í¼ Observability & Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]"><meta property="og:description" content="Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œì´ì „ MLOps í”Œë«í¼ Observability & Data Pipeline - 7ë‹¨ê³„ì—ì„œ ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€
ë™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€
â€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,
â€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€
ì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ ,
ê·¸ ìœ„ì— ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸ì„ ì–¹ì–´"><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-15T17:10:21+09:00"><meta property="article:modified_time" content="2025-11-15T17:10:21+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps í”Œë«í¼ Observability & Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]"><meta name=twitter:description content="Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸

ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…

â€œì´ì „ MLOps í”Œë«í¼ Observability & Data Pipeline - 7ë‹¨ê³„ì—ì„œ
ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€
ë™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€
â€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,
â€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€
ì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€
â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ ,
ê·¸ ìœ„ì— ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸ì„ ì–¹ì–´"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://keonhoban.github.io/mlops-journey/posts/"},{"@type":"ListItem","position":2,"name":"[MLOps í”Œë«í¼ Observability \u0026 Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]","item":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps í”Œë«í¼ Observability \u0026 Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]","name":"[MLOps í”Œë«í¼ Observability \u0026 Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]","description":"Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œì´ì „ MLOps í”Œë«í¼ Observability \u0026amp; Data Pipeline - 7ë‹¨ê³„ì—ì„œ ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€\në™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€\nâ€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,\nâ€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€\nì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ ,\nê·¸ ìœ„ì— ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸ì„ ì–¹ì–´\n","keywords":[],"articleBody":"Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸ ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª… â€œì´ì „ MLOps í”Œë«í¼ Observability \u0026 Data Pipeline - 7ë‹¨ê³„ì—ì„œ ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€\në™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€\nâ€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,\nâ€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€\nì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€\nâ€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ ,\nê·¸ ìœ„ì— ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸ì„ ì–¹ì–´\nì‹¤ì œ ML Feature Storeì— ë” ê°€ê¹Œìš´ v2 íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ê³ ë„í™”í–ˆìŠµë‹ˆë‹¤.â€\nğŸ¯ í•µì‹¬ ìš”ì•½ (v1 â†’ v2 ë³€í™” í•œëˆˆì— ë³´ê¸°) ì´ì „ ë‹¨ê³„(v1)ì™€ ì´ë²ˆ ë‹¨ê³„(v2)ì˜ ì°¨ì´ë¥¼ ë¨¼ì € ì •ë¦¬í•˜ë©´:\nì €ì¥ ë°©ì‹\nv1: features_20251119.csv ê°™ì€ ë‹¨ì¼ CSV íŒŒì¼ë¡œ ì €ì¥ (ë®ì–´ì“°ê¸° êµ¬ì¡°)\nv2: ì‹¤í–‰ë§ˆë‹¤\n.../features/daily_user_events/v_YYYYMMDDTHHMMSS/ ì•„ë˜ì—\nfeature.csv\nschema.json\nmetadata.json\n3ì¢… ì„¸íŠ¸ë¡œ ë²„ì „ ë””ë ‰í„°ë¦¬ ìƒì„±\nì‹œê°„/íƒ€ì„ì¡´\nv1: datetime.utcnow().isoformat() ê¸°ë°˜ (ëª…ì‹œì  íƒ€ì„ì¡´ ê´€ë¦¬ X) v2: datetime.now(KST) ê¸°ë°˜ìœ¼ë¡œ í•­ìƒ í•œêµ­ ì‹œê°„(KST) ê¸°ì¤€ ê¸°ë¡ ë©”íƒ€ë°ì´í„°\nv1: ë°ì´í„° í’ˆì§ˆ/ë¼ì¸ë¦¬ì§€ ì •ë³´ëŠ” ë¡œê·¸ì—ë§Œ ì¡´ì¬ v2: schema.json: ì»¬ëŸ¼/íƒ€ì…, pipeline_name, feature_version, created_at(KST)\nmetadata.json: source_raw_path, rows_raw, rows_feature, null_rate, valid ë“±\nâ†’ ë‚˜ì¤‘ì— ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì½ê¸°ë§Œ í•´ë„ ì´ ì‹¤í–‰ì´ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ë°”ë¡œ ì´í•´ ê°€ëŠ¥\nì½”ë“œ êµ¬ì¡°\nDAG: dag_data_pipeline_daily.py â†’ dag_data_pipeline_daily_v2.py ì¶”ê°€ (ê¸°ì¡´ë„ ìœ ì§€) ë¡œì§: ml_code/data_pipeline.py â†’ ml_code/data_pipeline_v2.py ë¡œ í™•ì¥ ì´ì œ ì´ ë³€í™”ë“¤ì´ ì½”ë“œì™€ êµ¬ì¡°ì—ì„œ ì–´ë–»ê²Œ ë“œëŸ¬ë‚˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ í’€ì–´ë³´ê² ìŠµë‹ˆë‹¤.\n1ï¸âƒ£ ì „ì²´ êµ¬ì¡° (v2 ê¸°ì¤€) ê¸°ë³¸ í”Œë¡œìš°ëŠ” v1ê³¼ ë™ì¼í•˜ì§€ë§Œ,\nFeature ì €ì¥ ì´í›„ì˜ S3 êµ¬ì¡°ì™€ ë©”íƒ€ë°ì´í„°ê°€ ì™„ì „íˆ ë‹¬ë¼ì§„ ìƒíƒœì…ë‹ˆë‹¤.\n2ï¸âƒ£ êµ¬ì„± ìš”ì†Œ (v1 ëŒ€ë¹„ ì¶”ê°€/ë³€ê²½ëœ íŒŒì¼) âœ… DAG ë ˆë²¨ ê¸°ì¡´: dag_data_pipeline_daily.py â†’ ml_code.data_pipeline ì‚¬ìš© ì‹ ê·œ: dag_data_pipeline_daily_v2.py â†’ ml_code.data_pipeline_v2 ì‚¬ìš© ë‘ DAGê°€ ê°™ì´ ì¡´ì¬í•˜ë¯€ë¡œ,\ndata_pipeline_daily_dev: v1 êµ¬ì¡° í…ŒìŠ¤íŠ¸ìš©\ndata_pipeline_daily_dev_v2: ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í¬í•¨ëœ v2 êµ¬ì¡°\në¡œ ë³‘í–‰ ìš´ì˜/ë¹„êµ ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.\nâœ… Python ë¡œì§ ë ˆë²¨ airflow-dags-dev/ â”œâ”€â”€ dags/ â”‚ â”œâ”€â”€ dag_data_pipeline_daily.py # v1 â”‚ â”œâ”€â”€ dag_data_pipeline_daily_v2.py # v2 â”‚ â””â”€â”€ ml_code/ â”‚ â”œâ”€â”€ data_pipeline.py # v1 ë¡œì§ â”‚ â””â”€â”€ data_pipeline_v2.py # v2 ë¡œì§ data_pipeline.py\nâ†’ â€œCSV í•˜ë‚˜ ë§Œë“¤ì–´ S3ì— ì €ì¥í•˜ëŠ”â€ ë‹¨ìˆœí•œ ETL íŒŒì´í”„ë¼ì¸\ndata_pipeline_v2.py\nâ†’ ê°™ì€ ETL íë¦„ ìœ„ì—\në²„ì „ ê´€ë¦¬ + schema.json + metadata.json + KST ê¸°ë°˜ ì‹œê°„ ê´€ë¦¬ë¥¼ ì–¹ì€ íŒŒì´í”„ë¼ì¸\n3ï¸âƒ£ v1 â†’ v2: DAG ë ˆë²¨ì—ì„œ ë°”ë€ ì  â–  v1: dag_data_pipeline_daily.py from ml_code.data_pipeline import ( extract_raw_data, validate_data, build_features, store_features, summarize_run, ) def _get_pipeline_config(): try: raw_path = Variable.get( \"dp_raw_path\", default_var=\"s3://datapipeline-raw-data-keonho/daily/user_events_20251119.csv\" ) feature_path = Variable.get( \"dp_feature_path\", default_var=\"s3://datapipeline-raw-data-keonho/features/user_events_feat_20251119.csv\" ) ... feature_pathëŠ” ìµœì¢… íŒŒì¼ ê²½ë¡œ: .../features/user_events_feat_20251119.csv store_features()ê°€ ì´ ê²½ë¡œì— ê·¸ëŒ€ë¡œ put_object â†’ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ê°™ì€ íŒŒì¼ ë®ì–´ì“°ê¸° â–  v2: dag_data_pipeline_daily_v2.py from ml_code.data_pipeline_v2 import ( extract_raw_data, validate_data, build_features, store_features, summarize_run, ) def _get_pipeline_config(): try: raw_path = Variable.get( \"dp_raw_path\", default_var=\"s3://datapipeline-raw-data-keonho/daily/user_events_20251119.csv\" ) feature_path = Variable.get( \"dp_feature_path\", default_var=\"s3://datapipeline-raw-data-keonho/features/daily_user_events/\" ) ... feature_pathì˜ ì˜ë¯¸ë¥¼ â€œë””ë ‰í„°ë¦¬ í”„ë¦¬í”½ìŠ¤â€ë¡œ ë³€ê²½: .../features/daily_user_events/ ì‹¤ì œ ì €ì¥ ì‹œì—ëŠ” ë‚´ë¶€ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì“°ì…ë‹ˆë‹¤. s3://datapipeline-raw-data-keonho/features/daily_user_events/ â””â”€â”€ v_20251129T111532/ â”œâ”€â”€ feature.csv â”œâ”€â”€ schema.json â””â”€â”€ metadata.json âœ… DAG ì…ì¥ì—ì„œëŠ” ë³€í•œ ê²Œ ê±°ì˜ ì—†ê³ ,\nâ€œfeature_pathë¥¼ íŒŒì¼ â†’ ë””ë ‰í„°ë¦¬ í”„ë¦¬í”½ìŠ¤ë¡œ ë°”ê¿”ì„œ v2 ë¡œì§ì— ë„˜ê¸´ë‹¤â€ ì •ë„ë§Œ ë‹¬ë¼ì¡ŒìŠµë‹ˆë‹¤.\n4ï¸âƒ£ Extract \u0026 Validate ë‹¨ê³„ (v1ê³¼ ê±°ì˜ ë™ì¼) âœ” extract_raw_data S3 head_objectë¡œ RAW íŒŒì¼ ì¡´ì¬ í™•ì¸ ì„±ê³µ ì‹œ dp_raw_path XCom ì €ì¥ def extract_raw_data(raw_path: str, pipeline_name: str, ti): s3 = _get_s3_client() bucket, key = _parse_s3_uri(raw_path) s3.head_object(Bucket=bucket, Key=key) ti.xcom_push(key=\"dp_raw_path\", value=raw_path) âœ” validate_data CSV ì „ì²´ read row ìˆ˜ / null_count / null_rate ê³„ì‚° ì•„ì£¼ ê°„ë‹¨í•œ ë£°: rows == 0 ì´ê±°ë‚˜ null_rate \u003e 0.5 â†’ invalid dp_rows, dp_null_rate, dp_valid XCom í‘¸ì‹œ v1ì—ì„œë„ ì¡´ì¬í•˜ë˜ ë‹¨ê³„ì´ê³ , v2ì—ì„œëŠ” ë¡œê·¸ì™€ êµ¬í˜„ ìŠ¤íƒ€ì¼ë§Œ ì¡°ê¸ˆ ì •ë¦¬ëœ ì •ë„ì…ë‹ˆë‹¤.\n5ï¸âƒ£ v2ì˜ í•µì‹¬ â‘  â€” build_featuresì—ì„œ â€œìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€â€ ìƒì„± â–  v1: Feature CSVë§Œ ë§Œë“¤ê³  ë feature_header = [\"row_sum\"] buf = io.StringIO() writer = csv.writer(buf) writer.writerow(feature_header) writer.writerows(feature_rows) feature_csv = buf.getvalue() ti.xcom_push(key=\"dp_feature_csv\", value=feature_csv) ti.xcom_push(key=\"dp_feature_rows\", value=len(feature_rows)) ti.xcom_push(key=\"dp_feature_path\", value=feature_path) row_sum í•˜ë‚˜ì§œë¦¬ Feature CSVë§Œ XComìœ¼ë¡œ ì „ë‹¬ ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„°ëŠ” ë¡œê·¸ì—ë§Œ ì¡´ì¬ â–  v2: Feature + schema.json + metadata.json ì„¤ê³„ from datetime import datetime, timezone, timedelta KST = timezone(timedelta(hours=9)) def build_features(raw_path: str, feature_path: str, pipeline_name: str, ti): ... # row_sum feature_rows ê³„ì‚° ë¶€ë¶„ì€ v1ê³¼ ë™ì¼ # --- schema.json --- schema = { \"feature_version\": None, # ë‚˜ì¤‘ì— store_featuresì—ì„œ ì±„ì›€ \"columns\": {\"row_sum\": \"float\"}, \"created_at\": datetime.now(KST).isoformat(), \"pipeline_name\": pipeline_name, } # --- metadata.json --- metadata = { \"source_raw_path\": raw_path, \"rows_raw\": ti.xcom_pull(key=\"dp_rows\", task_ids=\"validate_data\"), \"rows_feature\": len(feature_rows), \"raw_null_rate\": ti.xcom_pull(key=\"dp_null_rate\", task_ids=\"validate_data\"), \"raw_valid\": ti.xcom_pull(key=\"dp_valid\", task_ids=\"validate_data\"), \"created_at\": datetime.now(KST).isoformat(), \"pipeline_name\": pipeline_name, } # CSV ì§ë ¬í™” buf = io.StringIO() writer = csv.writer(buf) writer.writerow([\"row_sum\"]) writer.writerows(feature_rows) feature_csv = buf.getvalue() ti.xcom_push(key=\"dp_feature_csv\", value=feature_csv) ti.xcom_push(key=\"dp_feature_rows\", value=len(feature_rows)) ti.xcom_push(key=\"dp_feature_path\", value=feature_path) ti.xcom_push(key=\"dp_schema_dict\", value=schema) ti.xcom_push(key=\"dp_metadata_dict\", value=metadata) ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸ëŠ”:\nKST ê¸°ì¤€ íƒ€ì„ë¼ì¸\ndatetime.now(KST).isoformat()\nâ†’ ë¸”ë¡œê·¸/ìš´ì˜ì—ì„œ ë³´ëŠ” ì‹œê°„ = í•­ìƒ í•œêµ­ ì‹œê°„\nschema.json ì„¤ê³„\nì–´ë–¤ ì»¬ëŸ¼ì´ ì–´ë–¤ íƒ€ì…ì¸ì§€, ì–¸ì œ ìƒì„±ëëŠ”ì§€, ì–´ëŠ íŒŒì´í”„ë¼ì¸ì¸ì§€ ë‚˜ì¤‘ì— ë‹¤ë¥¸ ì‹œìŠ¤í…œ(Feature Store, Data Catalog ë“±)ì—ì„œ ì½ì„ ë•Œ ì¦‰ì‹œ í•´ì„ ê°€ëŠ¥ metadata.json ì„¤ê³„\nRAW â†’ Feature ë³€í™˜ ì‹œ row ìˆ˜ null_rate ìœ íš¨ì„± ì—¬ë¶€ RAW íŒŒì¼ ê²½ë¡œ ë°ì´í„° í’ˆì§ˆ/ê³„ë³´(lineage)ë¥¼ íŒŒì¼ë¡œ ë‚¨ê¸°ëŠ” êµ¬ì¡° ìš”ì•½í•˜ë©´,\nâ€œì´ì œ build_featuresëŠ” ë‹¨ìˆœ ì „ì²˜ë¦¬ í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼, â€˜Feature + ìŠ¤í‚¤ë§ˆ + ë©”íƒ€ë°ì´í„° íŒ¨í‚¤ì§€â€™ë¥¼ í•œ ë²ˆì— ë§Œë“¤ì–´ë‚´ëŠ” ë‹¨ê³„â€ë¡œ ê³ ë„í™”ë˜ì—ˆìŠµë‹ˆë‹¤.\n6ï¸âƒ£ v2ì˜ í•µì‹¬ â‘¡ â€” store_featuresì—ì„œ â€œë²„ì „ ë””ë ‰í„°ë¦¬ + 3ì¢… ì„¸íŠ¸ ì €ì¥â€ â–  v1: ë‹¨ì¼ CSV íŒŒì¼ ì €ì¥ bucket, key = _parse_s3_uri(feature_path) s3.put_object( Bucket=bucket, Key=key, Body=feature_csv.encode(\"utf-8\"), ContentType=\"text/csv\", ) ë§¤ ì‹¤í–‰ë§ˆë‹¤ ê°™ì€ keyì— ë®ì–´ì“°ê¸° ë²„ì „/ì‹¤í–‰ ì´ë ¥ì€ ë³„ë„ ê´€ë¦¬ ì—†ìœ¼ë©´ ìƒì–´ë²„ë¦¼ â–  v2: ì‹¤í–‰ ì‹œê°„ ê¸°ë°˜ ë²„ì „ ë””ë ‰í„°ë¦¬ ìƒì„± (KST ê¸°ì¤€) def store_features(feature_path: str, pipeline_name: str, ti): feature_csv = ti.xcom_pull(key=\"dp_feature_csv\", task_ids=\"build_features\") feature_rows = ti.xcom_pull(key=\"dp_feature_rows\", task_ids=\"build_features\") schema = ti.xcom_pull(key=\"dp_schema_dict\", task_ids=\"build_features\") metadata = ti.xcom_pull(key=\"dp_metadata_dict\", task_ids=\"build_features\") exec_date = getattr(ti, \"execution_date\", None) if exec_date is None: exec_date = datetime.now(KST) else: if exec_date.tzinfo is None: exec_date = exec_date.replace(tzinfo=timezone.utc).astimezone(KST) else: exec_date = exec_date.astimezone(KST) run_ts = exec_date.strftime(\"%Y%m%dT%H%M%S\") version_id = f\"v_{run_ts}\" bucket, prefix = _parse_s3_uri(feature_path) if not prefix.endswith(\"/\"): prefix += \"/\" base_prefix = f\"{prefix}{version_id}/\" ... Airflow execution_dateë¥¼ ê¸°ì¤€ìœ¼ë¡œ, í•­ìƒ KST íƒ€ì„ë¼ì¸ìœ¼ë¡œ ë²„ì „ ìƒì„± v_20251129T111532 í˜•íƒœì˜ version_id ë¶€ì—¬ ì´ version_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë””ë ‰í„°ë¦¬ êµ¬ì¡°ë¥¼ ìª¼ê°¬ â–  v2: feature.csv + schema.json + metadata.json ë™ì‹œ ì €ì¥ # feature.csv s3.put_object( Bucket=bucket, Key=f\"{base_prefix}feature.csv\", Body=feature_csv.encode(\"utf-8\"), ContentType=\"text/csv\", ) # schema.json schema[\"feature_version\"] = version_id s3.put_object( Bucket=bucket, Key=f\"{base_prefix}schema.json\", Body=json.dumps(schema, ensure_ascii=False, indent=2).encode(\"utf-8\"), ContentType=\"application/json\", ) # metadata.json s3.put_object( Bucket=bucket, Key=f\"{base_prefix}metadata.json\", Body=json.dumps(metadata, ensure_ascii=False, indent=2).encode(\"utf-8\"), ContentType=\"application/json\", ) ti.xcom_push(key=\"dp_stored_rows\", value=feature_rows) ti.xcom_push(key=\"dp_feature_version\", value=version_id) ti.xcom_push(key=\"dp_feature_prefix\", value=base_prefix) S3 êµ¬ì¡° ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.\ns3://datapipeline-raw-data-keonho/features/daily_user_events/ â”œâ”€â”€ v_20251129T111532/ â”‚ â”œâ”€â”€ feature.csv â”‚ â”œâ”€â”€ schema.json â”‚ â””â”€â”€ metadata.json â”œâ”€â”€ v_20251129T141030/ â”‚ â”œâ”€â”€ feature.csv â”‚ â”œâ”€â”€ schema.json â”‚ â””â”€â”€ metadata.json â””â”€â”€ ... ì´ êµ¬ì¡° ë•ë¶„ì—:\nì‹¤í–‰ ì‹œì ë³„ ë²„ì „ ë¹„êµ\níŠ¹ì • ë‚ /ì‹¤í–‰ ë²„ì „ ì¬í˜„\nìŠ¤í‚¤ë§ˆ/í’ˆì§ˆ ë³€í™”ë¥¼ ì‹œê°„ì¶•ì— ë”°ë¼ ì¶”ì \nì´ ëª¨ë‘ê°€ íŒŒì¼ êµ¬ì¡°ë§Œ ë´ë„ ê°€ëŠ¥í•´ì¡ŒìŠµë‹ˆë‹¤.\n7ï¸âƒ£ v2ì˜ í•µì‹¬ â‘¢ â€” summarize_run: ë²„ì „ê¹Œì§€ í¬í•¨í•œ ì‹¤í–‰ ìš”ì•½ â–  v1 feature_path = ti.xcom_pull(key=\"dp_feature_path\", task_ids=\"build_features\") stored_rows = ti.xcom_pull(key=\"dp_stored_rows\", task_ids=\"store_features\") logger.info( \"[DP] pipeline=%s step=summarize_run \" \"raw_path=%s feature_path=%s \" \"rows=%s null_rate=%s valid=%s stored_rows=%s\", ... ) â€œì–´ë””ì„œ ì½ì–´ì„œ ì–´ë””ì— ì €ì¥í–ˆëŠ”ì§€â€ë§Œ ë¡œê¹… â–  v2 feature_prefix = ti.xcom_pull(key=\"dp_feature_prefix\", task_ids=\"store_features\") feature_version = ti.xcom_pull(key=\"dp_feature_version\", task_ids=\"store_features\") stored_rows = ti.xcom_pull(key=\"dp_stored_rows\", task_ids=\"store_features\") logger.info( \"[DP] pipeline=%s step=summarize_run raw_path=%s feature_prefix=%s \" \"feature_version=%s rows=%s null_rate=%.4f valid=%s stored_rows=%s\", pipeline_name, raw_path, feature_prefix, feature_version, rows, null_rate, valid, stored_rows, ) ì´ì œ ë¡œê·¸ í•œ ì¤„ë§Œ ë´ë„: ì–´ë–¤ RAWì—ì„œ\nì–´ë–¤ ë²„ì „ ë””ë ‰í„°ë¦¬ë¡œ\nëª‡ ê±´ì„ ì €ì¥í–ˆëŠ”ì§€\në°ì´í„° í’ˆì§ˆì€ ì–´ë• ëŠ”ì§€\nì •í™•í•˜ê²Œ ì¬êµ¬ì„± ê°€ëŠ¥\nâ†’ Loki / Grafanaì—ì„œ ì´ ë¡œê·¸ë¥¼ ì¿¼ë¦¬í•˜ë©´\nâ€œë²„ì „ë³„ íŒŒì´í”„ë¼ì¸ ì„±ê³µ/ì‹¤íŒ¨/í’ˆì§ˆ ìƒíƒœâ€ë¥¼ í•œ ë²ˆì— ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì´ ë©ë‹ˆë‹¤.\n8ï¸âƒ£ ì‹¤ì „ Troubleshooting/ìš´ì˜ ê´€ì ì—ì„œ ì–»ì€ ê²ƒ S3 Explorer / AWS ì½˜ì†”ë§Œ ë´ë„:\nì˜¤ëŠ˜ ìƒˆë²½ íŒŒì´í”„ë¼ì¸ì´ ëŒì•˜ëŠ”ì§€\nì–´ë–¤ ë²„ì „ì´ ë§ˆì§€ë§‰ìœ¼ë¡œ ì„±ê³µí–ˆëŠ”ì§€\nschema/metadataì—ì„œ ë°ì´í„° í’ˆì§ˆì´ ì–´ë• ëŠ”ì§€\në°”ë¡œ í™•ì¸ ê°€ëŠ¥\nLoki ë¡œê·¸ ì¿¼ë¦¬ë¡œ:\nfeature_version=\"v_...\" ì¡°ê±´ìœ¼ë¡œ íŠ¹ì • ì‹¤í–‰ë§Œ í•„í„°ë§ null_rateê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ì•˜ë˜ ì‹¤í–‰ë§Œ ëª¨ì•„ì„œ í™•ì¸ ë‚˜ì¤‘ì— MLflow, Feature Store, Data Catalogë¥¼ ë¶™ì¼ ë•Œ:\nêµ³ì´ ì½”ë“œë¡œ ë‹¤ì‹œ íŒŒê³ ë“¤ì§€ ì•Šê³ \nschema.json / metadata.jsonì„ ê¸°ì¤€ìœ¼ë¡œ ë©”íƒ€ë°ì´í„° ì¸ì…ì´ ê°€ëŠ¥\n9ï¸âƒ£ Data Pipeline ì „ìš© Grafana ëŒ€ì‹œë³´ë“œ (Logs \u0026 Metrics (compact)) v2 íŒŒì´í”„ë¼ì¸ì€ S3 êµ¬ì¡°ì™€ schema/metadataë§Œ ê³ ë„í™”ëœ ê²Œ ì•„ë‹ˆë¼,\n**Loki ë¡œê·¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ â€œíŒŒì´í”„ë¼ì¸ ê´€ì¸¡ ì „ìš© ëŒ€ì‹œë³´ë“œâ€**ê¹Œì§€ ì ìš©í–ˆìŠµë‹ˆë‹¤.\nâœ” ëŒ€ì‹œë³´ë“œ ê°œìš” ì œëª©: Data Pipeline (daily_user_events) - Logs \u0026 Metrics (Compact) íƒœê·¸: mlops, data-pipeline, loki í…œí”Œë¦¿ ë³€ìˆ˜: datasource: Loki ë°ì´í„°ì†ŒìŠ¤ ì„ íƒ (dev/prod ê³µìš©) namespace: airflow-dev, airflow-prod ë“± K8s ë„¤ì„ìŠ¤í˜ì´ìŠ¤ pipeline: daily_user_events (í•„ìš” ì‹œ ë‹¤ë¥¸ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥) âœ” íŒ¨ë„ êµ¬ì„± Data Pipeline Logs ([DP]) â€” Logs íŒ¨ë„ ì¿¼ë¦¬ ì˜ˆì‹œ: {namespace=\"$namespace\"} |= \"[DP]\" |= \"pipeline=$pipeline\" Airflow ë¡œê·¸ ì¤‘ [DP] íƒœê·¸ê°€ ë¶™ì€ ë¡œê·¸ë§Œ í•„í„°ë§í•´ì„œ, step=extract_raw_data step=validate_data step=build_features step=store_features step=summarize_run ë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ í•œëˆˆì— ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•œ ì‹¤í–‰ ì•ˆì—ì„œ ê° ë‹¨ê³„ê°€ ì–´ë–»ê²Œ í˜ë €ëŠ”ì§€, ì–´ë””ì—ì„œ ë©ˆì·„ëŠ”ì§€ë¥¼ Row ë‹¨ìœ„ ë¡œê·¸ë¡œ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Pipeline Runs (summarize_run count) â€” TimeSeries íŒ¨ë„ ì¿¼ë¦¬ ì˜ˆì‹œ: sum by (pipeline) (count_over_time({namespace=\"$namespace\"} |= \"[DP]\" |= \"step=summarize_run\" [$__interval])) ì¼ì • êµ¬ê°„ë§ˆë‹¤ step=summarize_run ë¡œê·¸ê°€ ëª‡ ë²ˆ ë°œìƒí–ˆëŠ”ì§€ë¥¼ ì¹´ìš´íŠ¸í•´ì„œ, íŒŒì´í”„ë¼ì¸ì´ ì–¸ì œ, ì–¼ë§ˆë‚˜ ìì£¼ ì‹¤í–‰ëëŠ”ì§€ ì¤‘ê°„ì— ìŠ¤ì¼€ì¤„ì´ ë¹ ì§€ê±°ë‚˜, íŠ¹ì • ì‹œê°„ëŒ€ì— ì‹¤í–‰ì´ ëª°ë¦° êµ¬ê°„ì€ ì—†ëŠ”ì§€ ë¥¼ ì‹œê³„ì—´ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. âœ” ìš´ì˜ì—ì„œì˜ ì‚¬ìš© í¬ì¸íŠ¸ ìƒˆ Raw ë°ì´í„°ê°€ ë“¤ì–´ì™”ì„ ë•Œ\nâ†’ Logs íŒ¨ë„ì—ì„œ [DP] íë¦„ì„ ë”°ë¼ê°€ë©°\nextract_raw_data â†’ validate_data â†’ build_features â†’ store_features â†’ summarize_run\nìˆœì„œëŒ€ë¡œ ì–´ë””ì—ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€ ë°”ë¡œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\níŠ¹ì • ì‹œê°„ëŒ€ì— íŒŒì´í”„ë¼ì¸ì´ ì•ˆ ëŒì•˜ë‹¤ê³  ì˜ì‹¬ë  ë•Œ\nâ†’ TimeSeries íŒ¨ë„ì—ì„œ summarize_run ì¹´ìš´íŠ¸ë¥¼ ë³´ê³ \ní•´ë‹¹ ì‹œê°„ëŒ€ì— ì‹¤í–‰ì´ ìˆì—ˆëŠ”ì§€ / ëª‡ ë²ˆ ìˆì—ˆëŠ”ì§€ ë¹ ë¥´ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì£¼ê¸°ì ì¸ ìŠ¤ì¼€ì¤„ ìƒíƒœë¥¼ ë³´ê³  ì‹¶ì„ ë•Œ\nâ†’ TimeSeries íŒ¨ë„ì„ Last 24 hours / Last 7 days ë“±ìœ¼ë¡œ ë°”ê¿”ë³´ë©´ì„œ\nâ€œë§¤ì¼ ìƒˆë²½ 3ì‹œì— 1íšŒ ì‹¤í–‰â€ ê°™ì€ íŒ¨í„´ì´ ê¹¨ì§„ êµ¬ê°„ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì§€ê¸ˆ êµ¬ì„±ì€\nâ€œê° ì‹¤í–‰ì˜ ìì„¸í•œ ë‹¨ê³„ ë¡œê·¸(Logs) + ì‹¤í–‰ ë¹ˆë„/íŒ¨í„´(TimeSeries)â€\në‘ ê°€ì§€ ê´€ì ìœ¼ë¡œ Data Pipelineì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ìµœì†Œ ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤.\nğŸ”§ MLOps ì‹¤ì „ ì—°ê²° ì´ë²ˆ v2 ê³ ë„í™” ë•ë¶„ì—, ì•ìœ¼ë¡œëŠ” ì´ë ‡ê²Œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nMLflow feature_version, schema.json, metadata.jsonì„ í•™ìŠµ ì‹¤í—˜ì— íƒœê·¸/ì•„í‹°íŒ©íŠ¸ë¡œ ì—°ê²° Feature Store / Data Warehouse versionë³„ feature.csvë¥¼ ë¡œë”© í›„, schema/metadataë¥¼ ê·¸ëŒ€ë¡œ ì¹´íƒˆë¡œê·¸ì— ë°˜ì˜ Observability Loki ë¡œê·¸ + S3 êµ¬ì¡° + Grafana ëŒ€ì‹œë³´ë“œë¡œ\nâ€œì–´ëŠ ë‚ , ì–´ëŠ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ì´, ì–´ë–¤ ë°ì´í„°ë¥¼ ì–¼ë§ˆë‚˜ ì²˜ë¦¬í•˜ê³ , í’ˆì§ˆì´ ì–´ë• ëŠ”ì§€â€ë¥¼ ì‹œê³„ì—´ë¡œ ì¶”ì \nì¦‰, ì´ë²ˆ ë‹¨ê³„ëŠ” ë‹¨ìˆœíˆ â€œì½”ë“œ ë¦¬íŒ©í† ë§â€ì´ ì•„ë‹ˆë¼,\nâ€œë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ML í”Œë«í¼ì˜ ì •ì‹ êµ¬ì„±ì›ìœ¼ë¡œ ìŠ¹ê²©ì‹œí‚¨ ë‹¨ê³„â€ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nğŸ ì •ë¦¬ ì´ë²ˆ v2 ê³ ë„í™”ê¹Œì§€ ì •ë¦¬í•˜ë©´, ë°ì´í„° íŒŒì´í”„ë¼ì¸ì€ ë‹¤ìŒì„ ëª¨ë‘ ë§Œì¡±í•©ë‹ˆë‹¤.\nS3 RAW ingest Extract â†’ Validate â†’ Transform â†’ Load(E2E) Airflow DAG orchestration Python ê¸°ë°˜ Feature Engineering ë²„ì „ ë””ë ‰í„°ë¦¬ ê¸°ë°˜ S3 ì €ì¥ êµ¬ì¡° feature.csv + schema.json + metadata.json 3ì¢… ì„¸íŠ¸ ìƒì„± KST ê¸°ì¤€ íƒ€ì„ë¼ì¸ \u0026 ë²„ì „ ID ê´€ë¦¬ Loki/Grafanaì—ì„œ ì¬êµ¬ì„± ê°€ëŠ¥í•œ í’ë¶€í•œ ì‹¤í–‰ ë¡œê·¸ Data Pipeline ì „ìš© Grafana ëŒ€ì‹œë³´ë“œ(Logs \u0026 Metrics (compact))ë¥¼ í†µí•œ ì‹¤í–‰ ê´€ì¸¡ ì´ì œ ì´ Data Pipelineì€\në‹¨ìˆœ â€œì „ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸â€ë¥¼ ë„˜ì–´ì„œ,\nâ€œMLflow \u0026 ëª¨ë¸ í•™ìŠµ ìë™í™”ì™€ ë°”ë¡œ ì—°ê²° ê°€ëŠ¥í•œ ë°ì´í„° ë ˆì´ì–´â€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n","wordCount":"1561","inLanguage":"en","datePublished":"2025-11-15T17:10:21+09:00","dateModified":"2025-11-15T17:10:21+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/08/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[MLOps í”Œë«í¼ Observability & Data Pipeline - 8ë‹¨ê³„ : Data Pipeline ê³ ë„í™”]</h1><div class=post-meta><span title='2025-11-15 17:10:21 +0900 +0900'>November 15, 2025</span>&nbsp;Â·&nbsp;8 min</div></header><div class=post-content><h2 id=data-pipeline-ê³ ë„í™”-ìŠ¤í‚¤ë§ˆë©”íƒ€ë°ì´í„°--kst-íƒ€ì„ë¼ì¸>Data Pipeline ê³ ë„í™”: ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„° + KST íƒ€ì„ë¼ì¸<a hidden class=anchor aria-hidden=true href=#data-pipeline-ê³ ë„í™”-ìŠ¤í‚¤ë§ˆë©”íƒ€ë°ì´í„°--kst-íƒ€ì„ë¼ì¸>#</a></h2><hr><h2 id=-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>ğŸ§  ì‹œë‚˜ë¦¬ì˜¤ ì„¤ëª…<a hidden class=anchor aria-hidden=true href=#-ì‹œë‚˜ë¦¬ì˜¤-ì„¤ëª…>#</a></h2><blockquote><p>â€œì´ì „ <strong>MLOps í”Œë«í¼ Observability & Data Pipeline - 7ë‹¨ê³„</strong>ì—ì„œ
ìš°ë¦¬ëŠ” S3 Raw â†’ ì „ì²˜ë¦¬ â†’ Feature CSV â†’ S3 ì €ì¥ê¹Œì§€</p><p>ë™ì‘í•˜ëŠ” ì—”ë“œíˆ¬ì—”ë“œ ë°ì´í„° íŒŒì´í”„ë¼ì¸(v1)ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.â€</p><p>â€œí•˜ì§€ë§Œ ì‹¤ë¬´ ML í”Œë«í¼ ì…ì¥ì—ì„œëŠ”,</p><p>â€˜ê·¸ë•Œ ê·¸ ì‹¤í–‰ì—ì„œ ì–´ë–¤ ë°ì´í„°ë¥¼, ì–´ë–¤ í’ˆì§ˆë¡œ, ì–´ëŠ ë²„ì „ì— ì €ì¥í–ˆëŠ”ì§€â€™ê°€</p><p><strong>ì‹œê°„Â·ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°</strong>ê¹Œì§€ í•œ ë²ˆì— ë‚¨ì•„ì•¼ í•©ë‹ˆë‹¤.â€</p><p>â€œê·¸ë˜ì„œ ì´ë²ˆ ë‹¨ê³„ì—ì„œëŠ” <strong>ê¸°ì¡´ v1 íŒŒì´í”„ë¼ì¸ì„ ë²„ë¦¬ì§€ ì•Šê³ </strong>,</p><p>ê·¸ ìœ„ì— <strong>ë²„ì „ ë””ë ‰í„°ë¦¬ êµ¬ì¡° + schema.json + metadata.json + KST íƒ€ì„ë¼ì¸</strong>ì„ ì–¹ì–´</p><p><strong>ì‹¤ì œ ML Feature Storeì— ë” ê°€ê¹Œìš´ v2 íŒŒì´í”„ë¼ì¸</strong>ìœ¼ë¡œ ê³ ë„í™”í–ˆìŠµë‹ˆë‹¤.â€</p></blockquote><hr><h2 id=-í•µì‹¬-ìš”ì•½-v1--v2-ë³€í™”-í•œëˆˆì—-ë³´ê¸°>ğŸ¯ í•µì‹¬ ìš”ì•½ (v1 â†’ v2 ë³€í™” í•œëˆˆì— ë³´ê¸°)<a hidden class=anchor aria-hidden=true href=#-í•µì‹¬-ìš”ì•½-v1--v2-ë³€í™”-í•œëˆˆì—-ë³´ê¸°>#</a></h2><p>ì´ì „ ë‹¨ê³„(v1)ì™€ ì´ë²ˆ ë‹¨ê³„(v2)ì˜ ì°¨ì´ë¥¼ ë¨¼ì € ì •ë¦¬í•˜ë©´:</p><ul><li><p><strong>ì €ì¥ ë°©ì‹</strong></p><ul><li><p>v1: <code>features_20251119.csv</code> ê°™ì€ <strong>ë‹¨ì¼ CSV íŒŒì¼</strong>ë¡œ ì €ì¥ (ë®ì–´ì“°ê¸° êµ¬ì¡°)</p></li><li><p>v2: ì‹¤í–‰ë§ˆë‹¤</p><p><code>.../features/daily_user_events/v_YYYYMMDDTHHMMSS/</code> ì•„ë˜ì—</p><ul><li><p><code>feature.csv</code></p></li><li><p><code>schema.json</code></p></li><li><p><code>metadata.json</code></p><p><strong>3ì¢… ì„¸íŠ¸ë¡œ ë²„ì „ ë””ë ‰í„°ë¦¬ ìƒì„±</strong></p></li></ul></li></ul></li><li><p><strong>ì‹œê°„/íƒ€ì„ì¡´</strong></p><ul><li>v1: <code>datetime.utcnow().isoformat()</code> ê¸°ë°˜ (ëª…ì‹œì  íƒ€ì„ì¡´ ê´€ë¦¬ X)</li><li>v2: <code>datetime.now(KST)</code> ê¸°ë°˜ìœ¼ë¡œ <strong>í•­ìƒ í•œêµ­ ì‹œê°„(KST)</strong> ê¸°ì¤€ ê¸°ë¡</li></ul></li><li><p><strong>ë©”íƒ€ë°ì´í„°</strong></p><ul><li>v1: ë°ì´í„° í’ˆì§ˆ/ë¼ì¸ë¦¬ì§€ ì •ë³´ëŠ” <strong>ë¡œê·¸ì—ë§Œ ì¡´ì¬</strong></li><li>v2:<ul><li><p><code>schema.json</code>: ì»¬ëŸ¼/íƒ€ì…, pipeline_name, feature_version, created_at(KST)</p></li><li><p><code>metadata.json</code>: source_raw_path, rows_raw, rows_feature, null_rate, valid ë“±</p><p>â†’ <strong>ë‚˜ì¤‘ì— ë‹¤ë¥¸ ì‹œìŠ¤í…œì—ì„œ ì½ê¸°ë§Œ í•´ë„ ì´ ì‹¤í–‰ì´ ì–´ë–¤ ì˜ë¯¸ì¸ì§€ ë°”ë¡œ ì´í•´ ê°€ëŠ¥</strong></p></li></ul></li></ul></li><li><p><strong>ì½”ë“œ êµ¬ì¡°</strong></p><ul><li>DAG: <code>dag_data_pipeline_daily.py</code> â†’ <code>dag_data_pipeline_daily_v2.py</code> ì¶”ê°€ (ê¸°ì¡´ë„ ìœ ì§€)</li><li>ë¡œì§: <code>ml_code/data_pipeline.py</code> â†’ <code>ml_code/data_pipeline_v2.py</code> ë¡œ í™•ì¥</li></ul></li></ul><p>ì´ì œ ì´ ë³€í™”ë“¤ì´ ì½”ë“œì™€ êµ¬ì¡°ì—ì„œ ì–´ë–»ê²Œ ë“œëŸ¬ë‚˜ëŠ”ì§€ ë‹¨ê³„ë³„ë¡œ í’€ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p><hr><h2 id=1-ì „ì²´-êµ¬ì¡°-v2-ê¸°ì¤€>1ï¸âƒ£ ì „ì²´ êµ¬ì¡° (v2 ê¸°ì¤€)<a hidden class=anchor aria-hidden=true href=#1-ì „ì²´-êµ¬ì¡°-v2-ê¸°ì¤€>#</a></h2><p>ê¸°ë³¸ í”Œë¡œìš°ëŠ” v1ê³¼ ë™ì¼í•˜ì§€ë§Œ,</p><p><strong>Feature ì €ì¥ ì´í›„ì˜ S3 êµ¬ì¡°ì™€ ë©”íƒ€ë°ì´í„°ê°€ ì™„ì „íˆ ë‹¬ë¼ì§„ ìƒíƒœ</strong>ì…ë‹ˆë‹¤.</p><p><img alt=mermaid-datapipeline-advancement-01.png loading=lazy src=/mlops-journey/images/mermaid-datapipeline-advancement-01.png></p><hr><h2 id=2-êµ¬ì„±-ìš”ì†Œ-v1-ëŒ€ë¹„-ì¶”ê°€ë³€ê²½ëœ-íŒŒì¼>2ï¸âƒ£ êµ¬ì„± ìš”ì†Œ (v1 ëŒ€ë¹„ ì¶”ê°€/ë³€ê²½ëœ íŒŒì¼)<a hidden class=anchor aria-hidden=true href=#2-êµ¬ì„±-ìš”ì†Œ-v1-ëŒ€ë¹„-ì¶”ê°€ë³€ê²½ëœ-íŒŒì¼>#</a></h2><h3 id=-dag-ë ˆë²¨>âœ… DAG ë ˆë²¨<a hidden class=anchor aria-hidden=true href=#-dag-ë ˆë²¨>#</a></h3><ul><li>ê¸°ì¡´: <code>dag_data_pipeline_daily.py</code> â†’ <code>ml_code.data_pipeline</code> ì‚¬ìš©</li><li>ì‹ ê·œ: <code>dag_data_pipeline_daily_v2.py</code> â†’ <code>ml_code.data_pipeline_v2</code> ì‚¬ìš©</li></ul><blockquote><p>ë‘ DAGê°€ ê°™ì´ ì¡´ì¬í•˜ë¯€ë¡œ,</p><ul><li><p><code>data_pipeline_daily_dev</code>: v1 êµ¬ì¡° í…ŒìŠ¤íŠ¸ìš©</p></li><li><p><code>data_pipeline_daily_dev_v2</code>: ë²„ì „Â·ìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€ í¬í•¨ëœ v2 êµ¬ì¡°</p><p>ë¡œ ë³‘í–‰ ìš´ì˜/ë¹„êµ ê°€ëŠ¥í•˜ê²Œ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.</p></li></ul></blockquote><h3 id=-python-ë¡œì§-ë ˆë²¨>âœ… Python ë¡œì§ ë ˆë²¨<a hidden class=anchor aria-hidden=true href=#-python-ë¡œì§-ë ˆë²¨>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>airflow-dags-dev/
</span></span><span style=display:flex><span> â”œâ”€â”€ dags/
</span></span><span style=display:flex><span> â”‚    â”œâ”€â”€ dag_data_pipeline_daily.py        <span style=color:#75715e># v1</span>
</span></span><span style=display:flex><span> â”‚    â”œâ”€â”€ dag_data_pipeline_daily_v2.py     <span style=color:#75715e># v2</span>
</span></span><span style=display:flex><span> â”‚    â””â”€â”€ ml_code/
</span></span><span style=display:flex><span> â”‚         â”œâ”€â”€ data_pipeline.py             <span style=color:#75715e># v1 ë¡œì§</span>
</span></span><span style=display:flex><span> â”‚         â””â”€â”€ data_pipeline_v2.py          <span style=color:#75715e># v2 ë¡œì§</span>
</span></span></code></pre></div><ul><li><p><code>data_pipeline.py</code></p><p>â†’ â€œ<strong>CSV í•˜ë‚˜ ë§Œë“¤ì–´ S3ì— ì €ì¥í•˜ëŠ”</strong>â€ ë‹¨ìˆœí•œ ETL íŒŒì´í”„ë¼ì¸</p></li><li><p><code>data_pipeline_v2.py</code></p><p>â†’ ê°™ì€ ETL íë¦„ ìœ„ì—</p><p><strong>ë²„ì „ ê´€ë¦¬ + schema.json + metadata.json + KST ê¸°ë°˜ ì‹œê°„ ê´€ë¦¬</strong>ë¥¼ ì–¹ì€ íŒŒì´í”„ë¼ì¸</p></li></ul><hr><h2 id=3-v1--v2-dag-ë ˆë²¨ì—ì„œ-ë°”ë€-ì >3ï¸âƒ£ v1 â†’ v2: DAG ë ˆë²¨ì—ì„œ ë°”ë€ ì <a hidden class=anchor aria-hidden=true href=#3-v1--v2-dag-ë ˆë²¨ì—ì„œ-ë°”ë€-ì >#</a></h2><h3 id=-v1-dag_data_pipeline_dailypy>â–  v1: <code>dag_data_pipeline_daily.py</code><a hidden class=anchor aria-hidden=true href=#-v1-dag_data_pipeline_dailypy>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> ml_code.data_pipeline <span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    extract_raw_data,
</span></span><span style=display:flex><span>    validate_data,
</span></span><span style=display:flex><span>    build_features,
</span></span><span style=display:flex><span>    store_features,
</span></span><span style=display:flex><span>    summarize_run,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_get_pipeline_config</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        raw_path <span style=color:#f92672>=</span> Variable<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;dp_raw_path&#34;</span>,
</span></span><span style=display:flex><span>            default_var<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s3://datapipeline-raw-data-keonho/daily/user_events_20251119.csv&#34;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        feature_path <span style=color:#f92672>=</span> Variable<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;dp_feature_path&#34;</span>,
</span></span><span style=display:flex><span>            default_var<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s3://datapipeline-raw-data-keonho/features/user_events_feat_20251119.csv&#34;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#f92672>...</span>
</span></span></code></pre></div><ul><li><code>feature_path</code>ëŠ” <strong>ìµœì¢… íŒŒì¼ ê²½ë¡œ</strong>:<ul><li><code>.../features/user_events_feat_20251119.csv</code></li></ul></li><li><code>store_features()</code>ê°€ ì´ ê²½ë¡œì— ê·¸ëŒ€ë¡œ <code>put_object</code> â†’ <strong>ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ê°™ì€ íŒŒì¼ ë®ì–´ì“°ê¸°</strong></li></ul><hr><h3 id=-v2-dag_data_pipeline_daily_v2py>â–  v2: <code>dag_data_pipeline_daily_v2.py</code><a hidden class=anchor aria-hidden=true href=#-v2-dag_data_pipeline_daily_v2py>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> ml_code.data_pipeline_v2 <span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    extract_raw_data,
</span></span><span style=display:flex><span>    validate_data,
</span></span><span style=display:flex><span>    build_features,
</span></span><span style=display:flex><span>    store_features,
</span></span><span style=display:flex><span>    summarize_run,
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>_get_pipeline_config</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        raw_path <span style=color:#f92672>=</span> Variable<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;dp_raw_path&#34;</span>,
</span></span><span style=display:flex><span>            default_var<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s3://datapipeline-raw-data-keonho/daily/user_events_20251119.csv&#34;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        feature_path <span style=color:#f92672>=</span> Variable<span style=color:#f92672>.</span>get(
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;dp_feature_path&#34;</span>,
</span></span><span style=display:flex><span>            default_var<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;s3://datapipeline-raw-data-keonho/features/daily_user_events/&#34;</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        <span style=color:#f92672>...</span>
</span></span></code></pre></div><ul><li><code>feature_path</code>ì˜ ì˜ë¯¸ë¥¼ â€œë””ë ‰í„°ë¦¬ í”„ë¦¬í”½ìŠ¤â€ë¡œ ë³€ê²½:<ul><li><code>.../features/daily_user_events/</code></li></ul></li><li>ì‹¤ì œ ì €ì¥ ì‹œì—ëŠ” ë‚´ë¶€ì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì“°ì…ë‹ˆë‹¤.</li></ul><pre tabindex=0><code>s3://datapipeline-raw-data-keonho/features/daily_user_events/
  â””â”€â”€ v_20251129T111532/
        â”œâ”€â”€ feature.csv
        â”œâ”€â”€ schema.json
        â””â”€â”€ metadata.json
</code></pre><blockquote><p>âœ… DAG ì…ì¥ì—ì„œëŠ” ë³€í•œ ê²Œ ê±°ì˜ ì—†ê³ ,</p><p>â€œfeature_pathë¥¼ íŒŒì¼ â†’ ë””ë ‰í„°ë¦¬ í”„ë¦¬í”½ìŠ¤ë¡œ ë°”ê¿”ì„œ v2 ë¡œì§ì— ë„˜ê¸´ë‹¤â€ ì •ë„ë§Œ ë‹¬ë¼ì¡ŒìŠµë‹ˆë‹¤.</p></blockquote><hr><h2 id=4-extract--validate-ë‹¨ê³„-v1ê³¼-ê±°ì˜-ë™ì¼>4ï¸âƒ£ Extract & Validate ë‹¨ê³„ (v1ê³¼ ê±°ì˜ ë™ì¼)<a hidden class=anchor aria-hidden=true href=#4-extract--validate-ë‹¨ê³„-v1ê³¼-ê±°ì˜-ë™ì¼>#</a></h2><h3 id=-extract_raw_data>âœ” extract_raw_data<a hidden class=anchor aria-hidden=true href=#-extract_raw_data>#</a></h3><ul><li>S3 <code>head_object</code>ë¡œ RAW íŒŒì¼ ì¡´ì¬ í™•ì¸</li><li>ì„±ê³µ ì‹œ <code>dp_raw_path</code> XCom ì €ì¥</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>extract_raw_data</span>(raw_path: str, pipeline_name: str, ti):
</span></span><span style=display:flex><span>    s3 <span style=color:#f92672>=</span> _get_s3_client()
</span></span><span style=display:flex><span>    bucket, key <span style=color:#f92672>=</span> _parse_s3_uri(raw_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    s3<span style=color:#f92672>.</span>head_object(Bucket<span style=color:#f92672>=</span>bucket, Key<span style=color:#f92672>=</span>key)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_raw_path&#34;</span>, value<span style=color:#f92672>=</span>raw_path)
</span></span></code></pre></div><h3 id=-validate_data>âœ” validate_data<a hidden class=anchor aria-hidden=true href=#-validate_data>#</a></h3><ul><li>CSV ì „ì²´ read</li><li>row ìˆ˜ / null_count / null_rate ê³„ì‚°</li><li>ì•„ì£¼ ê°„ë‹¨í•œ ë£°:<ul><li><code>rows == 0</code> ì´ê±°ë‚˜ <code>null_rate > 0.5</code> â†’ invalid</li></ul></li><li><code>dp_rows</code>, <code>dp_null_rate</code>, <code>dp_valid</code> XCom í‘¸ì‹œ</li></ul><p>v1ì—ì„œë„ ì¡´ì¬í•˜ë˜ ë‹¨ê³„ì´ê³ , v2ì—ì„œëŠ” <strong>ë¡œê·¸ì™€ êµ¬í˜„ ìŠ¤íƒ€ì¼ë§Œ ì¡°ê¸ˆ ì •ë¦¬ëœ ì •ë„</strong>ì…ë‹ˆë‹¤.</p><hr><h2 id=5-v2ì˜-í•µì‹¬---build_featuresì—ì„œ-ìŠ¤í‚¤ë§ˆë©”íƒ€ë°ì´í„°ê¹Œì§€-ìƒì„±>5ï¸âƒ£ v2ì˜ í•µì‹¬ â‘  â€” build_featuresì—ì„œ â€œìŠ¤í‚¤ë§ˆÂ·ë©”íƒ€ë°ì´í„°ê¹Œì§€â€ ìƒì„±<a hidden class=anchor aria-hidden=true href=#5-v2ì˜-í•µì‹¬---build_featuresì—ì„œ-ìŠ¤í‚¤ë§ˆë©”íƒ€ë°ì´í„°ê¹Œì§€-ìƒì„±>#</a></h2><h3 id=-v1-feature-csvë§Œ-ë§Œë“¤ê³ -ë>â–  v1: Feature CSVë§Œ ë§Œë“¤ê³  ë<a hidden class=anchor aria-hidden=true href=#-v1-feature-csvë§Œ-ë§Œë“¤ê³ -ë>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>feature_header <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;row_sum&#34;</span>]
</span></span><span style=display:flex><span>buf <span style=color:#f92672>=</span> io<span style=color:#f92672>.</span>StringIO()
</span></span><span style=display:flex><span>writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>writer(buf)
</span></span><span style=display:flex><span>writer<span style=color:#f92672>.</span>writerow(feature_header)
</span></span><span style=display:flex><span>writer<span style=color:#f92672>.</span>writerows(feature_rows)
</span></span><span style=display:flex><span>feature_csv <span style=color:#f92672>=</span> buf<span style=color:#f92672>.</span>getvalue()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_csv&#34;</span>, value<span style=color:#f92672>=</span>feature_csv)
</span></span><span style=display:flex><span>ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_rows&#34;</span>, value<span style=color:#f92672>=</span>len(feature_rows))
</span></span><span style=display:flex><span>ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_path&#34;</span>, value<span style=color:#f92672>=</span>feature_path)
</span></span></code></pre></div><ul><li><code>row_sum</code> í•˜ë‚˜ì§œë¦¬ Feature CSVë§Œ XComìœ¼ë¡œ ì „ë‹¬</li><li>ìŠ¤í‚¤ë§ˆ/ë©”íƒ€ë°ì´í„°ëŠ” <strong>ë¡œê·¸ì—ë§Œ ì¡´ì¬</strong></li></ul><hr><h3 id=-v2-feature--schemajson--metadatajson-ì„¤ê³„>â–  v2: Feature + schema.json + metadata.json ì„¤ê³„<a hidden class=anchor aria-hidden=true href=#-v2-feature--schemajson--metadatajson-ì„¤ê³„>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime, timezone, timedelta
</span></span><span style=display:flex><span>KST <span style=color:#f92672>=</span> timezone(timedelta(hours<span style=color:#f92672>=</span><span style=color:#ae81ff>9</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>build_features</span>(raw_path: str, feature_path: str, pipeline_name: str, ti):
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># row_sum feature_rows ê³„ì‚° ë¶€ë¶„ì€ v1ê³¼ ë™ì¼</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># --- schema.json ---</span>
</span></span><span style=display:flex><span>    schema <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;feature_version&#34;</span>: <span style=color:#66d9ef>None</span>,                 <span style=color:#75715e># ë‚˜ì¤‘ì— store_featuresì—ì„œ ì±„ì›€</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;columns&#34;</span>: {<span style=color:#e6db74>&#34;row_sum&#34;</span>: <span style=color:#e6db74>&#34;float&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;created_at&#34;</span>: datetime<span style=color:#f92672>.</span>now(KST)<span style=color:#f92672>.</span>isoformat(),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pipeline_name&#34;</span>: pipeline_name,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># --- metadata.json ---</span>
</span></span><span style=display:flex><span>    metadata <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;source_raw_path&#34;</span>: raw_path,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;rows_raw&#34;</span>: ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_rows&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;validate_data&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;rows_feature&#34;</span>: len(feature_rows),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;raw_null_rate&#34;</span>: ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_null_rate&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;validate_data&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;raw_valid&#34;</span>: ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_valid&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;validate_data&#34;</span>),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;created_at&#34;</span>: datetime<span style=color:#f92672>.</span>now(KST)<span style=color:#f92672>.</span>isoformat(),
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;pipeline_name&#34;</span>: pipeline_name,
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># CSV ì§ë ¬í™”</span>
</span></span><span style=display:flex><span>    buf <span style=color:#f92672>=</span> io<span style=color:#f92672>.</span>StringIO()
</span></span><span style=display:flex><span>    writer <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>writer(buf)
</span></span><span style=display:flex><span>    writer<span style=color:#f92672>.</span>writerow([<span style=color:#e6db74>&#34;row_sum&#34;</span>])
</span></span><span style=display:flex><span>    writer<span style=color:#f92672>.</span>writerows(feature_rows)
</span></span><span style=display:flex><span>    feature_csv <span style=color:#f92672>=</span> buf<span style=color:#f92672>.</span>getvalue()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_csv&#34;</span>, value<span style=color:#f92672>=</span>feature_csv)
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_rows&#34;</span>, value<span style=color:#f92672>=</span>len(feature_rows))
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_path&#34;</span>, value<span style=color:#f92672>=</span>feature_path)
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_schema_dict&#34;</span>, value<span style=color:#f92672>=</span>schema)
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_metadata_dict&#34;</span>, value<span style=color:#f92672>=</span>metadata)
</span></span></code></pre></div><p>ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸ëŠ”:</p><ol><li><p><strong>KST ê¸°ì¤€ íƒ€ì„ë¼ì¸</strong></p><ul><li><p><code>datetime.now(KST).isoformat()</code></p><p>â†’ ë¸”ë¡œê·¸/ìš´ì˜ì—ì„œ ë³´ëŠ” ì‹œê°„ = <strong>í•­ìƒ í•œêµ­ ì‹œê°„</strong></p></li></ul></li><li><p><strong>schema.json ì„¤ê³„</strong></p><ul><li>ì–´ë–¤ ì»¬ëŸ¼ì´ ì–´ë–¤ íƒ€ì…ì¸ì§€, ì–¸ì œ ìƒì„±ëëŠ”ì§€, ì–´ëŠ íŒŒì´í”„ë¼ì¸ì¸ì§€</li><li>ë‚˜ì¤‘ì— ë‹¤ë¥¸ ì‹œìŠ¤í…œ(Feature Store, Data Catalog ë“±)ì—ì„œ ì½ì„ ë•Œ <strong>ì¦‰ì‹œ í•´ì„ ê°€ëŠ¥</strong></li></ul></li><li><p><strong>metadata.json ì„¤ê³„</strong></p><ul><li>RAW â†’ Feature ë³€í™˜ ì‹œ<ul><li>row ìˆ˜</li><li>null_rate</li><li>ìœ íš¨ì„± ì—¬ë¶€</li><li>RAW íŒŒì¼ ê²½ë¡œ</li></ul></li><li>ë°ì´í„° í’ˆì§ˆ/ê³„ë³´(lineage)ë¥¼ <strong>íŒŒì¼ë¡œ ë‚¨ê¸°ëŠ” êµ¬ì¡°</strong></li></ul></li></ol><blockquote><p>ìš”ì•½í•˜ë©´,</p><p>â€œ<strong>ì´ì œ build_featuresëŠ” ë‹¨ìˆœ ì „ì²˜ë¦¬ í•¨ìˆ˜ê°€ ì•„ë‹ˆë¼,
â€˜Feature + ìŠ¤í‚¤ë§ˆ + ë©”íƒ€ë°ì´í„° íŒ¨í‚¤ì§€â€™ë¥¼ í•œ ë²ˆì— ë§Œë“¤ì–´ë‚´ëŠ” ë‹¨ê³„</strong>â€ë¡œ ê³ ë„í™”ë˜ì—ˆìŠµë‹ˆë‹¤.</p></blockquote><hr><h2 id=6-v2ì˜-í•µì‹¬---store_featuresì—ì„œ-ë²„ì „-ë””ë ‰í„°ë¦¬--3ì¢…-ì„¸íŠ¸-ì €ì¥>6ï¸âƒ£ v2ì˜ í•µì‹¬ â‘¡ â€” store_featuresì—ì„œ â€œë²„ì „ ë””ë ‰í„°ë¦¬ + 3ì¢… ì„¸íŠ¸ ì €ì¥â€<a hidden class=anchor aria-hidden=true href=#6-v2ì˜-í•µì‹¬---store_featuresì—ì„œ-ë²„ì „-ë””ë ‰í„°ë¦¬--3ì¢…-ì„¸íŠ¸-ì €ì¥>#</a></h2><h3 id=-v1-ë‹¨ì¼-csv-íŒŒì¼-ì €ì¥>â–  v1: ë‹¨ì¼ CSV íŒŒì¼ ì €ì¥<a hidden class=anchor aria-hidden=true href=#-v1-ë‹¨ì¼-csv-íŒŒì¼-ì €ì¥>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>bucket, key <span style=color:#f92672>=</span> _parse_s3_uri(feature_path)
</span></span><span style=display:flex><span>s3<span style=color:#f92672>.</span>put_object(
</span></span><span style=display:flex><span>    Bucket<span style=color:#f92672>=</span>bucket,
</span></span><span style=display:flex><span>    Key<span style=color:#f92672>=</span>key,
</span></span><span style=display:flex><span>    Body<span style=color:#f92672>=</span>feature_csv<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;utf-8&#34;</span>),
</span></span><span style=display:flex><span>    ContentType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/csv&#34;</span>,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><ul><li>ë§¤ ì‹¤í–‰ë§ˆë‹¤ <strong>ê°™ì€ keyì— ë®ì–´ì“°ê¸°</strong></li><li>ë²„ì „/ì‹¤í–‰ ì´ë ¥ì€ <strong>ë³„ë„ ê´€ë¦¬ ì—†ìœ¼ë©´ ìƒì–´ë²„ë¦¼</strong></li></ul><hr><h3 id=-v2-ì‹¤í–‰-ì‹œê°„-ê¸°ë°˜-ë²„ì „-ë””ë ‰í„°ë¦¬-ìƒì„±-kst-ê¸°ì¤€>â–  v2: ì‹¤í–‰ ì‹œê°„ ê¸°ë°˜ ë²„ì „ ë””ë ‰í„°ë¦¬ ìƒì„± (KST ê¸°ì¤€)<a hidden class=anchor aria-hidden=true href=#-v2-ì‹¤í–‰-ì‹œê°„-ê¸°ë°˜-ë²„ì „-ë””ë ‰í„°ë¦¬-ìƒì„±-kst-ê¸°ì¤€>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>store_features</span>(feature_path: str, pipeline_name: str, ti):
</span></span><span style=display:flex><span>    feature_csv <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_csv&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;build_features&#34;</span>)
</span></span><span style=display:flex><span>    feature_rows <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_rows&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;build_features&#34;</span>)
</span></span><span style=display:flex><span>    schema <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_schema_dict&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;build_features&#34;</span>)
</span></span><span style=display:flex><span>    metadata <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_metadata_dict&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;build_features&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    exec_date <span style=color:#f92672>=</span> getattr(ti, <span style=color:#e6db74>&#34;execution_date&#34;</span>, <span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> exec_date <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        exec_date <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>now(KST)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> exec_date<span style=color:#f92672>.</span>tzinfo <span style=color:#f92672>is</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            exec_date <span style=color:#f92672>=</span> exec_date<span style=color:#f92672>.</span>replace(tzinfo<span style=color:#f92672>=</span>timezone<span style=color:#f92672>.</span>utc)<span style=color:#f92672>.</span>astimezone(KST)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            exec_date <span style=color:#f92672>=</span> exec_date<span style=color:#f92672>.</span>astimezone(KST)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    run_ts <span style=color:#f92672>=</span> exec_date<span style=color:#f92672>.</span>strftime(<span style=color:#e6db74>&#34;%Y%m</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>T%H%M%S&#34;</span>)
</span></span><span style=display:flex><span>    version_id <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;v_</span><span style=color:#e6db74>{</span>run_ts<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    bucket, prefix <span style=color:#f92672>=</span> _parse_s3_uri(feature_path)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> prefix<span style=color:#f92672>.</span>endswith(<span style=color:#e6db74>&#34;/&#34;</span>):
</span></span><span style=display:flex><span>        prefix <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;/&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    base_prefix <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>prefix<span style=color:#e6db74>}{</span>version_id<span style=color:#e6db74>}</span><span style=color:#e6db74>/&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span></code></pre></div><ul><li>Airflow <code>execution_date</code>ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, í•­ìƒ <strong>KST íƒ€ì„ë¼ì¸</strong>ìœ¼ë¡œ ë²„ì „ ìƒì„±</li><li><code>v_20251129T111532</code> í˜•íƒœì˜ version_id ë¶€ì—¬</li><li>ì´ version_idë¥¼ ê¸°ì¤€ìœ¼ë¡œ <strong>ë””ë ‰í„°ë¦¬ êµ¬ì¡°ë¥¼ ìª¼ê°¬</strong></li></ul><hr><h3 id=-v2-featurecsv--schemajson--metadatajson-ë™ì‹œ-ì €ì¥>â–  v2: feature.csv + schema.json + metadata.json ë™ì‹œ ì €ì¥<a hidden class=anchor aria-hidden=true href=#-v2-featurecsv--schemajson--metadatajson-ë™ì‹œ-ì €ì¥>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>    <span style=color:#75715e># feature.csv</span>
</span></span><span style=display:flex><span>    s3<span style=color:#f92672>.</span>put_object(
</span></span><span style=display:flex><span>        Bucket<span style=color:#f92672>=</span>bucket,
</span></span><span style=display:flex><span>        Key<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>base_prefix<span style=color:#e6db74>}</span><span style=color:#e6db74>feature.csv&#34;</span>,
</span></span><span style=display:flex><span>        Body<span style=color:#f92672>=</span>feature_csv<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;utf-8&#34;</span>),
</span></span><span style=display:flex><span>        ContentType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/csv&#34;</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># schema.json</span>
</span></span><span style=display:flex><span>    schema[<span style=color:#e6db74>&#34;feature_version&#34;</span>] <span style=color:#f92672>=</span> version_id
</span></span><span style=display:flex><span>    s3<span style=color:#f92672>.</span>put_object(
</span></span><span style=display:flex><span>        Bucket<span style=color:#f92672>=</span>bucket,
</span></span><span style=display:flex><span>        Key<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>base_prefix<span style=color:#e6db74>}</span><span style=color:#e6db74>schema.json&#34;</span>,
</span></span><span style=display:flex><span>        Body<span style=color:#f92672>=</span>json<span style=color:#f92672>.</span>dumps(schema, ensure_ascii<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;utf-8&#34;</span>),
</span></span><span style=display:flex><span>        ContentType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># metadata.json</span>
</span></span><span style=display:flex><span>    s3<span style=color:#f92672>.</span>put_object(
</span></span><span style=display:flex><span>        Bucket<span style=color:#f92672>=</span>bucket,
</span></span><span style=display:flex><span>        Key<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>base_prefix<span style=color:#e6db74>}</span><span style=color:#e6db74>metadata.json&#34;</span>,
</span></span><span style=display:flex><span>        Body<span style=color:#f92672>=</span>json<span style=color:#f92672>.</span>dumps(metadata, ensure_ascii<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, indent<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#34;utf-8&#34;</span>),
</span></span><span style=display:flex><span>        ContentType<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_stored_rows&#34;</span>, value<span style=color:#f92672>=</span>feature_rows)
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_version&#34;</span>, value<span style=color:#f92672>=</span>version_id)
</span></span><span style=display:flex><span>    ti<span style=color:#f92672>.</span>xcom_push(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_prefix&#34;</span>, value<span style=color:#f92672>=</span>base_prefix)
</span></span></code></pre></div><p>S3 êµ¬ì¡° ì˜ˆì‹œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><pre tabindex=0><code>s3://datapipeline-raw-data-keonho/features/daily_user_events/
  â”œâ”€â”€ v_20251129T111532/
  â”‚     â”œâ”€â”€ feature.csv
  â”‚     â”œâ”€â”€ schema.json
  â”‚     â””â”€â”€ metadata.json
  â”œâ”€â”€ v_20251129T141030/
  â”‚     â”œâ”€â”€ feature.csv
  â”‚     â”œâ”€â”€ schema.json
  â”‚     â””â”€â”€ metadata.json
  â””â”€â”€ ...
</code></pre><blockquote><p>ì´ êµ¬ì¡° ë•ë¶„ì—:</p><ul><li><p>ì‹¤í–‰ ì‹œì ë³„ ë²„ì „ ë¹„êµ</p></li><li><p>íŠ¹ì • ë‚ /ì‹¤í–‰ ë²„ì „ ì¬í˜„</p></li><li><p>ìŠ¤í‚¤ë§ˆ/í’ˆì§ˆ ë³€í™”ë¥¼ ì‹œê°„ì¶•ì— ë”°ë¼ ì¶”ì </p><p>ì´ ëª¨ë‘ê°€ <strong>íŒŒì¼ êµ¬ì¡°ë§Œ ë´ë„ ê°€ëŠ¥</strong>í•´ì¡ŒìŠµë‹ˆë‹¤.</p></li></ul></blockquote><hr><h2 id=7-v2ì˜-í•µì‹¬---summarize_run-ë²„ì „ê¹Œì§€-í¬í•¨í•œ-ì‹¤í–‰-ìš”ì•½>7ï¸âƒ£ v2ì˜ í•µì‹¬ â‘¢ â€” summarize_run: ë²„ì „ê¹Œì§€ í¬í•¨í•œ ì‹¤í–‰ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#7-v2ì˜-í•µì‹¬---summarize_run-ë²„ì „ê¹Œì§€-í¬í•¨í•œ-ì‹¤í–‰-ìš”ì•½>#</a></h2><h3 id=-v1>â–  v1<a hidden class=anchor aria-hidden=true href=#-v1>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>feature_path <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_path&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;build_features&#34;</span>)
</span></span><span style=display:flex><span>stored_rows <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_stored_rows&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store_features&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logger<span style=color:#f92672>.</span>info(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;[DP] pipeline=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> step=summarize_run &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;raw_path=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> feature_path=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;rows=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> null_rate=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> valid=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> stored_rows=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><ul><li>â€œì–´ë””ì„œ ì½ì–´ì„œ ì–´ë””ì— ì €ì¥í–ˆëŠ”ì§€â€ë§Œ ë¡œê¹…</li></ul><hr><h3 id=-v2>â–  v2<a hidden class=anchor aria-hidden=true href=#-v2>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>feature_prefix <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_prefix&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store_features&#34;</span>)
</span></span><span style=display:flex><span>feature_version <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_feature_version&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store_features&#34;</span>)
</span></span><span style=display:flex><span>stored_rows <span style=color:#f92672>=</span> ti<span style=color:#f92672>.</span>xcom_pull(key<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dp_stored_rows&#34;</span>, task_ids<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store_features&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logger<span style=color:#f92672>.</span>info(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;[DP] pipeline=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> step=summarize_run raw_path=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> feature_prefix=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> &#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;feature_version=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> rows=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> null_rate=</span><span style=color:#e6db74>%.4f</span><span style=color:#e6db74> valid=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> stored_rows=</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>    pipeline_name,
</span></span><span style=display:flex><span>    raw_path,
</span></span><span style=display:flex><span>    feature_prefix,
</span></span><span style=display:flex><span>    feature_version,
</span></span><span style=display:flex><span>    rows,
</span></span><span style=display:flex><span>    null_rate,
</span></span><span style=display:flex><span>    valid,
</span></span><span style=display:flex><span>    stored_rows,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><ul><li>ì´ì œ ë¡œê·¸ í•œ ì¤„ë§Œ ë´ë„:<ul><li><p>ì–´ë–¤ RAWì—ì„œ</p></li><li><p>ì–´ë–¤ ë²„ì „ ë””ë ‰í„°ë¦¬ë¡œ</p></li><li><p>ëª‡ ê±´ì„ ì €ì¥í–ˆëŠ”ì§€</p></li><li><p>ë°ì´í„° í’ˆì§ˆì€ ì–´ë• ëŠ”ì§€</p><p><strong>ì •í™•í•˜ê²Œ ì¬êµ¬ì„± ê°€ëŠ¥</strong></p></li></ul></li></ul><p>â†’ Loki / Grafanaì—ì„œ ì´ ë¡œê·¸ë¥¼ ì¿¼ë¦¬í•˜ë©´</p><p>â€œë²„ì „ë³„ íŒŒì´í”„ë¼ì¸ ì„±ê³µ/ì‹¤íŒ¨/í’ˆì§ˆ ìƒíƒœâ€ë¥¼ í•œ ë²ˆì— ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ê¸°ë°˜ì´ ë©ë‹ˆë‹¤.</p><hr><h2 id=8-ì‹¤ì „-troubleshootingìš´ì˜-ê´€ì ì—ì„œ-ì–»ì€-ê²ƒ>8ï¸âƒ£ ì‹¤ì „ Troubleshooting/ìš´ì˜ ê´€ì ì—ì„œ ì–»ì€ ê²ƒ<a hidden class=anchor aria-hidden=true href=#8-ì‹¤ì „-troubleshootingìš´ì˜-ê´€ì ì—ì„œ-ì–»ì€-ê²ƒ>#</a></h2><ul><li><p>S3 Explorer / AWS ì½˜ì†”ë§Œ ë´ë„:</p><ul><li><p>ì˜¤ëŠ˜ ìƒˆë²½ íŒŒì´í”„ë¼ì¸ì´ ëŒì•˜ëŠ”ì§€</p></li><li><p>ì–´ë–¤ ë²„ì „ì´ ë§ˆì§€ë§‰ìœ¼ë¡œ ì„±ê³µí–ˆëŠ”ì§€</p></li><li><p>schema/metadataì—ì„œ ë°ì´í„° í’ˆì§ˆì´ ì–´ë• ëŠ”ì§€</p><p>ë°”ë¡œ í™•ì¸ ê°€ëŠ¥</p></li></ul></li><li><p>Loki ë¡œê·¸ ì¿¼ë¦¬ë¡œ:</p><ul><li><code>feature_version="v_..."</code> ì¡°ê±´ìœ¼ë¡œ íŠ¹ì • ì‹¤í–‰ë§Œ í•„í„°ë§</li><li>null_rateê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ë†’ì•˜ë˜ ì‹¤í–‰ë§Œ ëª¨ì•„ì„œ í™•ì¸</li></ul></li><li><p>ë‚˜ì¤‘ì— MLflow, Feature Store, Data Catalogë¥¼ ë¶™ì¼ ë•Œ:</p><ul><li><p>êµ³ì´ ì½”ë“œë¡œ ë‹¤ì‹œ íŒŒê³ ë“¤ì§€ ì•Šê³ </p><p><strong>schema.json / metadata.jsonì„ ê¸°ì¤€ìœ¼ë¡œ ë©”íƒ€ë°ì´í„° ì¸ì…</strong>ì´ ê°€ëŠ¥</p></li></ul></li></ul><hr><h2 id=9-data-pipeline-ì „ìš©-grafana-ëŒ€ì‹œë³´ë“œ-logs--metrics-compact>9ï¸âƒ£ Data Pipeline ì „ìš© Grafana ëŒ€ì‹œë³´ë“œ (Logs & Metrics (compact))<a hidden class=anchor aria-hidden=true href=#9-data-pipeline-ì „ìš©-grafana-ëŒ€ì‹œë³´ë“œ-logs--metrics-compact>#</a></h2><p>v2 íŒŒì´í”„ë¼ì¸ì€ S3 êµ¬ì¡°ì™€ schema/metadataë§Œ ê³ ë„í™”ëœ ê²Œ ì•„ë‹ˆë¼,</p><p>**Loki ë¡œê·¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ â€œíŒŒì´í”„ë¼ì¸ ê´€ì¸¡ ì „ìš© ëŒ€ì‹œë³´ë“œâ€**ê¹Œì§€ ì ìš©í–ˆìŠµë‹ˆë‹¤.</p><h3 id=-ëŒ€ì‹œë³´ë“œ-ê°œìš”>âœ” ëŒ€ì‹œë³´ë“œ ê°œìš”<a hidden class=anchor aria-hidden=true href=#-ëŒ€ì‹œë³´ë“œ-ê°œìš”>#</a></h3><ul><li>ì œëª©: <code>Data Pipeline (daily_user_events) - Logs & Metrics (Compact)</code></li><li>íƒœê·¸: <code>mlops</code>, <code>data-pipeline</code>, <code>loki</code></li><li>í…œí”Œë¦¿ ë³€ìˆ˜:<ul><li><code>datasource</code>: Loki ë°ì´í„°ì†ŒìŠ¤ ì„ íƒ (dev/prod ê³µìš©)</li><li><code>namespace</code>: <code>airflow-dev</code>, <code>airflow-prod</code> ë“± K8s ë„¤ì„ìŠ¤í˜ì´ìŠ¤</li><li><code>pipeline</code>: <code>daily_user_events</code> (í•„ìš” ì‹œ ë‹¤ë¥¸ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥)</li></ul></li></ul><h3 id=-íŒ¨ë„-êµ¬ì„±>âœ” íŒ¨ë„ êµ¬ì„±<a hidden class=anchor aria-hidden=true href=#-íŒ¨ë„-êµ¬ì„±>#</a></h3><ol><li><strong>Data Pipeline Logs ([DP]) â€” Logs íŒ¨ë„</strong><ul><li>ì¿¼ë¦¬ ì˜ˆì‹œ:
<code>{namespace="$namespace"} |= "[DP]" |= "pipeline=$pipeline"</code></li><li>Airflow ë¡œê·¸ ì¤‘ <code>[DP]</code> íƒœê·¸ê°€ ë¶™ì€ ë¡œê·¸ë§Œ í•„í„°ë§í•´ì„œ,<ul><li><code>step=extract_raw_data</code></li><li><code>step=validate_data</code></li><li><code>step=build_features</code></li><li><code>step=store_features</code></li><li><code>step=summarize_run</code>
ë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ í•œëˆˆì— ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li>í•œ ì‹¤í–‰ ì•ˆì—ì„œ ê° ë‹¨ê³„ê°€ ì–´ë–»ê²Œ í˜ë €ëŠ”ì§€, ì–´ë””ì—ì„œ ë©ˆì·„ëŠ”ì§€ë¥¼ <strong>Row ë‹¨ìœ„ ë¡œê·¸</strong>ë¡œ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li><li><strong>Pipeline Runs (summarize_run count) â€” TimeSeries íŒ¨ë„</strong><ul><li>ì¿¼ë¦¬ ì˜ˆì‹œ:
<code>sum by (pipeline) (count_over_time({namespace="$namespace"} |= "[DP]" |= "step=summarize_run" [$__interval]))</code></li><li>ì¼ì • êµ¬ê°„ë§ˆë‹¤ <code>step=summarize_run</code> ë¡œê·¸ê°€ ëª‡ ë²ˆ ë°œìƒí–ˆëŠ”ì§€ë¥¼ ì¹´ìš´íŠ¸í•´ì„œ,<ul><li>íŒŒì´í”„ë¼ì¸ì´ <strong>ì–¸ì œ, ì–¼ë§ˆë‚˜ ìì£¼ ì‹¤í–‰ëëŠ”ì§€</strong></li><li>ì¤‘ê°„ì— ìŠ¤ì¼€ì¤„ì´ ë¹ ì§€ê±°ë‚˜, íŠ¹ì • ì‹œê°„ëŒ€ì— ì‹¤í–‰ì´ ëª°ë¦° êµ¬ê°„ì€ ì—†ëŠ”ì§€
ë¥¼ ì‹œê³„ì—´ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li></ul></li></ul></li></ol><h3 id=-ìš´ì˜ì—ì„œì˜-ì‚¬ìš©-í¬ì¸íŠ¸>âœ” ìš´ì˜ì—ì„œì˜ ì‚¬ìš© í¬ì¸íŠ¸<a hidden class=anchor aria-hidden=true href=#-ìš´ì˜ì—ì„œì˜-ì‚¬ìš©-í¬ì¸íŠ¸>#</a></h3><ul><li><p>ìƒˆ Raw ë°ì´í„°ê°€ ë“¤ì–´ì™”ì„ ë•Œ</p><p>â†’ Logs íŒ¨ë„ì—ì„œ <code>[DP]</code> íë¦„ì„ ë”°ë¼ê°€ë©°</p><p><code>extract_raw_data â†’ validate_data â†’ build_features â†’ store_features â†’ summarize_run</code></p><p>ìˆœì„œëŒ€ë¡œ <strong>ì–´ë””ì—ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€</strong> ë°”ë¡œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></li><li><p>íŠ¹ì • ì‹œê°„ëŒ€ì— íŒŒì´í”„ë¼ì¸ì´ ì•ˆ ëŒì•˜ë‹¤ê³  ì˜ì‹¬ë  ë•Œ</p><p>â†’ TimeSeries íŒ¨ë„ì—ì„œ <code>summarize_run</code> ì¹´ìš´íŠ¸ë¥¼ ë³´ê³ </p><p><strong>í•´ë‹¹ ì‹œê°„ëŒ€ì— ì‹¤í–‰ì´ ìˆì—ˆëŠ”ì§€ / ëª‡ ë²ˆ ìˆì—ˆëŠ”ì§€</strong> ë¹ ë¥´ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></li><li><p>ì£¼ê¸°ì ì¸ ìŠ¤ì¼€ì¤„ ìƒíƒœë¥¼ ë³´ê³  ì‹¶ì„ ë•Œ</p><p>â†’ TimeSeries íŒ¨ë„ì„ <code>Last 24 hours / Last 7 days</code> ë“±ìœ¼ë¡œ ë°”ê¿”ë³´ë©´ì„œ</p><p><strong>â€œë§¤ì¼ ìƒˆë²½ 3ì‹œì— 1íšŒ ì‹¤í–‰â€ ê°™ì€ íŒ¨í„´ì´ ê¹¨ì§„ êµ¬ê°„</strong>ì„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></li></ul><blockquote><p>ì§€ê¸ˆ êµ¬ì„±ì€</p><p><strong>â€œê° ì‹¤í–‰ì˜ ìì„¸í•œ ë‹¨ê³„ ë¡œê·¸(Logs) + ì‹¤í–‰ ë¹ˆë„/íŒ¨í„´(TimeSeries)â€</strong></p><p>ë‘ ê°€ì§€ ê´€ì ìœ¼ë¡œ Data Pipelineì„ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ìµœì†Œ ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤.</p></blockquote><hr><h2 id=-mlops-ì‹¤ì „-ì—°ê²°>ğŸ”§ MLOps ì‹¤ì „ ì—°ê²°<a hidden class=anchor aria-hidden=true href=#-mlops-ì‹¤ì „-ì—°ê²°>#</a></h2><p>ì´ë²ˆ v2 ê³ ë„í™” ë•ë¶„ì—, ì•ìœ¼ë¡œëŠ” ì´ë ‡ê²Œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><ul><li><strong>MLflow</strong><ul><li><code>feature_version</code>, <code>schema.json</code>, <code>metadata.json</code>ì„ í•™ìŠµ ì‹¤í—˜ì— íƒœê·¸/ì•„í‹°íŒ©íŠ¸ë¡œ ì—°ê²°</li></ul></li><li><strong>Feature Store / Data Warehouse</strong><ul><li>versionë³„ feature.csvë¥¼ ë¡œë”© í›„, schema/metadataë¥¼ ê·¸ëŒ€ë¡œ ì¹´íƒˆë¡œê·¸ì— ë°˜ì˜</li></ul></li><li><strong>Observability</strong><ul><li><p>Loki ë¡œê·¸ + S3 êµ¬ì¡° + Grafana ëŒ€ì‹œë³´ë“œë¡œ</p><p>â€œ<strong>ì–´ëŠ ë‚ , ì–´ëŠ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ì´, ì–´ë–¤ ë°ì´í„°ë¥¼ ì–¼ë§ˆë‚˜ ì²˜ë¦¬í•˜ê³ , í’ˆì§ˆì´ ì–´ë• ëŠ”ì§€</strong>â€ë¥¼ ì‹œê³„ì—´ë¡œ ì¶”ì </p></li></ul></li></ul><p>ì¦‰, ì´ë²ˆ ë‹¨ê³„ëŠ” ë‹¨ìˆœíˆ â€œì½”ë“œ ë¦¬íŒ©í† ë§â€ì´ ì•„ë‹ˆë¼,</p><p>â€œë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ML í”Œë«í¼ì˜ ì •ì‹ êµ¬ì„±ì›ìœ¼ë¡œ ìŠ¹ê²©ì‹œí‚¨ ë‹¨ê³„â€ë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><hr><h2 id=-ì •ë¦¬>ğŸ ì •ë¦¬<a hidden class=anchor aria-hidden=true href=#-ì •ë¦¬>#</a></h2><p>ì´ë²ˆ v2 ê³ ë„í™”ê¹Œì§€ ì •ë¦¬í•˜ë©´, ë°ì´í„° íŒŒì´í”„ë¼ì¸ì€ ë‹¤ìŒì„ ëª¨ë‘ ë§Œì¡±í•©ë‹ˆë‹¤.</p><ul><li>S3 RAW ingest</li><li>Extract â†’ Validate â†’ Transform â†’ Load(E2E)</li><li>Airflow DAG orchestration</li><li>Python ê¸°ë°˜ Feature Engineering</li><li>ë²„ì „ ë””ë ‰í„°ë¦¬ ê¸°ë°˜ S3 ì €ì¥ êµ¬ì¡°</li><li><code>feature.csv + schema.json + metadata.json</code> 3ì¢… ì„¸íŠ¸ ìƒì„±</li><li>KST ê¸°ì¤€ íƒ€ì„ë¼ì¸ & ë²„ì „ ID ê´€ë¦¬</li><li>Loki/Grafanaì—ì„œ ì¬êµ¬ì„± ê°€ëŠ¥í•œ í’ë¶€í•œ ì‹¤í–‰ ë¡œê·¸</li><li>Data Pipeline ì „ìš© Grafana ëŒ€ì‹œë³´ë“œ(Logs & Metrics (compact))ë¥¼ í†µí•œ ì‹¤í–‰ ê´€ì¸¡</li></ul><p>ì´ì œ ì´ Data Pipelineì€</p><p>ë‹¨ìˆœ â€œì „ì²˜ë¦¬ ìŠ¤í¬ë¦½íŠ¸â€ë¥¼ ë„˜ì–´ì„œ,</p><p>â€œMLflow & ëª¨ë¸ í•™ìŠµ ìë™í™”ì™€ ë°”ë¡œ ì—°ê²° ê°€ëŠ¥í•œ ë°ì´í„° ë ˆì´ì–´â€ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://keonhoban.github.io/mlops-journey/posts/mlops-platform-observability/07/><span class=title>Next Â»</span><br><span>[MLOps í”Œë«í¼ Observability & Data Pipeline - 7ë‹¨ê³„ : Data Pipeline êµ¬ì¶•]</span></a></nav></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>