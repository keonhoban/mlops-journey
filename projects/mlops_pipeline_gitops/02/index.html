<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)] | ğŸ”ï¸ MLOps Journey</title>
<meta name=keywords content><meta name=description content="ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„

í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.

ğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ)

  
      
          #
          ì„¹ì…˜
      
  
  
      
          0
          ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…)
      
      
          1
          CI ì‹¤í–‰ (GitHub Actions)
      
      
          2
          ArgoCD ìë™ ë™ê¸°í™”
      
      
          3
          Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack)
      
      
          4
          MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸
      
      
          5
          FastAPI í•«ìŠ¤ì™‘ (/reload)
      
      
          6
          ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼)
      
      
          7
          ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS)
      
      
          8
          ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ
      
      
          9
          ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal)
      
      
          10
          íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green)
      
      
          11
          One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦
      
  


0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ)

(GitOps) charts/fastapi/values/{dev,prod}.yamlì—ì„œ ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ git commit â†’ git push
(í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) /ops/ab_test.sh ì €ì¥ (ì•„ë˜ ì œê³µ)


1) ğŸ§ª CI ì§„ì… (GitHub Actions)
"><meta name=author content><link rel=canonical href=https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_gitops/02/><link crossorigin=anonymous href=/mlops-journey/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://keonhoban.github.io/mlops-journey/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://keonhoban.github.io/mlops-journey/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://keonhoban.github.io/mlops-journey/favicon-32x32.png><link rel=apple-touch-icon href=https://keonhoban.github.io/mlops-journey/apple-touch-icon.png><link rel=mask-icon href=https://keonhoban.github.io/mlops-journey/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_gitops/02/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_gitops/02/"><meta property="og:site_name" content="ğŸ”ï¸  MLOps Journey"><meta property="og:title" content="[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]"><meta property="og:description" content="ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„ í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.
ğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ) # ì„¹ì…˜ 0 ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…) 1 CI ì‹¤í–‰ (GitHub Actions) 2 ArgoCD ìë™ ë™ê¸°í™” 3 Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack) 4 MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸ 5 FastAPI í•«ìŠ¤ì™‘ (/reload) 6 ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼) 7 ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS) 8 ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ 9 ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal) 10 íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green) 11 One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦ 0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ) (GitOps) charts/fastapi/values/{dev,prod}.yamlì—ì„œ ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ git commit â†’ git push (í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) /ops/ab_test.sh ì €ì¥ (ì•„ë˜ ì œê³µ) 1) ğŸ§ª CI ì§„ì… (GitHub Actions) "><meta property="og:locale" content="ko"><meta property="og:type" content="article"><meta property="article:section" content="projects"><meta property="article:published_time" content="2025-10-06T17:10:21+09:00"><meta property="article:modified_time" content="2025-10-06T17:10:21+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]"><meta name=twitter:description content="ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„

í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.

ğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ)

  
      
          #
          ì„¹ì…˜
      
  
  
      
          0
          ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…)
      
      
          1
          CI ì‹¤í–‰ (GitHub Actions)
      
      
          2
          ArgoCD ìë™ ë™ê¸°í™”
      
      
          3
          Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack)
      
      
          4
          MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸
      
      
          5
          FastAPI í•«ìŠ¤ì™‘ (/reload)
      
      
          6
          ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼)
      
      
          7
          ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS)
      
      
          8
          ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ
      
      
          9
          ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal)
      
      
          10
          íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green)
      
      
          11
          One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦
      
  


0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ)

(GitOps) charts/fastapi/values/{dev,prod}.yamlì—ì„œ ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ git commit â†’ git push
(í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) /ops/ab_test.sh ì €ì¥ (ì•„ë˜ ì œê³µ)


1) ğŸ§ª CI ì§„ì… (GitHub Actions)
"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"https://keonhoban.github.io/mlops-journey/projects/"},{"@type":"ListItem","position":2,"name":"[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]","item":"https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_gitops/02/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]","name":"[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]","description":"ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„ í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.\nğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ) # ì„¹ì…˜ 0 ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…) 1 CI ì‹¤í–‰ (GitHub Actions) 2 ArgoCD ìë™ ë™ê¸°í™” 3 Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack) 4 MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸ 5 FastAPI í•«ìŠ¤ì™‘ (/reload) 6 ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼) 7 ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS) 8 ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ 9 ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal) 10 íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green) 11 One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦ 0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ) (GitOps) charts/fastapi/values/{dev,prod}.yamlì—ì„œ ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ git commit â†’ git push (í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) /ops/ab_test.sh ì €ì¥ (ì•„ë˜ ì œê³µ) 1) ğŸ§ª CI ì§„ì… (GitHub Actions) ","keywords":[],"articleBody":"ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„ í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.\nğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ) # ì„¹ì…˜ 0 ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…) 1 CI ì‹¤í–‰ (GitHub Actions) 2 ArgoCD ìë™ ë™ê¸°í™” 3 Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack) 4 MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸ 5 FastAPI í•«ìŠ¤ì™‘ (/reload) 6 ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼) 7 ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS) 8 ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ 9 ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal) 10 íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green) 11 One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦ 0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ) (GitOps) charts/fastapi/values/{dev,prod}.yamlì—ì„œ ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ git commit â†’ git push (í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) /ops/ab_test.sh ì €ì¥ (ì•„ë˜ ì œê³µ) 1) ğŸ§ª CI ì§„ì… (GitHub Actions) ğŸ“¸ proof-01-ci.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: Helm Lint / Render / kubeconform ê²€ì¦ì´ devÂ·prod ë§¤íŠ¸ë¦­ìŠ¤ ì „ì²´ ëª¨ë‘ ì„±ê³µ\nğŸ§© ì˜ë¯¸: â€œAll checks have passedâ€ ë¬¸êµ¬ë¥¼ í†µí•´ GitHub Actions CIê°€ ìë™ íŠ¸ë¦¬ê±°ë˜ì–´ í…œí”Œë¦¿Â·ë¦¬ì†ŒìŠ¤ ì •í•©ì„±ì´ ì™„ì „íˆ ë³´ì¥ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n2) ğŸ” ArgoCD ë™ê¸°í™” (ApplicationSet ìë™ ë³µêµ¬) ğŸ“¸ proof-02-argocd-synced.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: airflow, mlflow, fastapi, secrets, namespaces ë“± dev/prod ì „ ì•±ì´ ëª¨ë‘ Healthy / Synced\nâš™ï¸ ì˜ë¯¸: ArgoCD ApplicationSetì˜ SelfHeal/Pruneë¡œ Git(main) ê¸°ì¤€ ìë™ ë³µêµ¬ê°€ ì§€ì† ë™ì‘í•¨ì´ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…ë¨.\n3) ğŸ¯ Airflow í•™ìŠµâ†’ë“±ë¡â†’READY íë¦„ 3-1) Airflow í•™ìŠµ â†’ ë“±ë¡ â†’ READY íë¦„ (Variables ì„¤ì •) ğŸ“¸ proof-03-fail-flow-variables.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: model_name, mlflow_alias, rollback_* ë“± í•µì‹¬ ë³€ìˆ˜ê°€ ëª¨ë‘ Airflowì˜ Fernet Key ê¸°ë°˜ ì•”í˜¸í™”(is_encrypted=true) ìƒíƒœë¡œ ì €ì¥\nğŸ§© ì˜ë¯¸: Airflow DAGì´ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°± ì „ ê³¼ì •ì„ ì œì–´í•  ë³€ìˆ˜ë¥¼ ì •ìƒ ì¸ì‹í•˜ê³  ìˆìœ¼ë©°, í™˜ê²½ë³„(dev/prod) ì‹¤í—˜ íŒŒë¼ë¯¸í„°ê°€ ì¼ê´€ë˜ê²Œ ê´€ë¦¬ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n3-2) Airflow í•™ìŠµ â†’ ë“±ë¡ â†’ READY (MLflow ì—°ë™ ê²°ê³¼) ğŸ“¸ proof-03-fail-flow.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: train_and_evaluateì™€ check_resultê¹Œì§„ Successì§€ë§Œ, ì •í™•ë„(0.8666) \u003c ì„ê³„ê°’(0.9)ìœ¼ë¡œ í‰ê°€ë˜ì–´ notify_failureê°€ íŠ¸ë¦¬ê±°ë˜ê³  ì´í›„ íƒœìŠ¤í¬(check_model_ready, trigger_reload)ëŠ” ìë™ ìŠ¤í‚µë¨\nğŸ§© ì˜ë¯¸: ì •í™•ë„ ì„ê³„ì¹˜ ë¯¸ë‹¬ ì‹œ í•™ìŠµ íŒŒì´í”„ë¼ì¸ì´ ìë™ ì¤‘ë‹¨ë˜ê³  Slack ì•Œë¦¼ìœ¼ë¡œ ì‹¤íŒ¨ íë¦„ì´ ì „ë‹¬ë˜ëŠ” ìë™ Fail-safe ë¡œì§ì´ ì •ìƒ ì‘ë™í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n3-3) Airflow FAIL FLOW (Slack ì•Œë¦¼ ê²€ì¦) ğŸ“¸ proof-03-fail-flow-slack.png\nâš ï¸ í™•ì¸ í¬ì¸íŠ¸: Validation failed â†’ ì…ë ¥ê°’ 20 ëŒ€ì‹  ê¸°ë³¸ê°’ 200 ì‚¬ìš© ë° ê¸°ì¤€ ë¯¸ë‹¬ â†’ ë“±ë¡ ë° í•«ìŠ¤ì™‘ ìƒëµ ë©”ì‹œì§€ê°€ Slack ì±„ë„(dev)ë¡œ ì‹¤ì‹œê°„ ì „ì†¡\nğŸ§© ì˜ë¯¸: ì •í™•ë„ ì„ê³„ì¹˜(0.9) ë¯¸ë‹¬ ì‹œ DAGì˜ ì‹¤íŒ¨ ì•Œë¦¼ì´ Slackìœ¼ë¡œ ì¦‰ì‹œ í†µë³´ë˜ì–´, ì‹¤íŒ¨ ë£¨í”„ê°€ Airflowâ€“Slack ê°„ ì™„ì „ ìë™í™”ë˜ì–´ ìˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤\n3-4) Airflow SUCCESS FLOW (í•™ìŠµ â†’ ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘) (dev / prod í™˜ê²½) ğŸ“¸ proof-03-airflow-dag-success-dev.png\nğŸ“¸ proof-03-airflow-dag-success-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: train_and_evaluate â†’ check_result â†’ register_model â†’ check_model_ready â†’ trigger_reload ì „ ë‹¨ê³„ê°€ ëª¨ë‘ Success, (* notify_failureëŠ” ìŠ¤í‚µë¨)\nğŸ§© ì˜ë¯¸: ì •í™•ë„ ì„ê³„ê°’(0.9) ì´ìƒ ë‹¬ì„± í›„ ì „ì²´ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘ ì²´ì¸ì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìœ¼ë©°, FastAPI /reload íŠ¸ë¦¬ê±°ê¹Œì§€ ìë™í™”ë˜ì–´ ì™„ì „í•œ SUCCESS FLOWê°€ ê²€ì¦ë¨\n3-5) FastAPI ëª¨ë¸ ë¡œë“œ ê²€ì¦ (dev / prod í™˜ê²½) ğŸ“¸ proof-03-fastapi-model-load(dev,prod).png\nâœ… í™•ì¸ í¬ì¸íŠ¸: https://fastapi.local ë° https://fastapi.prod ê°ê°ì—ì„œ /ê³¼ /health ì‘ë‹µì— â€œloaded_variantsâ€: [â€œAâ€,â€œBâ€] í™•ì¸\nğŸ§© ì˜ë¯¸: devÂ·prod í™˜ê²½ ëª¨ë‘ì—ì„œ FastAPI ì¸ìŠ¤í„´ìŠ¤ê°€ ìµœì‹  ëª¨ë¸ A/Bë¥¼ ì •ìƒì ìœ¼ë¡œ ë¡œë“œí•˜ê³  ìˆìœ¼ë©°, /predict, /reload, /models, /health ì—”ë“œí¬ì¸íŠ¸ ì „ì²´ê°€ TLS ê¸°ë°˜ìœ¼ë¡œ ì •ìƒ ì‘ë‹µí•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n3-6) FastAPI ëª¨ë¸ ë“±ë¡ ë° í•«ìŠ¤ì™‘ Slack ì•Œë¦¼ (dev / prod í™˜ê²½) ğŸ“¸ proof-03-model-load-slack(dev).png\nğŸ“¸ proof-03-model-load-slack(prod).png\nâœ… í™•ì¸ í¬ì¸íŠ¸: best_model v1 â†’ @A, best_model v2 â†’ @B ë“±ë¡ ì™„ë£Œ ë©”ì‹œì§€ì™€ í•¨ê»˜ ê° run_idê°€ Slackìœ¼ë¡œ ì‹¤ì‹œê°„ ì „ì†¡\nğŸ§© ì˜ë¯¸: Airflowì—ì„œ MLflow ë“±ë¡ ì™„ë£Œ í›„ FastAPI í•«ìŠ¤ì™‘ì´ ìë™ ìˆ˜í–‰ë˜ë©°, dev,prod í™˜ê²½ì˜ Slack Webhookì„ í†µí•´ A/B ëª¨ë¸ ì „í™˜ ë° ì‹¤í–‰ ì´ë ¥(run_id) ì´ íˆ¬ëª…í•˜ê²Œ ì¶”ì ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n3-7) ArgoCD Self-Heal Test (ë“œë¦¬í”„íŠ¸ ìë™ ë³µêµ¬) ğŸ“¸ proof-03-drift-self-heal-test.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: ìˆ˜ë™ìœ¼ë¡œ fastapi-dev-serverì˜ CANARY_PERCENT ê°’ì„ 31ë¡œ ë³€ê²½ í›„ ArgoCD ë™ê¸°í™”ë¡œ ë‹¤ì‹œ 20ìœ¼ë¡œ ë³µì›ë¨\nğŸ§© ì˜ë¯¸: í´ëŸ¬ìŠ¤í„° ë‚´ ìˆ˜ë™ ë³€ê²½(ë“œë¦¬í”„íŠ¸)ì´ ë°œìƒí•˜ë”ë¼ë„ ArgoCDì˜ SelfHeal ê¸°ëŠ¥ì´ Git ìƒíƒœ(main branch) ê¸°ì¤€ìœ¼ë¡œ ìë™ ë³µêµ¬í•˜ì—¬ GitOps ë¶ˆë³€ì„±ì´ ìœ ì§€ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n4) ğŸ—‚ï¸ MLflow ë“±ë¡/ë³„ì¹­/ì•„í‹°íŒ©íŠ¸ 4-1) MLflow ë“±ë¡ ë° Alias ë°”ì¸ë”© (Airflow Variables) ğŸ“¸ proof-04-airflow-variables.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: mlflow_alias=B, rollback_alias=A, rollback_version=1 ë“± ë³€ìˆ˜ ìƒíƒœê°€ ì •í™•íˆ ë°˜ì˜ë˜ì–´ ìˆìŒ\nğŸ§© ì˜ë¯¸: Airflow DAG ì‹¤í–‰ ê²°ê³¼, ì‹ ê·œ ëª¨ë¸ì´ best_model v2 â†’ Bë¡œ ë“±ë¡ë˜ê³  ê¸°ì¡´ ë²„ì „ì€ rollback_version=1 (A)ë¡œ ìœ ì§€ë˜ì–´, A/B alias ì „í™˜ íë¦„ì´ ë³€ìˆ˜ ë‹¨ê³„ì—ì„œ ëª…í™•íˆ ê´€ë¦¬ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n4-2) MLflow ë“±ë¡ ë° Alias ë°”ì¸ë”© (dev, prod í™˜ê²½) ğŸ“¸ proof-04-mlflow-alias-dev.png\nğŸ“¸ proof-04-mlflow-alias-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: best_modelì´ Version 2ë¡œ ìƒˆë¡œ ë“±ë¡ë˜ë©°, alias @B: Version 2, @A: Version 1ì˜ ì´ì¤‘ alias ì²´ê³„ê°€ ëª…í™•íˆ í‘œì‹œë¨\nğŸ§© ì˜ë¯¸: Airflow DAG ì‹¤í–‰ ê²°ê³¼, MLflow Registry ë‚´ì—ì„œ ì‹ ê·œ ë²„ì „ì´ ìë™ ë“±ë¡ë˜ê³ , ê¸°ì¡´/ì‹ ê·œ ëª¨ë¸ì´ ê°ê° A/B aliasë¡œ ë°”ì¸ë”©ë˜ì–´ ë²„ì „ ê´€ë¦¬ ë° ì‹¤í—˜ ì „í™˜ ì²´ê³„ê°€ ì™„ì „í•˜ê²Œ êµ¬í˜„ë˜ì—ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤\n4-3) MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½) ğŸ“¸ proof-04-mlflow-artifacts-dev.png\nğŸ“¸ proof-04-mlflow-artifacts-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: model.pkl, conda.yaml, python_env.yaml ë“± ëª¨ë¸ ë©”íƒ€ë°ì´í„°ì™€ í™˜ê²½ ì •ë³´ê°€ s3://mlflow-artifacts-keonho/{dev, prod}/â€¦ ê²½ë¡œì— í™˜ê²½ë³„ë¡œ ë¶„ë¦¬ë˜ì–´ ì •ìƒ ì €ì¥ë¨\nğŸ§© ì˜ë¯¸: MLflowê°€ í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ê³¼ ì‹¤í–‰ í™˜ê²½ì„ ì•„í‹°íŒ©íŠ¸ë¡œ ë²„ì „ë³„ ë³´ê´€í•˜ë©°, ì¶”í›„ FastAPI ì„œë¹™ ì‹œ ë™ì¼ í™˜ê²½ ì¬í˜„ì´ ê°€ëŠ¥í•œ ì¬í˜„ì„± ìˆëŠ” MLOps íŒŒì´í”„ë¼ì¸ì´ í™•ë³´ë˜ì—ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤\n5) âš¡ FastAPI í•«ìŠ¤ì™‘ 5-1) FastAPI í•«ìŠ¤ì™‘ ê²€ì¦ (dev, prod í™˜ê²½) ğŸ“¸ proof-05-fastapi-reload-dev.png\nğŸ“¸ proof-05-fastapi-reload-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: /variant/A/reload, /variant/B/reload í˜¸ì¶œ ì‹œ ê°ê° version: â€œ1â€, â€œ2\"ë¡œ ì‘ë‹µí•˜ë©° â€œstatusâ€: â€œsuccessâ€ ë°˜í™˜\nâš™ï¸ ì˜ëª»ëœ í† í°(Super_Secret_Token) ì‚¬ìš© ì‹œ Access denied, ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ ì‹œ Not Found ë°˜í™˜\nğŸ§© ì˜ë¯¸: FastAPIê°€ dev, prod í™˜ê²½ë³„ë¡œ í† í° ì¸ì¦Â·ì—”ë“œí¬ì¸íŠ¸ ê²€ì¦ì„ ëª¨ë‘ í†µê³¼í•˜ë©° ìµœì‹  ëª¨ë¸ ë²„ì „ìœ¼ë¡œ ì •ìƒ êµì²´ë¨ì„ í™•ì¸ â€” ë³´ì•ˆÂ·ë¬´ì¤‘ë‹¨ í•«ìŠ¤ì™‘ ì²´ê³„ê°€ ì™„ë²½íˆ ë™ì‘í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n5-2) FastAPI í•«ìŠ¤ì™‘ Slack ì•Œë¦¼ (dev, prod í™˜ê²½) ğŸ“¸ proof-05-fastapi-reload-slack-dev.png\nğŸ“¸ proof-05-fastapi-reload-slack-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: [FastAPI] ëª¨ë¸ A í•«ìŠ¤ì™‘ ì™„ë£Œ: v1, [FastAPI] ëª¨ë¸ B í•«ìŠ¤ì™‘ ì™„ë£Œ: v2 ë©”ì‹œì§€ì™€ í•¨ê»˜ ê° run_idê°€ Slack ì±„ë„(dev, prod)ì— ì •ìƒ ì „ì†¡\nğŸ§© ì˜ë¯¸: FastAPI /variant/{alias}/reload ì„±ê³µ ì‹œ, ê° ëª¨ë¸ ë²„ì „ì˜ ì „í™˜ ê²°ê³¼ê°€ Slack Webhookì„ í†µí•´ ì‹¤ì‹œê°„ í†µë³´ë˜ì–´ í•«ìŠ¤ì™‘ ì™„ë£Œ ì•Œë¦¼ ë£¨í”„(dev, prod) ê°€ ì™„ë²½íˆ ë™ì‘í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤\n6) ğŸ”„ ìˆ˜ë™ ë¡¤ë°±(ìš´ì˜ ë³µêµ¬ ë ˆì¼) 6-1) ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ë ˆì¼ â€“ Airflow Variables) ğŸ“¸ proof-06-airflow-variables.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: rollback_version=1, rollback_alias=B, mlflow_alias=B, model_name=best_model ë“± ë¡¤ë°± ê´€ë ¨ ë³€ìˆ˜ë“¤ì´ ì •í™•íˆ ì„¸íŒ…ë¨\nğŸ§© ì˜ë¯¸: Airflow ìˆ˜ë™ ë¡¤ë°± DAG ì‹¤í–‰ ì „, ë³µêµ¬ ëŒ€ìƒ ë²„ì „ê³¼ ëª¨ë¸ aliasê°€ ëª…í™•íˆ ì§€ì •ë˜ì–´ ìˆì–´ ì•ˆì •ì ì¸ ìš´ì˜ ë³µêµ¬ í”Œë¡œìš°(rollbackâ†’reload)ê°€ ì¤€ë¹„ëœ ìƒíƒœì„ì„ ì¦ëª…í•©ë‹ˆë‹¤\n6-2) ìˆ˜ë™ ë¡¤ë°± (ë¡¤ë°± ì „ FastAPI ìƒíƒœ) ğŸ“¸ proof-06-before-fastapi.png\nâœ… í™•ì¸ í¬ì¸íŠ¸: devÂ·prod í™˜ê²½ ëª¨ë‘ /models ì‘ë‹µì—ì„œ A: Version 1, B: Version 2ë¡œ í‘œì‹œë˜ì–´ ìˆìŒ\nğŸ§© ì˜ë¯¸: ë¡¤ë°± ì‹¤í–‰ ì „, FastAPIê°€ ìµœì‹  ëª¨ë¸(B: Version 2)ì„ Productionìœ¼ë¡œ ì‚¬ìš© ì¤‘ì´ë©°, ê¸°ì¡´ ë²„ì „(A:1) ì´ ì—¬ì „íˆ ë³´ì¡´ë˜ì–´ ìˆëŠ” ìƒíƒœë¡œ ì•ˆì „í•œ ë³µêµ¬ ì „ ì¤€ë¹„ ìƒíƒœë¥¼ ì¦ëª…í•©ë‹ˆë‹¤\n6-3) ìˆ˜ë™ ë¡¤ë°± (DAG ìˆ˜í–‰ ê²°ê³¼ â€“ dev, prod í™˜ê²½) ğŸ“¸ proof-06-rollback-dag-dev.png\nğŸ“¸ proof-06-rollback-dag-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\nDAG ì´ë¦„: manual_rollback_model_dev rollback_model_alias â†’ reload_fastapi_model ìˆœì„œë¡œ ë‘ Task ëª¨ë‘ success ìƒíƒœ ì´ ìˆ˜í–‰ ì‹œê°„ ì•½ 29ì´ˆ, ì‹¤íŒ¨Â·ì§€ì—° ì—†ì´ ì™„ë£Œ ğŸ§© ì˜ë¯¸:\nAirflow DAGì´ rollback_aliasì™€ rollback_version ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ MLflow aliasë¥¼ Aë¡œ ë³µêµ¬í•˜ê³ , FastAPI /reload í˜¸ì¶œì„ ìë™ íŠ¸ë¦¬ê±°í•˜ì—¬ ì´ì „ ëª¨ë¸ ë²„ì „ì„ ë‹¤ì‹œ ì„œë¹™í•˜ëŠ” ì™„ì „í•œ ìë™ ë³µêµ¬ í”Œë¡œìš°ê°€ ì •ìƒ ë™ì‘í–ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.\n6-4) ìˆ˜ë™ ë¡¤ë°± (ë¡¤ë°± í›„ FastAPI ìƒíƒœ) ğŸ“¸ after-fastapi.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\ndevÂ·prod í™˜ê²½ ëª¨ë‘ /models ì‘ë‹µì—ì„œ A: Version 1, B: Version 1ë¡œ ë™ì¼í•˜ê²Œ ë³µêµ¬ë¨ rollback ëŒ€ìƒ run_id=4a59f6b6acbc45a6a6ec91b8ad28d485ê°€ dev/prod ì–‘ìª½ì— ë™ì¼í•˜ê²Œ ë°˜ì˜ë¨ ğŸ§© ì˜ë¯¸:\nAirflow ìˆ˜ë™ ë¡¤ë°± DAG ì‹¤í–‰ ì´í›„, FastAPI ì„œë¹™ ë ˆì´ì–´ì—ì„œ A/B ëª¨ë‘ ì´ì „ ëª¨ë¸ ë²„ì „(1) ìœ¼ë¡œ ë³µì›ë¨ì„ í™•ì¸.\nì¦‰, MLflow â†’ Airflow â†’ FastAPI ì „ êµ¬ê°„ì´ ì—°ê²°ëœ ë¬´ì¤‘ë‹¨ ë³µêµ¬ íŒŒì´í”„ë¼ì¸ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í–ˆìŒì„ ì™„ë²½íˆ ì¦ëª…í•©ë‹ˆë‹¤.\n7) ğŸ“‘ ë¡œê·¸ ìŠ¤í† ë¦¬ì§€(S3+NFS) 7-1) Airflow ë¡œê·¸ S3 ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½) ğŸ“¸ proof-07-logs-airflow-s3-dev.png\nğŸ“¸ proof-07-logs-airflow-s3-prod.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\në²„í‚· ê²½ë¡œ: s3://airflow-logs/dag_id=manual_rollback_model_dev/ íƒœìŠ¤í¬: task_id=reload_fastapi_model/ ë¡œê·¸ íŒŒì¼: attempt=1.log (2025-10-10 19:45:10 KST ì €ì¥) ğŸ§© ì˜ë¯¸:\nAirflowê°€ manual_rollback_model_dev DAG ì‹¤í–‰ ë¡œê·¸ë¥¼ S3 ë²„í‚·ì— ìë™ ì—…ë¡œë“œí•˜ì—¬ ëª¨ë“  ë³µêµ¬ ì‹¤í–‰ ì´ë ¥(rollbacks \u0026 reloads) ì´ ì¤‘ì•™í™”ëœ ì €ì¥ì†Œì— ì•ˆì „í•˜ê²Œ ê¸°ë¡ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.\nì´ëŠ” ìš´ì˜ ê°€ì‹œì„± í™•ë³´ + ì¥ì•  ì›ì¸ ì¶”ì  + ê°ì‚¬ ë¡œê·¸(Audit Log) ì²´ê³„ì˜ í•µì‹¬ ê¸°ë°˜ì…ë‹ˆë‹¤.\n7-2) FastAPI ë¡œê·¸ NFS ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½) ğŸ“¸ proof-07-logs-fastapi-nfs.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\në¡œê·¸ ê²½ë¡œ: /mnt/nfs_share/mlops/fastapi/logs/{dev,prod}/fastapi.log ì£¼ìš” ë¡œê·¸: [âœ”] ëª¨ë¸ ë¡œë”© ì„±ê³µ : alias=A, version=1 [âœ”] ëª¨ë¸ ë¡œë”© ì„±ê³µ : alias=B, version=2 ë¡¤ë°± ì´í›„ ì¬ì‹œì‘ ì‹œì—ë„ ë™ì¼í•œ aliasÂ·version ë¡œë“œ ë‚´ì—­ì´ ê¸°ë¡ë¨ ğŸ§© ì˜ë¯¸:\nFastAPI ì¸ìŠ¤í„´ìŠ¤ê°€ dev/prod ì–‘ìª½ì—ì„œ NFS ë§ˆìš´íŠ¸ ê¸°ë°˜ ì¤‘ì•™ ë¡œê·¸ ìˆ˜ì§‘ì„ ìˆ˜í–‰ ì¤‘ì´ë©°,\nëª¨ë¸ ë¡œë“œ ì´ë²¤íŠ¸(A/B, ë²„ì „ ë³€ë™ í¬í•¨)ê°€ íŒŒì¼ ë‹¨ìœ„ë¡œ ê¸°ë¡ë¨ì„ í™•ì¸.\nì´ëŠ” ì‹¤ì‹œê°„ ë³µêµ¬ ê²€ì¦ ë° ì¶”ì  ê°€ëŠ¥í•œ ëª¨ë¸ ì„œë¹™ ë¡œê·¸ ì²´ê³„ê°€ êµ¬ì¶•ë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\n8) ğŸ›°ï¸ ArgoCDâ†”ï¸Slack ê´€ì œ ë£¨í”„ ğŸ“¸ proof-08-argocd-slack.png\nğŸ“¸ proof-08-argocd-slack-2.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\nairflow-dev, airflow-prod, fastapi-logs-storage-dev/prod, prod-secrets ë“± ì£¼ìš” ì•±ì˜ ìƒíƒœ ë³€í™”ê°€ Slack ì±„ë„(argocd)ì— ìë™ ì „ì†¡ ìƒíƒœ ì „ì´ ê°ì§€: Sync OutOfSync â†’ Health Healthy Health Degraded â†’ Healthy Sync Failed ì‹œ âŒ Error ë©”ì‹œì§€ í¬í•¨ ë§í¬(Open in ArgoCD)ë¡œ ì¦‰ì‹œ ArgoCD UI ì ‘ê·¼ ê°€ëŠ¥ ğŸ§© ì˜ë¯¸:\nArgoCDì™€ Slackì´ ì™„ì „ ì—°ë™ë˜ì–´, ë°°í¬Â·SyncÂ·Health ìƒíƒœ ë³€í™”ê°€ ì‹¤ì‹œê°„ ê°ì‹œ ì²´ê³„ë¡œ í†µí•©ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.\nì¦‰, ëª¨ë¸ ë¡¤ë°±Â·í•«ìŠ¤ì™‘Â·ì¬ë°°í¬ í›„ì—ë„ ëª¨ë“  ArgoCD Applicationì˜ Sync/Health ìƒíƒœê°€ ìë™ìœ¼ë¡œ ë³µì›Â·ë³´ê³ ë˜ëŠ” ììœ¨ ê°ì‹œ ë£¨í”„ê°€ êµ¬ì¶•ëœ ê²ƒì…ë‹ˆë‹¤.\n9) ğŸ” ë³´ì•ˆ ìë™í™”(í¬ë¦¬ë´ì…œ/ì‹œí¬ë¦¿) 9-1-a) AWS Credentials Secret Rotation (Before ìƒíƒœ) ğŸ“¸ proof-09-rotation-resourceversion-before.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\ní™•ì¸ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤: airflow-dev, fastapi-dev, mlflow-dev, airflow-prod, fastapi-prod, mlflow-prod ê° Secret(aws-credentials-secret)ì˜ resourceVersion ê°’ì´ ëª¨ë‘ ì„œë¡œ ë‹¤ë¦„ (21xxxxëŒ€) ì•„ì§ ë™ê¸°í™”(íšŒì „) ì „ ìƒíƒœì„ ğŸ§© ì˜ë¯¸:\nSecret rotation ì‹¤í–‰ ì „ì˜ baseline snapshotìœ¼ë¡œ,\ní™˜ê²½ë³„ AWS Credentials Secret ë¦¬ì†ŒìŠ¤ ë²„ì „ì´ ìƒì´í•¨ì„ ëª…í™•íˆ ê¸°ë¡í•¨.\nì´í›„ rotation ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í›„ ì´ ê°’ë“¤ì´ ê°±ì‹ ë˜ì–´ì•¼ ì •ìƒ ë™ì‘ìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.\nì¦‰, ì´ ì´ë¯¸ì§€ëŠ” í‚¤ íšŒì „ ì „ ì •ìƒ baseline ìƒíƒœë¥¼ ì¦ëª…í•©ë‹ˆë‹¤.\n9-1-b) AWS Credentials Secret Rotation (ì´ì „ í‚¤ ì¤‘ë³µ ê°ì§€ ì‹¤íŒ¨ ì‚¬ë¡€) ğŸ“¸ proof-09-rotation-oldkeys-fails.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\nì‹¤í–‰ ëª…ë ¹: bash rotate-aws-credentials.sh dev IAM User: mlflow-airflow-user ê°ì§€ëœ ê¸°ì¡´ í‚¤: AKIA********CB7Z ì—ëŸ¬ ë©”ì‹œì§€: ERROR: mlflow-airflow-userì— ì´ë¯¸ í‚¤ 2ê°œ ì¡´ì¬. í•˜ë‚˜ ë¹„í™œì„±/ì‚­ì œ í›„ ì¬ì‹œë„. ğŸ§© ì˜ë¯¸:\nIAM ì‚¬ìš©ìì˜ ì•¡ì„¸ìŠ¤ í‚¤ê°€ ì´ë¯¸ ë‘ ê°œ ëª¨ë‘ í™œì„± ìƒíƒœì—¬ì„œ,\nìƒˆ í‚¤ë¥¼ ë°œê¸‰í•  ìˆ˜ ì—†ë‹¤ëŠ” AWS ì œí•œ(ìµœëŒ€ 2ê°œ)ìœ¼ë¡œ íšŒì „ í”„ë¡œì„¸ìŠ¤ê°€ ì•ˆì „í•˜ê²Œ ì¤‘ë‹¨ë¨.\nì¦‰, ìŠ¤í¬ë¦½íŠ¸ì˜ ì‚¬ì „ ê²€ì¦ ë¡œì§ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì—¬ ì¤‘ë³µ ë°œê¸‰ ë°©ì§€ ê¸°ëŠ¥ì´ ìœ íš¨í•¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.\n9-1-c) AWS Credentials Secret Rotation (íšŒì „ ë° ArgoCD ë°˜ì˜ ì™„ë£Œ) (dev, prod í™˜ê²½) ğŸ“¸ proof-09-rotation-rotate-log-dev-1.png\nğŸ“¸ proof-09-rotation-rotate-log-dev-2.png\nğŸ“¸ proof-09-rotation-rotate-log-prod-1.png\nğŸ“¸ proof-09-rotation-rotate-log-prod-2.png\nâœ… í™•ì¸ í¬ì¸íŠ¸:\ndev IAM User: mlflow-airflow-dev-user ìƒˆ í‚¤: AKIA********IH5 feat(dev): rotate AWS credentials across airflow/fastapi/mlflow ì»¤ë°‹ /root/backup/...json ë°±ì—… ì™„ë£Œ ArgoCD dev-secrets â†’ Sync Succeeded, ëª¨ë“  SealedSecret Synced / Healthy resourceVersion ì¦ê°€ í™•ì¸ (2161301 â†’ 2162096) prod IAM User: mlflow-airflow-user ìƒˆ í‚¤: AKIA********GH feat(prod): rotate AWS credentials across airflow/fastapi/mlflow ì»¤ë°‹ ArgoCD prod-secrets â†’ Sync Succeeded, ëª¨ë“  SealedSecret Synced / Healthy resourceVersion ì¦ê°€ í™•ì¸ (2148011 â†’ 2162479) ëª¨ë“  ë‹¨ê³„ì—ì„œ GitHub Push â†’ ArgoCD Auto Sync â†’ SealedSecret ì ìš© â†’ AWS CLI ê²€ì¦ â†’ êµ¬ í‚¤ Inactive ê¶Œê³  ë©”ì‹œì§€ê¹Œì§€ ìë™ ì¶œë ¥. í‚¤ íšŒì „ í›„ ì„œë¹„ìŠ¤ ì˜í–¥ ì—†ì´ ì •ìƒ ìš´ì˜ ìœ ì§€. ğŸ§© ì˜ë¯¸:\ndev/prod ì „ êµ¬ê°„ì˜ AWS ìê²© ì¦ëª…ì´\në‹¨ì¼ ëª…ë ¹ìœ¼ë¡œ ì™„ì „ ìë™ íšŒì „ + GitOps ì—°ë™ + ë¬´ì¤‘ë‹¨ ë°˜ì˜ë¨ì„ ì…ì¦.\nì¦‰, ë³´ì•ˆ/ìš´ì˜/ìë™í™” 3ìš”ì†Œê°€ ì™„ë²½íˆ í†µí•©ëœ SealedSecret ê¸°ë°˜ Key Rotation êµ¬ì¡°ì„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.\n9-1-d) AWS Credentials Secret Rotation (ë¦¬ì†ŒìŠ¤ ë²„ì „ ë¹„êµ ì¦ëª…) ğŸ“¸ proof-09-rotation-resourceversion-after.png\nâœ… ë³€ê²½ ì „ (before) â†’ ë³€ê²½ í›„ (after) ë¹„êµ\nNamespace Secret Before After ì¦ê°€ ì—¬ë¶€ airflow-dev aws-credentials-secret 2161270 2161994 âœ… fastapi-dev aws-credentials-secret 2161277 2162035 âœ… mlflow-dev aws-credentials-secret 2161301 2162098 âœ… airflow-prod aws-credentials-secret 2148004 2162742 âœ… fastapi-prod aws-credentials-secret 2147983 2162770 âœ… mlflow-prod aws-credentials-secret 2148011 2162749 âœ… ğŸ” ëª¨ë“  dev/prod Secretì˜ resourceVersionì´ ì¦ê°€í–ˆìœ¼ë©°,\nì´ëŠ” SealedSecret â†’ Secret â†’ Pod ë°˜ì˜ê¹Œì§€ ìë™ ì—…ë°ì´íŠ¸ëœ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.\nArgoCD Sync, AWS CLI ê²€ì¦, êµ¬ í‚¤ Inactive í™•ì¸ê¹Œì§€ ì¼ë ¨ì˜ ìë™í™” ì²´ì¸ì´\nì •ìƒì ìœ¼ë¡œ ë™ì‘í•¨ì„ ìµœì¢…ì ìœ¼ë¡œ ì…ì¦í•©ë‹ˆë‹¤.\n9-1-e) AWS Credentials Secret Rotation (ArgoCD ìµœì¢… ìƒíƒœ ê²€ì¦) ğŸ“¸ proof-09-rotation-argocd-synced.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nArgoCD ì•± dev-secrets, prod-secrets ëª¨ë‘\nStatus: Healthy / Synced Last Synced: 2025-10-15 14:26~14:28 (íšŒì „ ì§í›„ ëª‡ ì´ˆ ë‚´ ìë™ ë™ê¸°í™”) Git ë¦¬í¬ì§€í† ë¦¬: https://github.com/keonhoban/mlops-infra-gitops Path: envs/dev/sealed-secrets, envs/prod/sealed-secrets ì˜ë¯¸: í‚¤ íšŒì „ ì§í›„ ìë™ìœ¼ë¡œ GitOps ë°˜ì˜ì´ ì™„ë£Œë˜ì–´\nìˆ˜ë™ intervention ì—†ì´ ëª¨ë“  Secretì´ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€ë¨.\nğŸ§© ì˜ë¯¸:\ndev, prod ì „ í™˜ê²½ì˜ AWS Credentials Secret Rotation ìë™í™” ë£¨í”„ê°€ ì™„ì „íˆ íì‡„(Closed Loop) ë˜ì—ˆìŠµë‹ˆë‹¤.\nSealedSecret â†’ Secret â†’ Pod â†’ ArgoCD â†’ Git â†’ AWSê¹Œì§€\në‹¨ì¼ ëª…ë ¹(bash rotate-aws-credentials.sh )ë¡œ ì „ ê³¼ì •ì´ ìë™í™”ë˜ê³ ,\në¬´ì¤‘ë‹¨Â·ë¬´ì¸ ê°œì…Â·ì™„ì „ ê°€ì‹œí™” ìˆ˜ì¤€ì˜ ìš´ì˜ ì²´ê³„ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.\n9-2-a) SealedSecret Controller \u0026 Re-seal (ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ ì¬ë°œê¸‰ ë° fingerprint ê²€ì¦) ğŸ“¸ proof-09-reseal-pub-cert-fingerprint-diff.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nì‹ ê·œ Controller fingerprint: CE:1C:D4:0D:F4:C5:B6:CB:02:C1:F5:85:08:6E:36:E1:70:CA:E9:31:15:0F:4B:77:EC:F0:A4:19:E6:FC:49:8C dev/prod í™˜ê²½ ëª¨ë‘ ì¬seal ì™„ë£Œ, GitOps main ë°˜ì˜ ë° ì¼ì¹˜ ê²€ì¦ OK ğŸ§© ì˜ë¯¸\nSealedSecret ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ê°€ êµì²´ë˜ì–´ ëª¨ë“  ì‹œí¬ë¦¿ì´ ìµœì‹  ê³µê°œí‚¤ë¡œ ì•”í˜¸í™”ë¨. í‚¤ íšŒì „ í›„ ë¬´ì¤‘ë‹¨ GitOps í™˜ê²½ì´ ì •ìƒ ìœ ì§€ë¨ì„ ì¦ëª…. 9-2-b) SealedSecret Controller \u0026 Re-seal (ArgoCD ë°˜ì˜ í™•ì¸) ğŸ“¸ proof-09-reseal-argocd-synced.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\ndev/prod ì „ ì•±(airflow, mlflow, fastapi, secrets, logs, notifications ë“±) ìƒíƒœ: Healthy Â· Synced Controller í‚¤ íšŒì „ ì´í›„ ëª¨ë“  SealedSecret ì¬ë°°í¬ ì™„ë£Œ ğŸ’¡ ì˜ë¯¸\nRe-Seal ì‘ì—…ì´ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì •ìƒ ë°˜ì˜ë˜ì—ˆìŒì„ ì¦ëª…. í‚¤ êµì²´ í›„ ArgoCD GitOps íŒŒì´í”„ë¼ì¸ ì „ì²´ê°€ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€ë¨. 10) ğŸš¦íŠ¸ë˜í”½ ì‹¤í—˜ â€” A/B Â· Canary Â· Blue-Green FastAPIì˜ ë¼ìš°íŒ…ì€ valuesë¡œ ì œì–´ë©ë‹ˆë‹¤.\nìš´ì˜ ì¤‘ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ ì—†ì´ íŠ¸ë˜í”½ë§Œ ì¡°ì ˆí•˜ë ¤ë©´\nA/B/Canary/Blue-Green ì¤‘ Canary/Blue-Green ê¶Œì¥\n(GitOps: charts/fastapi/values/{dev,prod}.yaml â†’ ALIAS_SELECTION_MODE, DEFAULT_ALIAS, CANARY_PERCENT)\ní•©ê²© ê¸°ì¤€ í‘œ\nA/BëŠ” í†µê³„ì  ì‹¤í—˜(90:10) CanaryëŠ” ì ì§„ ë°°í¬(10~30%) Blue-Greenì€ ì™„ì „ ì „í™˜(100%) ìœ í˜• values ì„¤ì • ê¸°ëŒ€ ë¶„í¬ A/B ALIAS_SELECTION_MODE=ab_test A/B â‰ˆ 90:10 Canary(n%) ALIAS_SELECTION_MODE=canary,CANARY_PERCENT=30 B â‰ˆ 30% Blue-Green ALIAS_SELECTION_MODE=blue_green,DEFAULT_ALIAS=B B = 100% ğŸ“ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ (A/BÂ·CanaryÂ·Blue-Green ê³µìš©) íŒŒì¼: /ops/ab_test.sh\n#!/bin/bash # ab_test.sh â€” A/B/Canary/Blue-Green ë¶„í¬ ê²€ì¦ # ì‚¬ìš©: ./ab_test.sh [N] (ê¸°ë³¸ N=200) set -euo pipefail N=${1:-200} URL=${FASTAPI_URL:-\"https://fastapi.local\"} PAYLOAD='{\"data\": [[5.1, 3.5, 1.4, 0.2]]}' echo \"ğŸ” A/BÂ·CanaryÂ·Blue-Green ë¶„í¬ í™•ì¸ (${N}ê±´)\" : \u003e ab_test_result.log for i in $(seq 1 $N); do id=\"client_$i\" variant=$(curl -sk \"${URL}/predict\" \\ -H \"Content-Type: application/json\" \\ -H \"x-client-id: ${id}\" \\ -d \"${PAYLOAD}\" | jq -r '.variant') echo \"$id â†’ $variant\" | tee -a ab_test_result.log \u003e/dev/null done count_B=$(grep -c \"â†’ B\" ab_test_result.log || true) count_A=$((N - count_B)) ratio=$((count_B * 100 / N)) echo \"ğŸ“Š ê²°ê³¼: A=${count_A}, B=${count_B} (B=${ratio}%)\" íŒŒì¼: /ops/capture_test.sh\n#!/bin/bash set -euo pipefail mode=${1:-ab_test} # ab_test, canary, blue_green echo \"\" echo \"==============================\" echo \"ğŸ§ª í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì‹œì‘: $mode\" echo \"==============================\" echo \"\" grep -A 10 '^env:' charts/fastapi/values/dev.yaml yq e \".env.ALIAS_SELECTION_MODE=\\\"$mode\\\"\" -i charts/fastapi/values/dev.yaml grep -A 10 '^env:' charts/fastapi/values/dev.yaml git add charts/fastapi/values/dev.yaml git commit -am \"test: $mode routing\" \u0026\u0026 git push echo \"â³ ArgoCD ë™ê¸°í™” ëŒ€ê¸° ì¤‘...\" sleep 120 echo \"ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ ($mode)\" ./ops/ab_test.sh 500 echo \"\" echo \"âœ… í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì¢…ë£Œ: $mode\" echo \"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\" echo \"\" 10-1) A/B í…ŒìŠ¤íŠ¸ ì„¤ì •: ALIAS_SELECTION_MODE=ab_test ìŠ¤í¬ë¦½íŠ¸: /ops/ab_test.sh 200 í•©ê²© ê¸°ì¤€: A/B ë¶„í¬ â‰ˆ 90:10 (ìƒ˜í”Œ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ê·¼ì ‘) ğŸ“¸ proof-10-ab_test.png\n10-2) Canary(ì˜ˆ: 30%) ì„¤ì •: ALIAS_SELECTION_MODE=canary, CANARY_PERCENT=30 ìŠ¤í¬ë¦½íŠ¸: /ops/ab_test.sh 500 í•©ê²© ê¸°ì¤€: B â‰ˆ 30% Â± (í‘œë³¸ ì˜¤ì°¨ ë²”ìœ„) ğŸ“¸ proof-10-canary.png\n10-3) Blue-Green ì „í™˜ ì„¤ì •: ALIAS_SELECTION_MODE=blue_green, DEFAULT_ALIAS=B ìŠ¤í¬ë¦½íŠ¸: /ops/ab_test.sh 100 í•©ê²© ê¸°ì¤€: B = 100% (ì™„ì „ ì „í™˜) ğŸ“¸ proof-10-blue_green.png\n11) ğŸ”— One-Commit Flow ì „ì²´ ì²´ì¸ 11-1) ì‚¬ì „ ì¤€ë¹„ (1íšŒë§Œ) charts/fastapi/values/{dev,prod}.yamlì˜ ALIAS_SELECTION_MODE / DEFAULT_ALIAS / CANARY_PERCENT ê°’ë§Œ ë°”ê¿”ê°€ë©° í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ /ops/ab_test.sh (ì´ë¯¸ ê³µìœ ëœ ë²„ì „) ì‚¬ìš© â€” ëª¨ë“œ ì „í™˜ ì—†ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥ ë‚´ë¶€ë§ TLSëŠ” cert-manager ë‚´ë¶€ CA + hosts ì „ì œë¡œ ë™ì‘(í˜„ì¬ ì„¸íŒ… ìœ ì§€) 11-2) ğŸ§± Git ë¸Œëœì¹˜ ìƒì„± ë° PR íŠ¸ë¦¬ê±° ğŸ“¸ proof-11-git-pr-trigger.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nfeat/one-commit-flow-test ë¸Œëœì¹˜ ìƒì„± í›„ Helm CI íŠ¸ë¦¬ê±°ìš© ì»¤ë°‹ í‘¸ì‹œ ì™„ë£Œ GitHub PR ìë™ ìƒì„± URL ì¶œë ¥ë¨ ğŸ’¡ ì˜ë¯¸\nCI/CD íŒŒì´í”„ë¼ì¸ì´ ì»¤ë°‹ ë‹¨ìœ„ë¡œ ìë™ ì‹¤í–‰ë˜ë„ë¡ One-Commit Flowì˜ ì‹œì‘ì ì„ ì¤€ë¹„í•¨. 11-3) âš™ï¸ CI/CD í†µí•© ê²€ì¦ (GitHub Actions + ArgoCD) ğŸ“¸ proof-11-ci-cd.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nGitHub PRì—ì„œ Helm CI 6ê°œ í…ŒìŠ¤íŠ¸(dev/prod ë³‘ë ¬) ì „ë¶€ ì„±ê³µ ArgoCD ë‚´ ëª¨ë“  ì•± ìƒíƒœ Healthy Â· Synced ìœ ì§€ ğŸ’¡ ì˜ë¯¸\nGit ì»¤ë°‹ â†’ CI â†’ CDê¹Œì§€ ìë™ ì—°ë™ì´ ì™„ì„±ëœ One-Commit Flow ì „ì²´ íŒŒì´í”„ë¼ì¸ ê²€ì¦ ì™„ë£Œ. 11-4) ğŸ”„ Git PR ë³‘í•© \u0026 ArgoCD ìë™ Sync ğŸ“¸ proof-11-git-pr-merge-result.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nmain ë¸Œëœì¹˜ì— PR ë³‘í•©(commit: cccb1dd) ì™„ë£Œ ArgoCD ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¦‰ì‹œ Healthy Â· Synced ìƒíƒœ ìœ ì§€ ğŸ’¡ ì˜ë¯¸\nì½”ë“œ ë³‘í•© í›„ CD ìë™ ë°˜ì˜ê¹Œì§€ ì™„ì „ ìë™í™”ë¨ â†’ GitOps ê¸°ë°˜ â€œOne-Commit Flowâ€ ì‹¤ì‹œê°„ ë°˜ì˜ êµ¬ì¡° í™•ë¦½. 11-5) ğŸ“Š Airflow Variables ìë™ ë°˜ì˜ í™•ì¸ ğŸ“¸ proof-11-airflow-dev-variables.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nrollback_version=2, rollback_alias=B, mlflow_alias=A ë“± ìµœì‹  ìƒíƒœ ë°˜ì˜ PR ë³‘í•© ì´í›„ Airflow í™˜ê²½ ìë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ ğŸ’¡ ì˜ë¯¸\nCI/CD íŒŒì´í”„ë¼ì¸ì„ í†µí•œ Airflow DAG í™˜ê²½ ë³€ìˆ˜ ìë™ ê°±ì‹ ê¹Œì§€ ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ë¨ â†’ ì™„ì „í•œ E2E ìë™í™” ê²€ì¦ ì™„ë£Œ. 11-6) ğŸ¤– í•™ìŠµ â†’ ë“±ë¡ â†’ í•«ìŠ¤ì™‘ â†’ Slack ì•Œë¦¼ ìë™í™” ğŸ“¸ proof-11-train-ready-reload-slack.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nAirflow DAG(ml_train_register_and_reload_dev) ì „ Task success MLflow ì‹¤í—˜ Finished ë° accuracy=0.9666 Slack ìë™ ì•Œë¦¼: ëª¨ë¸ ë“±ë¡(best_model v8 â†’ @A) â†’ í•«ìŠ¤ì™‘ ì™„ë£Œ(@A) ğŸ’¡ ì˜ë¯¸\nCI/CD ì´í›„ ëª¨ë¸ í•™ìŠµë¶€í„° FastAPI ì‹¤ì‹œê°„ ë°˜ì˜ê¹Œì§€ ì™„ì „ ìë™í™” ë£¨í”„ ë‹¬ì„± â†’ ì§„ì •í•œ â€œOne-Commit Flowâ€ ì™„ì„± ğŸš€ 11-7) ğŸ§ª FastAPI Canary ë¼ìš°íŒ… ê²€ì¦ ğŸ“¸ proof-11-routing-canary.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nALIAS_SELECTION_MODE=canary, CANARY_PERCENT=20 Blue-Green ë¡œê·¸ ê²°ê³¼: A=411, B=89 (Bâ‰ˆ17%) GitOps ì»¤ë°‹(test: canary routing) ì •ìƒ ë°˜ì˜ ğŸ’¡ ì˜ë¯¸\níŠ¸ë˜í”½ 20%ê°€ Canary(B)ë¡œ ì •ìƒ ë¶„ë°°ë¨ â†’ FastAPI ë ˆë²¨ íŠ¸ë˜í”½ ì‹¤í—˜ êµ¬ì¡° ì™„ì„±. 11-8) ğŸ§ª FastAPI Blue-Green ë¼ìš°íŒ… ê²€ì¦ ğŸ“¸ proof-11-routing-blue_green.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nALIAS_SELECTION_MODE=blue_green í…ŒìŠ¤íŠ¸ ê²°ê³¼: A=0, B=500 (ì •í™•íˆ 100%) GitOps ì»¤ë°‹(test: blue_green routing) ë° ArgoCD Sync ì™„ë£Œ ğŸ’¡ ì˜ë¯¸\nCanary ëŒ€ë¹„ ì™„ì „ ë¶„ë¦¬ëœ íŠ¸ë˜í”½ ë¶„ë°° êµ¬ì¡° ê²€ì¦ ì™„ë£Œ â†’ A/B/Blue-Green ë¼ìš°íŒ… ì²´ê³„ ëª¨ë‘ ì •ìƒ ë™ì‘. 11-9) ğŸ“‚ ë¡œê·¸ ìŠ¤í† ë¦¬ì§€ ê³„ì¸µ (S3 + NFS) ê²€ì¦ ğŸ“¸ proof-11-logs-s3-nfs.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nS3: mlflow-artifacts-keonho/dev/airflow-logs/... ê²½ë¡œì— DAGë³„ ë¡œê·¸ ì—…ë¡œë“œ í™•ì¸ NFS: /mnt/nfs_share/mlops/fastapi/logs/dev/fastapi.log ì‹¤ì‹œê°„ ê°±ì‹  FastAPI pod ë¡œê·¸ì™€ NFS ë¡œê·¸ ë™ê¸°í™” ì‹œê° í™•ì¸ ğŸ’¡ ì˜ë¯¸\nAirflow â†’ MLflow â†’ FastAPIì˜ ë¡œê·¸ íŒŒì´í”„ë¼ì¸ ì™„ì „ ì¼ì›í™”,\nì‹¤í—˜Â·ì„œë¹™ ë¡œê·¸ê°€ S3(ë°±ì—…) + NFS(ì‹¤ì‹œê°„) ë¡œ ëª¨ë‘ ê¸°ë¡ë¨.\n11-10) ğŸ”‘ AWS Credentials ìë™ íšŒì „ ê²€ì¦ ğŸ“¸ proof-11-aws-credentials-rotate.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nmlflow-airflow-dev-user IAM í‚¤ ìë™ íšŒì „ í›„ ì‹ ê·œ í‚¤ 2ê°œ Active ìƒíƒœ aws-credentials-secretì˜ resourceVersion ê°±ì‹  í™•ì¸ (2471260 â†’ 2501958) GitOps ì»¤ë°‹(feat(dev): rotate aws credentials) ì •ìƒ ë°˜ì˜ ğŸ’¡ ì˜ë¯¸\nAWS IAM í‚¤ ìƒì„± â†’ ë¡œì»¬ ë°±ì—… â†’ SealedSecret ìë™ ì•”í˜¸í™” â†’ GitOps ë°˜ì˜ê¹Œì§€\nì™„ì „ ìë™ íšŒì „ ì²´ê³„ ì„±ê³µì ìœ¼ë¡œ ë™ì‘í•¨.\n11-11) ğŸ”‘ SealedSecrets ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ íšŒì „ \u0026 Re-Seal ê²€ì¦ ğŸ“¸ proof-11-sealedsecret-cm-rotate-reseal.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nìƒˆ Fingerprint: BA:75:AD:B7...E6:0:48:AB ìœ¼ë¡œ ë³€ê²½ í™•ì¸ dev/prod ëª¨ë“  SealedSecret íŒŒì¼(.yaml)ì—ì„œ valid ê²°ê³¼ ë°˜í™˜ ArgoCD ëª¨ë“  ì•± Healthy / Synced ìƒíƒœ ìœ ì§€ ğŸ’¡ ì˜ë¯¸\nController í‚¤ ì¬ë°œê¸‰ + ì „ í™˜ê²½ Re-Seal í›„ì—ë„ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´\në¬´ì¤‘ë‹¨ ì‹œí¬ë¦¿ ì¬ì•”í˜¸í™” ì²´ê³„ ì™„ì„±ë¨.\n11-12) ğŸ”„ ìˆ˜ë™ ë¡¤ë°± ë³€ìˆ˜ ì„¤ì • (Airflow Variable) ğŸ“¸ proof-11-manual-rollback-variables.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nrollback_version=1, rollback_model_name=best_model, rollback_alias=B ì„¤ì • ì™„ë£Œ ê¸°ì¡´ í”„ë¡œë•ì…˜ ëª¨ë¸(A) ëŒ€ë¹„ ì´ì „ ë²„ì „(B)ìœ¼ë¡œì˜ ë¡¤ë°± ì¤€ë¹„ ìƒíƒœ ğŸ’¡ ì˜ë¯¸\nAirflow DAGì—ì„œ ì¡°ê±´ ê¸°ë°˜ ìˆ˜ë™ ë¡¤ë°±ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ ë³€ìˆ˜ ê¸°ë°˜ ì œì–´ êµ¬ì¡° ì •ìƒ ë™ì‘ í™•ì¸. 11-13) ğŸ” Airflow ìˆ˜ë™ ë¡¤ë°± ì‹¤í–‰ \u0026 Slack ì—°ë™ ê²€ì¦ ğŸ“¸ proof-11-manual-rollback-diff-and-slack.png\nâœ… í™•ì¸ í¬ì¸íŠ¸\nmanual_rollback_model_dev DAG ì‹¤í–‰ ì„±ê³µ (rollback_model_alias + reload_fastapi_model ì™„ë£Œ) FastAPI /models ê²°ê³¼ì—ì„œ B aliasì˜ run_id 4a59f6b6... ë¡œ ë¡¤ë°± ë°˜ì˜ í™•ì¸ Slack ì•Œë¦¼: â€œ[FastAPI] ëª¨ë¸ B í•«ìŠ¤ì™‘ ì™„ë£Œâ€ ì •ìƒ ìˆ˜ì‹  ğŸ’¡ ì˜ë¯¸\nìˆ˜ë™ íŠ¸ë¦¬ê±°ë§Œìœ¼ë¡œ ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ â†’ FastAPI Reload â†’ Slack ì•Œë¦¼ê¹Œì§€\nì™„ì „ ìë™ ì—°ë™ëœ í•«ìŠ¤ì™‘ ê¸°ë°˜ ë¡¤ë°± ë£¨í‹´ì´ ì„±ê³µì ìœ¼ë¡œ ë™ì‘í•¨.\ní•œ ì¤„ ìš”ì•½ ì´ ìº¡ì²˜ í”Œë¡œìš°ë§Œ ë”°ë¥´ë©´, One Commit Flow(CIâ†’CDâ†’í•™ìŠµ/ë“±ë¡â†’READYâ†’í•«ìŠ¤ì™‘â†’ì‹¤í—˜â†’ê´€ì œ)ê°€ ì‹¤ì œ í™˜ê²½ì—ì„œ ì •ìƒ ì‘ë™í–ˆìŒì„ ê·¸ëŒ€ë¡œ ì¦ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n","wordCount":"2878","inLanguage":"en","datePublished":"2025-10-06T17:10:21+09:00","dateModified":"2025-10-06T17:10:21+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://keonhoban.github.io/mlops-journey/projects/mlops_pipeline_gitops/02/"},"publisher":{"@type":"Organization","name":"ğŸ”ï¸  MLOps Journey","logo":{"@type":"ImageObject","url":"https://keonhoban.github.io/mlops-journey/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://keonhoban.github.io/mlops-journey/ accesskey=h title="ğŸ”ï¸  MLOps Journey (Alt + H)">ğŸ”ï¸ MLOps Journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://keonhoban.github.io/mlops-journey/ title="ğŸ  Home"><span>ğŸ  Home</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/projects/ title="ğŸ“‚ Projects"><span>ğŸ“‚ Projects</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/posts/ title="ğŸ“ Blog"><span>ğŸ“ Blog</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/about/ title="ğŸ§— About"><span>ğŸ§— About</span></a></li><li><a href=https://keonhoban.github.io/mlops-journey/categories/ title="ğŸ“– Categories"><span>ğŸ“– Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://keonhoban.github.io/mlops-journey/>Home</a>&nbsp;Â»&nbsp;<a href=https://keonhoban.github.io/mlops-journey/projects/>Projects</a></div><h1 class="post-title entry-hint-parent">[MLOps ìš´ì˜ ê³ ë„í™” - ê²€ì¦ (Proof of Automation)]</h1><div class=post-meta><span title='2025-10-06 17:10:21 +0900 +0900'>October 6, 2025</span>&nbsp;Â·&nbsp;14 min</div></header><div class=post-content><h1 id=-proof-of-automation--ì‘ë™-ê²€ì¦-ë£¨í”„>ğŸ§  Proof of Automation â€” ì‘ë™ ê²€ì¦ ë£¨í”„<a hidden class=anchor aria-hidden=true href=#-proof-of-automation--ì‘ë™-ê²€ì¦-ë£¨í”„>#</a></h1><blockquote><p>í•˜ë‚˜ì˜ ì»¤ë°‹ìœ¼ë¡œ CI â†’ CD â†’ í•™ìŠµ/ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘ â†’ ì‹¤í—˜ â†’ ê´€ì œê¹Œì§€ ìë™í™”ë˜ì—ˆìŒì„ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…í•©ë‹ˆë‹¤.</p></blockquote><hr><h1 id=-ëª©ì°¨-í•µì‹¬ë§Œ>ğŸ§­ ëª©ì°¨ (í•µì‹¬ë§Œ)<a hidden class=anchor aria-hidden=true href=#-ëª©ì°¨-í•µì‹¬ë§Œ>#</a></h1><table><thead><tr><th>#</th><th>ì„¹ì…˜</th></tr></thead><tbody><tr><td>0</td><td>ì¤€ë¹„ (CI/CDÂ·GitOpsÂ·Secrets ê¸°ë³¸ ì„¸íŒ…)</td></tr><tr><td>1</td><td>CI ì‹¤í–‰ (GitHub Actions)</td></tr><tr><td>2</td><td>ArgoCD ìë™ ë™ê¸°í™”</td></tr><tr><td>3</td><td>Airflow í•™ìŠµâ†’ë“±ë¡â†’READY (FAIL/SUCCESS + Slack)</td></tr><tr><td>4</td><td>MLflow ëª¨ë¸ ë“±ë¡Â·ë³„ì¹­Â·ì•„í‹°íŒ©íŠ¸</td></tr><tr><td>5</td><td>FastAPI í•«ìŠ¤ì™‘ (/reload)</td></tr><tr><td>6</td><td>ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ê°€ë“œë ˆì¼)</td></tr><tr><td>7</td><td>ë¡œê·¸ ê³„ì¸µ (Airflow=S3 / FastAPI=NFS)</td></tr><tr><td>8</td><td>ArgoCDâ†”Slack ìš´ì˜ ê´€ì œ</td></tr><tr><td>9</td><td>ë³´ì•ˆ ìë™í™” (AWS Rotation + SealedSecrets Re-seal)</td></tr><tr><td>10</td><td>íŠ¸ë˜í”½ ì‹¤í—˜ (A/B Â· Canary Â· Blue-Green)</td></tr><tr><td>11</td><td>One-Commit Flow ì „ì²´ ì²´ì¸ ê²€ì¦</td></tr></tbody></table><hr><h1 id=0--ì¤€ë¹„-í•œ-ë²ˆë§Œ>0) ğŸ§° ì¤€ë¹„ (í•œ ë²ˆë§Œ)<a hidden class=anchor aria-hidden=true href=#0--ì¤€ë¹„-í•œ-ë²ˆë§Œ>#</a></h1><ul><li>(GitOps) <code>charts/fastapi/values/{dev,prod}.yaml</code>ì—ì„œ <strong>ALIAS_SELECTION_MODE/DEFAULT_ALIAS/CANARY_PERCENT</strong> ê°’ì„ ì‹œë‚˜ë¦¬ì˜¤ë³„ë¡œ ìˆ˜ì • â†’ <code>git commit</code> â†’ <code>git push</code></li><li>(í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸) <code>/ops/ab_test.sh</code> ì €ì¥ (ì•„ë˜ ì œê³µ)</li></ul><hr><h1 id=1--ci-ì§„ì…-github-actions><strong>1) ğŸ§ª CI ì§„ì… (GitHub Actions)</strong><a hidden class=anchor aria-hidden=true href=#1--ci-ì§„ì…-github-actions>#</a></h1><p><img alt=CI_ì§„ì….png loading=lazy src=/mlops-journey/images/proof-01-ci.png></p><p>ğŸ“¸ <code>proof-01-ci.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: Helm Lint / Render / kubeconform ê²€ì¦ì´ devÂ·prod ë§¤íŠ¸ë¦­ìŠ¤ ì „ì²´ ëª¨ë‘ ì„±ê³µ</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> â€œAll checks have passedâ€ ë¬¸êµ¬ë¥¼ í†µí•´ GitHub Actions CIê°€ ìë™ íŠ¸ë¦¬ê±°ë˜ì–´ í…œí”Œë¦¿Â·ë¦¬ì†ŒìŠ¤ ì •í•©ì„±ì´ ì™„ì „íˆ ë³´ì¥ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><hr><h1 id=2--argocd-ë™ê¸°í™”-applicationset-ìë™-ë³µêµ¬><strong>2) ğŸ” ArgoCD ë™ê¸°í™” (ApplicationSet ìë™ ë³µêµ¬)</strong><a hidden class=anchor aria-hidden=true href=#2--argocd-ë™ê¸°í™”-applicationset-ìë™-ë³µêµ¬>#</a></h1><p><img alt=proof-02-argocd-synced.png loading=lazy src=/mlops-journey/images/proof-02-argocd-synced.png></p><p>ğŸ“¸ <code>proof-02-argocd-synced.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: airflow, mlflow, fastapi, secrets, namespaces ë“± dev/prod ì „ ì•±ì´ ëª¨ë‘ Healthy / Synced</p><p>âš™ï¸ <strong>ì˜ë¯¸:</strong> ArgoCD ApplicationSetì˜ <strong>SelfHeal/Prune</strong>ë¡œ Git(main) ê¸°ì¤€ ìë™ ë³µêµ¬ê°€ <strong>ì§€ì† ë™ì‘</strong>í•¨ì´ ì‹œê°ì ìœ¼ë¡œ ì¦ëª…ë¨.</p></blockquote><hr><h1 id=3--airflow-í•™ìŠµë“±ë¡ready-íë¦„>3) ğŸ¯ Airflow í•™ìŠµâ†’ë“±ë¡â†’READY íë¦„<a hidden class=anchor aria-hidden=true href=#3--airflow-í•™ìŠµë“±ë¡ready-íë¦„>#</a></h1><h2 id=3-1-airflow-í•™ìŠµ--ë“±ë¡--ready-íë¦„-variables-ì„¤ì •><strong>3-1) Airflow í•™ìŠµ â†’ ë“±ë¡ â†’ READY íë¦„ (Variables ì„¤ì •)</strong><a hidden class=anchor aria-hidden=true href=#3-1-airflow-í•™ìŠµ--ë“±ë¡--ready-íë¦„-variables-ì„¤ì •>#</a></h2><p><img alt=proof-03-fail-flow-variables.png loading=lazy src=/mlops-journey/images/proof-03-fail-flow-variables.png></p><p>ğŸ“¸ <code>proof-03-fail-flow-variables.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: model_name, mlflow_alias, rollback_* ë“± í•µì‹¬ ë³€ìˆ˜ê°€ ëª¨ë‘ Airflowì˜ Fernet Key ê¸°ë°˜ ì•”í˜¸í™”(is_encrypted=true) ìƒíƒœë¡œ ì €ì¥</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> Airflow DAGì´ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘Â·ë¡¤ë°± ì „ ê³¼ì •ì„ ì œì–´í•  ë³€ìˆ˜ë¥¼ ì •ìƒ ì¸ì‹í•˜ê³  ìˆìœ¼ë©°, í™˜ê²½ë³„(dev/prod) ì‹¤í—˜ íŒŒë¼ë¯¸í„°ê°€ ì¼ê´€ë˜ê²Œ ê´€ë¦¬ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=3-2-airflow-í•™ìŠµ--ë“±ë¡--ready-mlflow-ì—°ë™-ê²°ê³¼><strong>3-2) Airflow í•™ìŠµ â†’ ë“±ë¡ â†’ READY (MLflow ì—°ë™ ê²°ê³¼)</strong><a hidden class=anchor aria-hidden=true href=#3-2-airflow-í•™ìŠµ--ë“±ë¡--ready-mlflow-ì—°ë™-ê²°ê³¼>#</a></h2><p><img alt=proof-03-fail-flow.png loading=lazy src=/mlops-journey/images/proof-03-fail-flow.png></p><p>ğŸ“¸ <code>proof-03-fail-flow.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: <code>train_and_evaluate</code>ì™€ <code>check_result</code>ê¹Œì§„ Successì§€ë§Œ, ì •í™•ë„(0.8666) &lt; ì„ê³„ê°’(0.9)ìœ¼ë¡œ í‰ê°€ë˜ì–´ <code>notify_failure</code>ê°€ íŠ¸ë¦¬ê±°ë˜ê³  ì´í›„ íƒœìŠ¤í¬(<code>check_model_ready</code>, <code>trigger_reload</code>)ëŠ” ìë™ ìŠ¤í‚µë¨</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> ì •í™•ë„ ì„ê³„ì¹˜ ë¯¸ë‹¬ ì‹œ í•™ìŠµ íŒŒì´í”„ë¼ì¸ì´ ìë™ ì¤‘ë‹¨ë˜ê³  Slack ì•Œë¦¼ìœ¼ë¡œ ì‹¤íŒ¨ íë¦„ì´ ì „ë‹¬ë˜ëŠ” <strong>ìë™ Fail-safe ë¡œì§</strong>ì´ ì •ìƒ ì‘ë™í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=3-3-airflow-fail-flow-slack-ì•Œë¦¼-ê²€ì¦><strong>3-3) Airflow FAIL FLOW (Slack ì•Œë¦¼ ê²€ì¦)</strong><a hidden class=anchor aria-hidden=true href=#3-3-airflow-fail-flow-slack-ì•Œë¦¼-ê²€ì¦>#</a></h2><p><img alt=proof-03-fail-flow-slack.png loading=lazy src=/mlops-journey/images/proof-03-fail-flow-slack.png></p><p>ğŸ“¸ <code>proof-03-fail-flow-slack.png</code></p><blockquote><p>âš ï¸ í™•ì¸ í¬ì¸íŠ¸: Validation failed â†’ ì…ë ¥ê°’ 20 ëŒ€ì‹  ê¸°ë³¸ê°’ 200 ì‚¬ìš© ë° ê¸°ì¤€ ë¯¸ë‹¬ â†’ ë“±ë¡ ë° í•«ìŠ¤ì™‘ ìƒëµ ë©”ì‹œì§€ê°€ Slack ì±„ë„(dev)ë¡œ ì‹¤ì‹œê°„ ì „ì†¡</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> ì •í™•ë„ ì„ê³„ì¹˜(0.9) ë¯¸ë‹¬ ì‹œ DAGì˜ ì‹¤íŒ¨ ì•Œë¦¼ì´ Slackìœ¼ë¡œ ì¦‰ì‹œ í†µë³´ë˜ì–´, ì‹¤íŒ¨ ë£¨í”„ê°€ Airflowâ€“Slack ê°„ ì™„ì „ ìë™í™”ë˜ì–´ ìˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=3-4-airflow-success-flow-í•™ìŠµ--ë“±ë¡--ready--í•«ìŠ¤ì™‘-dev--prod-í™˜ê²½><strong>3-4) Airflow SUCCESS FLOW (í•™ìŠµ â†’ ë“±ë¡ â†’ READY â†’ í•«ìŠ¤ì™‘) (dev / prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#3-4-airflow-success-flow-í•™ìŠµ--ë“±ë¡--ready--í•«ìŠ¤ì™‘-dev--prod-í™˜ê²½>#</a></h2><p><img alt=proof-03-airflow-dag-success-dev.png loading=lazy src=/mlops-journey/images/proof-03-airflow-dag-success-dev.png></p><p>ğŸ“¸ <code>proof-03-airflow-dag-success-dev.png</code></p><p><img alt=proof-03-airflow-dag-success-prod.png loading=lazy src=/mlops-journey/images/proof-03-airflow-dag-success-prod.png></p><p>ğŸ“¸ <code>proof-03-airflow-dag-success-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: train_and_evaluate â†’ check_result â†’ register_model â†’ check_model_ready â†’ trigger_reload ì „ ë‹¨ê³„ê°€ ëª¨ë‘ Success, (* notify_failureëŠ” ìŠ¤í‚µë¨)</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> ì •í™•ë„ ì„ê³„ê°’(0.9) ì´ìƒ ë‹¬ì„± í›„ ì „ì²´ í•™ìŠµÂ·ë“±ë¡Â·í•«ìŠ¤ì™‘ ì²´ì¸ì´ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìœ¼ë©°, FastAPI <code>/reload</code> íŠ¸ë¦¬ê±°ê¹Œì§€ ìë™í™”ë˜ì–´ ì™„ì „í•œ <strong>SUCCESS FLOW</strong>ê°€ ê²€ì¦ë¨</p></blockquote><h2 id=3-5-fastapi-ëª¨ë¸-ë¡œë“œ-ê²€ì¦-dev--prod-í™˜ê²½><strong>3-5) FastAPI ëª¨ë¸ ë¡œë“œ ê²€ì¦ (dev / prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#3-5-fastapi-ëª¨ë¸-ë¡œë“œ-ê²€ì¦-dev--prod-í™˜ê²½>#</a></h2><p><img alt=proof-03-fastapi-model-load(dev,prod).png loading=lazy src=/mlops-journey/images/proof-03-fastapi-model-load-dev-prod.png></p><p>ğŸ“¸ <code>proof-03-fastapi-model-load(dev,prod).png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: <a href=https://fastapi.local>https://fastapi.local</a> ë° <a href=https://fastapi.prod>https://fastapi.prod</a> ê°ê°ì—ì„œ /ê³¼ /health ì‘ë‹µì— &ldquo;loaded_variants&rdquo;: [&ldquo;A&rdquo;,&ldquo;B&rdquo;] í™•ì¸</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> devÂ·prod í™˜ê²½ ëª¨ë‘ì—ì„œ FastAPI ì¸ìŠ¤í„´ìŠ¤ê°€ ìµœì‹  ëª¨ë¸ A/Bë¥¼ ì •ìƒì ìœ¼ë¡œ ë¡œë“œí•˜ê³  ìˆìœ¼ë©°, <code>/predict</code>, <code>/reload</code>, <code>/models</code>, <code>/health</code> ì—”ë“œí¬ì¸íŠ¸ ì „ì²´ê°€ TLS ê¸°ë°˜ìœ¼ë¡œ ì •ìƒ ì‘ë‹µí•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=3-6-fastapi-ëª¨ë¸-ë“±ë¡-ë°-í•«ìŠ¤ì™‘-slack-ì•Œë¦¼-dev--prod-í™˜ê²½><strong>3-6) FastAPI ëª¨ë¸ ë“±ë¡ ë° í•«ìŠ¤ì™‘ Slack ì•Œë¦¼ (dev / prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#3-6-fastapi-ëª¨ë¸-ë“±ë¡-ë°-í•«ìŠ¤ì™‘-slack-ì•Œë¦¼-dev--prod-í™˜ê²½>#</a></h2><p><img alt=proof-03-model-load-slack(dev).png loading=lazy src=/mlops-journey/images/proof-03-model-load-slack-dev.png></p><p>ğŸ“¸ <code>proof-03-model-load-slack(dev).png</code></p><p><img alt=proof-03-model-load-slack(prod).png loading=lazy src=/mlops-journey/images/proof-03-model-load-slack-prod.png></p><p>ğŸ“¸ <code>proof-03-model-load-slack(prod).png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: best_model v1 â†’ @A, best_model v2 â†’ @B ë“±ë¡ ì™„ë£Œ ë©”ì‹œì§€ì™€ í•¨ê»˜ ê° run_idê°€ Slackìœ¼ë¡œ ì‹¤ì‹œê°„ ì „ì†¡</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> Airflowì—ì„œ MLflow ë“±ë¡ ì™„ë£Œ í›„ FastAPI í•«ìŠ¤ì™‘ì´ ìë™ ìˆ˜í–‰ë˜ë©°, dev,prod í™˜ê²½ì˜ Slack Webhookì„ í†µí•´ <strong>A/B ëª¨ë¸ ì „í™˜ ë° ì‹¤í–‰ ì´ë ¥(run_id)</strong> ì´ íˆ¬ëª…í•˜ê²Œ ì¶”ì ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=3-7-argocd-self-heal-test-ë“œë¦¬í”„íŠ¸-ìë™-ë³µêµ¬><strong>3-7) ArgoCD Self-Heal Test (ë“œë¦¬í”„íŠ¸ ìë™ ë³µêµ¬)</strong><a hidden class=anchor aria-hidden=true href=#3-7-argocd-self-heal-test-ë“œë¦¬í”„íŠ¸-ìë™-ë³µêµ¬>#</a></h2><p><img alt=proof-03-drift-self-heal-test.png loading=lazy src=/mlops-journey/images/proof-03-drift-self-heal-test.png></p><p>ğŸ“¸ <code>proof-03-drift-self-heal-test.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: ìˆ˜ë™ìœ¼ë¡œ fastapi-dev-serverì˜ CANARY_PERCENT ê°’ì„ 31ë¡œ ë³€ê²½ í›„ ArgoCD ë™ê¸°í™”ë¡œ ë‹¤ì‹œ 20ìœ¼ë¡œ ë³µì›ë¨</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> í´ëŸ¬ìŠ¤í„° ë‚´ ìˆ˜ë™ ë³€ê²½(ë“œë¦¬í”„íŠ¸)ì´ ë°œìƒí•˜ë”ë¼ë„ ArgoCDì˜ SelfHeal ê¸°ëŠ¥ì´ Git ìƒíƒœ(main branch) ê¸°ì¤€ìœ¼ë¡œ ìë™ ë³µêµ¬í•˜ì—¬ <strong>GitOps ë¶ˆë³€ì„±</strong>ì´ ìœ ì§€ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><hr><h1 id=4--mlflow-ë“±ë¡ë³„ì¹­ì•„í‹°íŒ©íŠ¸>4) ğŸ—‚ï¸ MLflow ë“±ë¡/ë³„ì¹­/ì•„í‹°íŒ©íŠ¸<a hidden class=anchor aria-hidden=true href=#4--mlflow-ë“±ë¡ë³„ì¹­ì•„í‹°íŒ©íŠ¸>#</a></h1><h2 id=4-1-mlflow-ë“±ë¡-ë°-alias-ë°”ì¸ë”©-airflow-variables><strong>4-1) MLflow ë“±ë¡ ë° Alias ë°”ì¸ë”© (Airflow Variables)</strong><a hidden class=anchor aria-hidden=true href=#4-1-mlflow-ë“±ë¡-ë°-alias-ë°”ì¸ë”©-airflow-variables>#</a></h2><p><img alt=proof-04-airflow-variables.png loading=lazy src=/mlops-journey/images/proof-04-airflow-variables.png></p><p>ğŸ“¸ <code>proof-04-airflow-variables.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: mlflow_alias=B, rollback_alias=A, rollback_version=1 ë“± ë³€ìˆ˜ ìƒíƒœê°€ ì •í™•íˆ ë°˜ì˜ë˜ì–´ ìˆìŒ</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> Airflow DAG ì‹¤í–‰ ê²°ê³¼, ì‹ ê·œ ëª¨ë¸ì´ <code>best_model v2 â†’ B</code>ë¡œ ë“±ë¡ë˜ê³  ê¸°ì¡´ ë²„ì „ì€ <code>rollback_version=1 (A)</code>ë¡œ ìœ ì§€ë˜ì–´, <strong>A/B alias ì „í™˜ íë¦„</strong>ì´ ë³€ìˆ˜ ë‹¨ê³„ì—ì„œ ëª…í™•íˆ ê´€ë¦¬ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=4-2-mlflow-ë“±ë¡-ë°-alias-ë°”ì¸ë”©-dev-prod-í™˜ê²½><strong>4-2) MLflow ë“±ë¡ ë° Alias ë°”ì¸ë”© (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#4-2-mlflow-ë“±ë¡-ë°-alias-ë°”ì¸ë”©-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-04-mlflow-alias-dev.png loading=lazy src=/mlops-journey/images/proof-04-mlflow-alias-dev.png></p><p>ğŸ“¸ <code>proof-04-mlflow-alias-dev.png</code></p><p><img alt=proof-04-mlflow-alias-prod.png loading=lazy src=/mlops-journey/images/proof-04-mlflow-alias-prod.png></p><p>ğŸ“¸ <code>proof-04-mlflow-alias-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: best_modelì´ Version 2ë¡œ ìƒˆë¡œ ë“±ë¡ë˜ë©°, alias @B: Version 2, @A: Version 1ì˜ ì´ì¤‘ alias ì²´ê³„ê°€ ëª…í™•íˆ í‘œì‹œë¨</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> Airflow DAG ì‹¤í–‰ ê²°ê³¼, MLflow Registry ë‚´ì—ì„œ ì‹ ê·œ ë²„ì „ì´ ìë™ ë“±ë¡ë˜ê³ , ê¸°ì¡´/ì‹ ê·œ ëª¨ë¸ì´ ê°ê° A/B aliasë¡œ ë°”ì¸ë”©ë˜ì–´ <strong>ë²„ì „ ê´€ë¦¬ ë° ì‹¤í—˜ ì „í™˜ ì²´ê³„</strong>ê°€ ì™„ì „í•˜ê²Œ êµ¬í˜„ë˜ì—ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=4-3-mlflow-ì•„í‹°íŒ©íŠ¸-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½><strong>4-3) MLflow ì•„í‹°íŒ©íŠ¸ ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#4-3-mlflow-ì•„í‹°íŒ©íŠ¸-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-04-mlflow-artifacts-dev.png loading=lazy src=/mlops-journey/images/proof-04-mlflow-artifacts-dev.png></p><p>ğŸ“¸ <code>proof-04-mlflow-artifacts-dev.png</code></p><p><img alt=proof-04-mlflow-artifacts-prod.png loading=lazy src=/mlops-journey/images/proof-04-mlflow-artifacts-prod.png></p><p>ğŸ“¸ <code>proof-04-mlflow-artifacts-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: model.pkl, conda.yaml, python_env.yaml ë“± ëª¨ë¸ ë©”íƒ€ë°ì´í„°ì™€ í™˜ê²½ ì •ë³´ê°€ s3://mlflow-artifacts-keonho/{dev, prod}/&mldr; ê²½ë¡œì— í™˜ê²½ë³„ë¡œ ë¶„ë¦¬ë˜ì–´ ì •ìƒ ì €ì¥ë¨</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> MLflowê°€ í•™ìŠµ ì™„ë£Œëœ ëª¨ë¸ê³¼ ì‹¤í–‰ í™˜ê²½ì„ ì•„í‹°íŒ©íŠ¸ë¡œ ë²„ì „ë³„ ë³´ê´€í•˜ë©°, ì¶”í›„ FastAPI ì„œë¹™ ì‹œ ë™ì¼ í™˜ê²½ ì¬í˜„ì´ ê°€ëŠ¥í•œ <strong>ì¬í˜„ì„± ìˆëŠ” MLOps íŒŒì´í”„ë¼ì¸</strong>ì´ í™•ë³´ë˜ì—ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><hr><h1 id=5--fastapi-í•«ìŠ¤ì™‘>5) âš¡ FastAPI í•«ìŠ¤ì™‘<a hidden class=anchor aria-hidden=true href=#5--fastapi-í•«ìŠ¤ì™‘>#</a></h1><h2 id=5-1-fastapi-í•«ìŠ¤ì™‘-ê²€ì¦-dev-prod-í™˜ê²½><strong>5-1) FastAPI í•«ìŠ¤ì™‘ ê²€ì¦ (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#5-1-fastapi-í•«ìŠ¤ì™‘-ê²€ì¦-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-05-fastapi-reload-dev.png loading=lazy src=/mlops-journey/images/proof-05-fastapi-reload-dev.png></p><p>ğŸ“¸ <code>proof-05-fastapi-reload-dev.png</code></p><p><img alt=proof-05-fastapi-reload-prod.png loading=lazy src=/mlops-journey/images/proof-05-fastapi-reload-prod.png></p><p>ğŸ“¸ <code>proof-05-fastapi-reload-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: /variant/A/reload, /variant/B/reload í˜¸ì¶œ ì‹œ ê°ê° version: &ldquo;1&rdquo;, &ldquo;2"ë¡œ ì‘ë‹µí•˜ë©° &ldquo;status&rdquo;: &ldquo;success&rdquo; ë°˜í™˜</p><p>âš™ï¸ ì˜ëª»ëœ í† í°(<code>Super_Secret_Token</code>) ì‚¬ìš© ì‹œ <code>Access denied</code>, ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì—”ë“œí¬ì¸íŠ¸ í˜¸ì¶œ ì‹œ <code>Not Found</code> ë°˜í™˜</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> FastAPIê°€ dev, prod í™˜ê²½ë³„ë¡œ í† í° ì¸ì¦Â·ì—”ë“œí¬ì¸íŠ¸ ê²€ì¦ì„ ëª¨ë‘ í†µê³¼í•˜ë©° ìµœì‹  ëª¨ë¸ ë²„ì „ìœ¼ë¡œ ì •ìƒ êµì²´ë¨ì„ í™•ì¸ â€” <strong>ë³´ì•ˆÂ·ë¬´ì¤‘ë‹¨ í•«ìŠ¤ì™‘ ì²´ê³„</strong>ê°€ ì™„ë²½íˆ ë™ì‘í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=5-2-fastapi-í•«ìŠ¤ì™‘-slack-ì•Œë¦¼-dev-prod-í™˜ê²½><strong>5-2) FastAPI í•«ìŠ¤ì™‘ Slack ì•Œë¦¼ (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#5-2-fastapi-í•«ìŠ¤ì™‘-slack-ì•Œë¦¼-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-05-fastapi-reload-slack-dev.png loading=lazy src=/mlops-journey/images/proof-05-fastapi-reload-slack-dev.png></p><p>ğŸ“¸ <code>proof-05-fastapi-reload-slack-dev.png</code></p><p><img alt=proof-05-fastapi-reload-slack-prod.png loading=lazy src=/mlops-journey/images/proof-05-fastapi-reload-slack-prod.png></p><p>ğŸ“¸ <code>proof-05-fastapi-reload-slack-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: [FastAPI] ëª¨ë¸ A í•«ìŠ¤ì™‘ ì™„ë£Œ: v1, [FastAPI] ëª¨ë¸ B í•«ìŠ¤ì™‘ ì™„ë£Œ: v2 ë©”ì‹œì§€ì™€ í•¨ê»˜ ê° run_idê°€ Slack ì±„ë„(dev, prod)ì— ì •ìƒ ì „ì†¡</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> FastAPI <code>/variant/{alias}/reload</code> ì„±ê³µ ì‹œ, ê° ëª¨ë¸ ë²„ì „ì˜ ì „í™˜ ê²°ê³¼ê°€ Slack Webhookì„ í†µí•´ ì‹¤ì‹œê°„ í†µë³´ë˜ì–´ <strong>í•«ìŠ¤ì™‘ ì™„ë£Œ ì•Œë¦¼ ë£¨í”„(dev, prod)</strong> ê°€ ì™„ë²½íˆ ë™ì‘í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><hr><h1 id=6--ìˆ˜ë™-ë¡¤ë°±ìš´ì˜-ë³µêµ¬-ë ˆì¼>6) ğŸ”„ ìˆ˜ë™ ë¡¤ë°±(ìš´ì˜ ë³µêµ¬ ë ˆì¼)<a hidden class=anchor aria-hidden=true href=#6--ìˆ˜ë™-ë¡¤ë°±ìš´ì˜-ë³µêµ¬-ë ˆì¼>#</a></h1><h2 id=6-1-ìˆ˜ë™-ë¡¤ë°±-ìš´ì˜-ë³µêµ¬-ë ˆì¼--airflow-variables><strong>6-1) ìˆ˜ë™ ë¡¤ë°± (ìš´ì˜ ë³µêµ¬ ë ˆì¼ â€“ Airflow Variables)</strong><a hidden class=anchor aria-hidden=true href=#6-1-ìˆ˜ë™-ë¡¤ë°±-ìš´ì˜-ë³µêµ¬-ë ˆì¼--airflow-variables>#</a></h2><p><img alt=proof-06-airflow-variables.png loading=lazy src=/mlops-journey/images/proof-06-airflow-variables.png></p><p>ğŸ“¸ <code>proof-06-airflow-variables.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: rollback_version=1, rollback_alias=B, mlflow_alias=B, model_name=best_model ë“± ë¡¤ë°± ê´€ë ¨ ë³€ìˆ˜ë“¤ì´ ì •í™•íˆ ì„¸íŒ…ë¨</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> Airflow ìˆ˜ë™ ë¡¤ë°± DAG ì‹¤í–‰ ì „, ë³µêµ¬ ëŒ€ìƒ ë²„ì „ê³¼ ëª¨ë¸ aliasê°€ ëª…í™•íˆ ì§€ì •ë˜ì–´ ìˆì–´ <strong>ì•ˆì •ì ì¸ ìš´ì˜ ë³µêµ¬ í”Œë¡œìš°</strong>(rollbackâ†’reload)ê°€ ì¤€ë¹„ëœ ìƒíƒœì„ì„ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=6-2-ìˆ˜ë™-ë¡¤ë°±-ë¡¤ë°±-ì „-fastapi-ìƒíƒœ><strong>6-2) ìˆ˜ë™ ë¡¤ë°± (ë¡¤ë°± ì „ FastAPI ìƒíƒœ)</strong><a hidden class=anchor aria-hidden=true href=#6-2-ìˆ˜ë™-ë¡¤ë°±-ë¡¤ë°±-ì „-fastapi-ìƒíƒœ>#</a></h2><p><img alt=proof-06-before-fastapi.png loading=lazy src=/mlops-journey/images/proof-06-before-fastapi.png></p><p>ğŸ“¸ <code>proof-06-before-fastapi.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸: devÂ·prod í™˜ê²½ ëª¨ë‘ /models ì‘ë‹µì—ì„œ A: Version 1, B: Version 2ë¡œ í‘œì‹œë˜ì–´ ìˆìŒ</p><p>ğŸ§© <strong>ì˜ë¯¸:</strong> ë¡¤ë°± ì‹¤í–‰ ì „, FastAPIê°€ ìµœì‹  ëª¨ë¸(<code>B: Version 2</code>)ì„ Productionìœ¼ë¡œ ì‚¬ìš© ì¤‘ì´ë©°, <strong>ê¸°ì¡´ ë²„ì „(A:1)</strong> ì´ ì—¬ì „íˆ ë³´ì¡´ë˜ì–´ ìˆëŠ” ìƒíƒœë¡œ <strong>ì•ˆì „í•œ ë³µêµ¬ ì „ ì¤€ë¹„ ìƒíƒœ</strong>ë¥¼ ì¦ëª…í•©ë‹ˆë‹¤</p></blockquote><h2 id=6-3-ìˆ˜ë™-ë¡¤ë°±-dag-ìˆ˜í–‰-ê²°ê³¼--dev-prod-í™˜ê²½><strong>6-3) ìˆ˜ë™ ë¡¤ë°± (DAG ìˆ˜í–‰ ê²°ê³¼ â€“ dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#6-3-ìˆ˜ë™-ë¡¤ë°±-dag-ìˆ˜í–‰-ê²°ê³¼--dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-06-rollback-dag-dev.png loading=lazy src=/mlops-journey/images/proof-06-rollback-dag-dev.png></p><p>ğŸ“¸ <code>proof-06-rollback-dag-dev.png</code></p><p><img alt=proof-06-rollback-dag-prod.png loading=lazy src=/mlops-journey/images/proof-06-rollback-dag-prod.png></p><p>ğŸ“¸ <code>proof-06-rollback-dag-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>DAG ì´ë¦„: <code>manual_rollback_model_dev</code></li><li><code>rollback_model_alias</code> â†’ <code>reload_fastapi_model</code> ìˆœì„œë¡œ ë‘ Task ëª¨ë‘ <code>success</code> ìƒíƒœ</li><li>ì´ ìˆ˜í–‰ ì‹œê°„ ì•½ <strong>29ì´ˆ</strong>, ì‹¤íŒ¨Â·ì§€ì—° ì—†ì´ ì™„ë£Œ</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>Airflow DAGì´ <code>rollback_alias</code>ì™€ <code>rollback_version</code> ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ <strong>MLflow aliasë¥¼ Aë¡œ ë³µêµ¬í•˜ê³ </strong>, FastAPI <code>/reload</code> í˜¸ì¶œì„ ìë™ íŠ¸ë¦¬ê±°í•˜ì—¬ ì´ì „ ëª¨ë¸ ë²„ì „ì„ ë‹¤ì‹œ ì„œë¹™í•˜ëŠ” <strong>ì™„ì „í•œ ìë™ ë³µêµ¬ í”Œë¡œìš°</strong>ê°€ ì •ìƒ ë™ì‘í–ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.</p></blockquote><h2 id=6-4-ìˆ˜ë™-ë¡¤ë°±-ë¡¤ë°±-í›„-fastapi-ìƒíƒœ><strong>6-4) ìˆ˜ë™ ë¡¤ë°± (ë¡¤ë°± í›„ FastAPI ìƒíƒœ)</strong><a hidden class=anchor aria-hidden=true href=#6-4-ìˆ˜ë™-ë¡¤ë°±-ë¡¤ë°±-í›„-fastapi-ìƒíƒœ>#</a></h2><p><img alt=proof-06-after-fastapi.png loading=lazy src=/mlops-journey/images/after-fastapi.png></p><p>ğŸ“¸ <code>after-fastapi.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>devÂ·prod í™˜ê²½ ëª¨ë‘ <code>/models</code> ì‘ë‹µì—ì„œ <code>A: Version 1</code>, <code>B: Version 1</code>ë¡œ ë™ì¼í•˜ê²Œ ë³µêµ¬ë¨</li><li>rollback ëŒ€ìƒ <code>run_id=4a59f6b6acbc45a6a6ec91b8ad28d485</code>ê°€ dev/prod ì–‘ìª½ì— ë™ì¼í•˜ê²Œ ë°˜ì˜ë¨</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>Airflow ìˆ˜ë™ ë¡¤ë°± DAG ì‹¤í–‰ ì´í›„, FastAPI ì„œë¹™ ë ˆì´ì–´ì—ì„œ <strong>A/B ëª¨ë‘ ì´ì „ ëª¨ë¸ ë²„ì „(1)</strong> ìœ¼ë¡œ ë³µì›ë¨ì„ í™•ì¸.</p><p>ì¦‰, <strong>MLflow â†’ Airflow â†’ FastAPI</strong> ì „ êµ¬ê°„ì´ ì—°ê²°ëœ <strong>ë¬´ì¤‘ë‹¨ ë³µêµ¬ íŒŒì´í”„ë¼ì¸</strong>ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í–ˆìŒì„ ì™„ë²½íˆ ì¦ëª…í•©ë‹ˆë‹¤.</p></blockquote><hr><h1 id=7--ë¡œê·¸-ìŠ¤í† ë¦¬ì§€s3nfs>7) ğŸ“‘ ë¡œê·¸ ìŠ¤í† ë¦¬ì§€(S3+NFS)<a hidden class=anchor aria-hidden=true href=#7--ë¡œê·¸-ìŠ¤í† ë¦¬ì§€s3nfs>#</a></h1><h2 id=7-1-airflow-ë¡œê·¸-s3-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½><strong>7-1) Airflow ë¡œê·¸ S3 ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#7-1-airflow-ë¡œê·¸-s3-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-07-logs-airflow-s3-dev.png loading=lazy src=/mlops-journey/images/proof-07-logs-airflow-s3-dev.png></p><p>ğŸ“¸ <code>proof-07-logs-airflow-s3-dev.png</code></p><p><img alt=proof-07-logs-airflow-s3-prod.png loading=lazy src=/mlops-journey/images/proof-07-logs-airflow-s3-prod.png></p><p>ğŸ“¸ <code>proof-07-logs-airflow-s3-prod.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>ë²„í‚· ê²½ë¡œ: <code>s3://airflow-logs/dag_id=manual_rollback_model_dev/</code></li><li>íƒœìŠ¤í¬: <code>task_id=reload_fastapi_model/</code></li><li>ë¡œê·¸ íŒŒì¼: <code>attempt=1.log</code> (2025-10-10 19:45:10 KST ì €ì¥)</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>Airflowê°€ <code>manual_rollback_model_dev</code> DAG ì‹¤í–‰ ë¡œê·¸ë¥¼ S3 ë²„í‚·ì— ìë™ ì—…ë¡œë“œí•˜ì—¬ <strong>ëª¨ë“  ë³µêµ¬ ì‹¤í–‰ ì´ë ¥(rollbacks & reloads)</strong> ì´ ì¤‘ì•™í™”ëœ ì €ì¥ì†Œì— ì•ˆì „í•˜ê²Œ ê¸°ë¡ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.</p><p>ì´ëŠ” <strong>ìš´ì˜ ê°€ì‹œì„± í™•ë³´ + ì¥ì•  ì›ì¸ ì¶”ì  + ê°ì‚¬ ë¡œê·¸(Audit Log)</strong> ì²´ê³„ì˜ í•µì‹¬ ê¸°ë°˜ì…ë‹ˆë‹¤.</p></blockquote><h2 id=7-2-fastapi-ë¡œê·¸-nfs-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½><strong>7-2) FastAPI ë¡œê·¸ NFS ì €ì¥ ê²€ì¦ (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#7-2-fastapi-ë¡œê·¸-nfs-ì €ì¥-ê²€ì¦-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-07-logs-fastapi-nfs.png loading=lazy src=/mlops-journey/images/proof-07-logs-fastapi-nfs.png></p><p>ğŸ“¸ <code>proof-07-logs-fastapi-nfs.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>ë¡œê·¸ ê²½ë¡œ: <code>/mnt/nfs_share/mlops/fastapi/logs/{dev,prod}/fastapi.log</code></li><li>ì£¼ìš” ë¡œê·¸:<ul><li><code>[âœ”] ëª¨ë¸ ë¡œë”© ì„±ê³µ : alias=A, version=1</code></li><li><code>[âœ”] ëª¨ë¸ ë¡œë”© ì„±ê³µ : alias=B, version=2</code></li></ul></li><li>ë¡¤ë°± ì´í›„ ì¬ì‹œì‘ ì‹œì—ë„ ë™ì¼í•œ aliasÂ·version ë¡œë“œ ë‚´ì—­ì´ ê¸°ë¡ë¨</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>FastAPI ì¸ìŠ¤í„´ìŠ¤ê°€ dev/prod ì–‘ìª½ì—ì„œ <strong>NFS ë§ˆìš´íŠ¸ ê¸°ë°˜ ì¤‘ì•™ ë¡œê·¸ ìˆ˜ì§‘</strong>ì„ ìˆ˜í–‰ ì¤‘ì´ë©°,</p><p>ëª¨ë¸ ë¡œë“œ ì´ë²¤íŠ¸(A/B, ë²„ì „ ë³€ë™ í¬í•¨)ê°€ íŒŒì¼ ë‹¨ìœ„ë¡œ ê¸°ë¡ë¨ì„ í™•ì¸.</p><p>ì´ëŠ” <strong>ì‹¤ì‹œê°„ ë³µêµ¬ ê²€ì¦ ë° ì¶”ì  ê°€ëŠ¥í•œ ëª¨ë¸ ì„œë¹™ ë¡œê·¸ ì²´ê³„</strong>ê°€ êµ¬ì¶•ë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p></blockquote><hr><h1 id=8--argocdslack-ê´€ì œ-ë£¨í”„><strong>8) ğŸ›°ï¸ ArgoCDâ†”ï¸Slack ê´€ì œ ë£¨í”„</strong><a hidden class=anchor aria-hidden=true href=#8--argocdslack-ê´€ì œ-ë£¨í”„>#</a></h1><p><img alt=proof-08-argocd-slack.png loading=lazy src=/mlops-journey/images/proof-08-argocd-slack.png></p><p>ğŸ“¸ <code>proof-08-argocd-slack.png</code></p><p><img alt=proof-08-argocd-slack-2.png loading=lazy src=/mlops-journey/images/proof-08-argocd-slack-2.png></p><p>ğŸ“¸ <code>proof-08-argocd-slack-2.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li><code>airflow-dev</code>, <code>airflow-prod</code>, <code>fastapi-logs-storage-dev/prod</code>, <code>prod-secrets</code> ë“± ì£¼ìš” ì•±ì˜ ìƒíƒœ ë³€í™”ê°€ Slack ì±„ë„(<code>argocd</code>)ì— ìë™ ì „ì†¡</li><li>ìƒíƒœ ì „ì´ ê°ì§€:<ul><li><code>Sync OutOfSync â†’ Health Healthy</code></li><li><code>Health Degraded â†’ Healthy</code></li><li><code>Sync Failed</code> ì‹œ <code>âŒ Error</code> ë©”ì‹œì§€ í¬í•¨</li></ul></li><li>ë§í¬(<code>Open in ArgoCD</code>)ë¡œ ì¦‰ì‹œ ArgoCD UI ì ‘ê·¼ ê°€ëŠ¥</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>ArgoCDì™€ Slackì´ ì™„ì „ ì—°ë™ë˜ì–´, <strong>ë°°í¬Â·SyncÂ·Health ìƒíƒœ ë³€í™”ê°€ ì‹¤ì‹œê°„ ê°ì‹œ ì²´ê³„ë¡œ í†µí•©</strong>ë¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.</p><p>ì¦‰, ëª¨ë¸ ë¡¤ë°±Â·í•«ìŠ¤ì™‘Â·ì¬ë°°í¬ í›„ì—ë„ ëª¨ë“  ArgoCD Applicationì˜ <strong>Sync/Health ìƒíƒœê°€ ìë™ìœ¼ë¡œ ë³µì›Â·ë³´ê³ ë˜ëŠ” ììœ¨ ê°ì‹œ ë£¨í”„</strong>ê°€ êµ¬ì¶•ëœ ê²ƒì…ë‹ˆë‹¤.</p></blockquote><hr><h1 id=9--ë³´ì•ˆ-ìë™í™”í¬ë¦¬ë´ì…œì‹œí¬ë¦¿>9) ğŸ” ë³´ì•ˆ ìë™í™”(í¬ë¦¬ë´ì…œ/ì‹œí¬ë¦¿)<a hidden class=anchor aria-hidden=true href=#9--ë³´ì•ˆ-ìë™í™”í¬ë¦¬ë´ì…œì‹œí¬ë¦¿>#</a></h1><h2 id=9-1-a-aws-credentials-secret-rotation-before-ìƒíƒœ><strong>9-1-a) AWS Credentials Secret Rotation (Before ìƒíƒœ)</strong><a hidden class=anchor aria-hidden=true href=#9-1-a-aws-credentials-secret-rotation-before-ìƒíƒœ>#</a></h2><p><img alt=proof-09-rotation-resourceversion-before.png loading=lazy src=/mlops-journey/images/proof-09-rotation-resourceversion-before.png></p><p>ğŸ“¸ <code>proof-09-rotation-resourceversion-before.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>í™•ì¸ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤: <code>airflow-dev</code>, <code>fastapi-dev</code>, <code>mlflow-dev</code>, <code>airflow-prod</code>, <code>fastapi-prod</code>, <code>mlflow-prod</code></li><li>ê° Secret(<code>aws-credentials-secret</code>)ì˜ <code>resourceVersion</code> ê°’ì´ ëª¨ë‘ <strong>ì„œë¡œ ë‹¤ë¦„ (21xxxxëŒ€)</strong></li><li>ì•„ì§ ë™ê¸°í™”(íšŒì „) ì „ ìƒíƒœì„</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>Secret rotation ì‹¤í–‰ ì „ì˜ baseline snapshotìœ¼ë¡œ,</p><p><strong>í™˜ê²½ë³„ AWS Credentials Secret ë¦¬ì†ŒìŠ¤ ë²„ì „ì´ ìƒì´í•¨ì„ ëª…í™•íˆ ê¸°ë¡</strong>í•¨.</p><p>ì´í›„ rotation ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í›„ ì´ ê°’ë“¤ì´ ê°±ì‹ ë˜ì–´ì•¼ ì •ìƒ ë™ì‘ìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.</p><p>ì¦‰, ì´ ì´ë¯¸ì§€ëŠ” <strong>í‚¤ íšŒì „ ì „ ì •ìƒ baseline ìƒíƒœ</strong>ë¥¼ ì¦ëª…í•©ë‹ˆë‹¤.</p></blockquote><h2 id=9-1-b-aws-credentials-secret-rotation-ì´ì „-í‚¤-ì¤‘ë³µ-ê°ì§€-ì‹¤íŒ¨-ì‚¬ë¡€><strong>9-1-b) AWS Credentials Secret Rotation (ì´ì „ í‚¤ ì¤‘ë³µ ê°ì§€ ì‹¤íŒ¨ ì‚¬ë¡€)</strong><a hidden class=anchor aria-hidden=true href=#9-1-b-aws-credentials-secret-rotation-ì´ì „-í‚¤-ì¤‘ë³µ-ê°ì§€-ì‹¤íŒ¨-ì‚¬ë¡€>#</a></h2><p><img alt=proof-09-rotation-oldkeys-fails.png loading=lazy src=/mlops-journey/images/proof-09-rotation-oldkeys-fails.png></p><p>ğŸ“¸ <code>proof-09-rotation-oldkeys-fails.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li>ì‹¤í–‰ ëª…ë ¹: <code>bash rotate-aws-credentials.sh dev</code></li><li>IAM User: <code>mlflow-airflow-user</code></li><li>ê°ì§€ëœ ê¸°ì¡´ í‚¤: <code>AKIA********CB7Z</code></li><li>ì—ëŸ¬ ë©”ì‹œì§€: <code>ERROR: mlflow-airflow-userì— ì´ë¯¸ í‚¤ 2ê°œ ì¡´ì¬. í•˜ë‚˜ ë¹„í™œì„±/ì‚­ì œ í›„ ì¬ì‹œë„.</code></li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>IAM ì‚¬ìš©ìì˜ ì•¡ì„¸ìŠ¤ í‚¤ê°€ <strong>ì´ë¯¸ ë‘ ê°œ ëª¨ë‘ í™œì„± ìƒíƒœ</strong>ì—¬ì„œ,</p><p>ìƒˆ í‚¤ë¥¼ ë°œê¸‰í•  ìˆ˜ ì—†ë‹¤ëŠ” AWS ì œí•œ(ìµœëŒ€ 2ê°œ)ìœ¼ë¡œ íšŒì „ í”„ë¡œì„¸ìŠ¤ê°€ ì•ˆì „í•˜ê²Œ ì¤‘ë‹¨ë¨.</p><p>ì¦‰, ìŠ¤í¬ë¦½íŠ¸ì˜ <strong>ì‚¬ì „ ê²€ì¦ ë¡œì§ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì—¬ ì¤‘ë³µ ë°œê¸‰ ë°©ì§€</strong> ê¸°ëŠ¥ì´ ìœ íš¨í•¨ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p></blockquote><h2 id=9-1-c-aws-credentials-secret-rotation-íšŒì „-ë°-argocd-ë°˜ì˜-ì™„ë£Œ-dev-prod-í™˜ê²½><strong>9-1-c) AWS Credentials Secret Rotation (íšŒì „ ë° ArgoCD ë°˜ì˜ ì™„ë£Œ) (dev, prod í™˜ê²½)</strong><a hidden class=anchor aria-hidden=true href=#9-1-c-aws-credentials-secret-rotation-íšŒì „-ë°-argocd-ë°˜ì˜-ì™„ë£Œ-dev-prod-í™˜ê²½>#</a></h2><p><img alt=proof-09-rotation-rotate-log-dev-1.png loading=lazy src=/mlops-journey/images/proof-09-rotation-rotate-log-dev-1.png></p><p>ğŸ“¸ <code>proof-09-rotation-rotate-log-dev-1.png</code></p><p><img alt=proof-09-rotation-rotate-log-dev-2.png loading=lazy src=/mlops-journey/images/proof-09-rotation-rotate-log-dev-2.png></p><p>ğŸ“¸ <code>proof-09-rotation-rotate-log-dev-2.png</code></p><p><img alt=proof-09-rotation-rotate-log-prod-1.png loading=lazy src=/mlops-journey/images/proof-09-rotation-rotate-log-prod-1.png></p><p>ğŸ“¸ <code>proof-09-rotation-rotate-log-prod-1.png</code></p><p><img alt=proof-09-rotation-rotate-log-prod-2.png loading=lazy src=/mlops-journey/images/proof-09-rotation-rotate-log-prod-2.png></p><p>ğŸ“¸ <code>proof-09-rotation-rotate-log-prod-2.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸:</p><ul><li><strong>dev</strong><ul><li>IAM User: <code>mlflow-airflow-dev-user</code></li><li>ìƒˆ í‚¤: <code>AKIA********IH5</code></li><li><code>feat(dev): rotate AWS credentials across airflow/fastapi/mlflow</code> ì»¤ë°‹</li><li><code>/root/backup/...json</code> ë°±ì—… ì™„ë£Œ</li><li>ArgoCD <code>dev-secrets</code> â†’ <code>Sync Succeeded</code>, ëª¨ë“  SealedSecret <code>Synced / Healthy</code></li><li><code>resourceVersion</code> ì¦ê°€ í™•ì¸ (<code>2161301</code> â†’ <code>2162096</code>)</li></ul></li><li><strong>prod</strong><ul><li>IAM User: <code>mlflow-airflow-user</code></li><li>ìƒˆ í‚¤: <code>AKIA********GH</code></li><li><code>feat(prod): rotate AWS credentials across airflow/fastapi/mlflow</code> ì»¤ë°‹</li><li>ArgoCD <code>prod-secrets</code> â†’ <code>Sync Succeeded</code>, ëª¨ë“  SealedSecret <code>Synced / Healthy</code></li><li><code>resourceVersion</code> ì¦ê°€ í™•ì¸ (<code>2148011</code> â†’ <code>2162479</code>)</li></ul></li><li>ëª¨ë“  ë‹¨ê³„ì—ì„œ<ul><li>GitHub Push â†’ ArgoCD Auto Sync â†’ SealedSecret ì ìš© â†’ AWS CLI ê²€ì¦ â†’ êµ¬ í‚¤ Inactive ê¶Œê³  ë©”ì‹œì§€ê¹Œì§€ ìë™ ì¶œë ¥.</li><li>í‚¤ íšŒì „ í›„ ì„œë¹„ìŠ¤ ì˜í–¥ ì—†ì´ ì •ìƒ ìš´ì˜ ìœ ì§€.</li></ul></li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><p>dev/prod ì „ êµ¬ê°„ì˜ AWS ìê²© ì¦ëª…ì´</p><p><strong>ë‹¨ì¼ ëª…ë ¹ìœ¼ë¡œ ì™„ì „ ìë™ íšŒì „ + GitOps ì—°ë™ + ë¬´ì¤‘ë‹¨ ë°˜ì˜</strong>ë¨ì„ ì…ì¦.</p><p>ì¦‰, ë³´ì•ˆ/ìš´ì˜/ìë™í™” 3ìš”ì†Œê°€ ì™„ë²½íˆ í†µí•©ëœ SealedSecret ê¸°ë°˜ Key Rotation êµ¬ì¡°ì„ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.</p></blockquote><h2 id=9-1-d-aws-credentials-secret-rotation--ë¦¬ì†ŒìŠ¤-ë²„ì „-ë¹„êµ-ì¦ëª…><strong>9-1-d) AWS Credentials Secret Rotation (ë¦¬ì†ŒìŠ¤ ë²„ì „ ë¹„êµ ì¦ëª…)</strong><a hidden class=anchor aria-hidden=true href=#9-1-d-aws-credentials-secret-rotation--ë¦¬ì†ŒìŠ¤-ë²„ì „-ë¹„êµ-ì¦ëª…>#</a></h2><p><img alt=proof-09-rotation-resourceversion-after.png loading=lazy src=/mlops-journey/images/proof-09-rotation-resourceversion-after.png></p><p>ğŸ“¸ <code>proof-09-rotation-resourceversion-after.png</code></p><blockquote><p>âœ… ë³€ê²½ ì „ (before) â†’ ë³€ê²½ í›„ (after) ë¹„êµ</p><table><thead><tr><th>Namespace</th><th>Secret</th><th>Before</th><th>After</th><th>ì¦ê°€ ì—¬ë¶€</th></tr></thead><tbody><tr><td>airflow-dev</td><td>aws-credentials-secret</td><td>2161270</td><td><strong>2161994</strong></td><td>âœ…</td></tr><tr><td>fastapi-dev</td><td>aws-credentials-secret</td><td>2161277</td><td><strong>2162035</strong></td><td>âœ…</td></tr><tr><td>mlflow-dev</td><td>aws-credentials-secret</td><td>2161301</td><td><strong>2162098</strong></td><td>âœ…</td></tr><tr><td>airflow-prod</td><td>aws-credentials-secret</td><td>2148004</td><td><strong>2162742</strong></td><td>âœ…</td></tr><tr><td>fastapi-prod</td><td>aws-credentials-secret</td><td>2147983</td><td><strong>2162770</strong></td><td>âœ…</td></tr><tr><td>mlflow-prod</td><td>aws-credentials-secret</td><td>2148011</td><td><strong>2162749</strong></td><td>âœ…</td></tr></tbody></table><p>ğŸ” ëª¨ë“  dev/prod Secretì˜ <code>resourceVersion</code>ì´ ì¦ê°€í–ˆìœ¼ë©°,</p><p>ì´ëŠ” SealedSecret â†’ Secret â†’ Pod ë°˜ì˜ê¹Œì§€ ìë™ ì—…ë°ì´íŠ¸ëœ ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p><p>ArgoCD Sync, AWS CLI ê²€ì¦, êµ¬ í‚¤ Inactive í™•ì¸ê¹Œì§€ ì¼ë ¨ì˜ ìë™í™” ì²´ì¸ì´</p><p>ì •ìƒì ìœ¼ë¡œ ë™ì‘í•¨ì„ ìµœì¢…ì ìœ¼ë¡œ ì…ì¦í•©ë‹ˆë‹¤.</p></blockquote><h2 id=9-1-e-aws-credentials-secret-rotation-argocd-ìµœì¢…-ìƒíƒœ-ê²€ì¦><strong>9-1-e) AWS Credentials Secret Rotation (ArgoCD ìµœì¢… ìƒíƒœ ê²€ì¦)</strong><a hidden class=anchor aria-hidden=true href=#9-1-e-aws-credentials-secret-rotation-argocd-ìµœì¢…-ìƒíƒœ-ê²€ì¦>#</a></h2><p><img alt=proof-09-rotation-argocd-synced.png loading=lazy src=/mlops-journey/images/proof-09-rotation-argocd-synced.png></p><p>ğŸ“¸ <code>proof-09-rotation-argocd-synced.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><p>ArgoCD ì•± <code>dev-secrets</code>, <code>prod-secrets</code> ëª¨ë‘</p><ul><li><code>Status: Healthy / Synced</code></li><li><code>Last Synced</code>: 2025-10-15 14:26~14:28 (íšŒì „ ì§í›„ ëª‡ ì´ˆ ë‚´ ìë™ ë™ê¸°í™”)</li><li>Git ë¦¬í¬ì§€í† ë¦¬: <code>https://github.com/keonhoban/mlops-infra-gitops</code></li><li>Path: <code>envs/dev/sealed-secrets</code>, <code>envs/prod/sealed-secrets</code></li></ul></li><li><p><strong>ì˜ë¯¸:</strong> í‚¤ íšŒì „ ì§í›„ ìë™ìœ¼ë¡œ GitOps ë°˜ì˜ì´ ì™„ë£Œë˜ì–´</p><p>ìˆ˜ë™ intervention ì—†ì´ ëª¨ë“  Secretì´ ìµœì‹  ìƒíƒœë¡œ ìœ ì§€ë¨.</p></li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸:</p><ul><li><p><code>dev</code>, <code>prod</code> ì „ í™˜ê²½ì˜ <strong>AWS Credentials Secret Rotation ìë™í™” ë£¨í”„ê°€ ì™„ì „íˆ íì‡„(Closed Loop)</strong> ë˜ì—ˆìŠµë‹ˆë‹¤.</p></li><li><p>SealedSecret â†’ Secret â†’ Pod â†’ ArgoCD â†’ Git â†’ AWSê¹Œì§€</p><p>ë‹¨ì¼ ëª…ë ¹(<code>bash rotate-aws-credentials.sh &lt;env></code>)ë¡œ ì „ ê³¼ì •ì´ <strong>ìë™í™”</strong>ë˜ê³ ,</p><p><strong>ë¬´ì¤‘ë‹¨Â·ë¬´ì¸ ê°œì…Â·ì™„ì „ ê°€ì‹œí™”</strong> ìˆ˜ì¤€ì˜ ìš´ì˜ ì²´ê³„ë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.</p></li></ul></blockquote><h2 id=9-2-a-sealedsecret-controller--re-seal-ì»¨íŠ¸ë¡¤ëŸ¬-í‚¤-ì¬ë°œê¸‰-ë°-fingerprint-ê²€ì¦><strong>9-2-a)</strong> SealedSecret Controller & Re-seal <strong>(ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ ì¬ë°œê¸‰ ë° fingerprint ê²€ì¦)</strong><a hidden class=anchor aria-hidden=true href=#9-2-a-sealedsecret-controller--re-seal-ì»¨íŠ¸ë¡¤ëŸ¬-í‚¤-ì¬ë°œê¸‰-ë°-fingerprint-ê²€ì¦>#</a></h2><p><img alt=proof-09-reseal-pub-cert-fingerprint-diff.png loading=lazy src=/mlops-journey/images/proof-09-reseal-pub-cert-fingerprint-diff.png></p><p>ğŸ“¸ <code>proof-09-reseal-pub-cert-fingerprint-diff.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>ì‹ ê·œ Controller fingerprint: <code>CE:1C:D4:0D:F4:C5:B6:CB:02:C1:F5:85:08:6E:36:E1:70:CA:E9:31:15:0F:4B:77:EC:F0:A4:19:E6:FC:49:8C</code></li><li>dev/prod í™˜ê²½ ëª¨ë‘ ì¬seal ì™„ë£Œ, GitOps main ë°˜ì˜ ë° ì¼ì¹˜ ê²€ì¦ OK</li></ul></blockquote><blockquote><p>ğŸ§© ì˜ë¯¸</p><ul><li>SealedSecret ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ê°€ êµì²´ë˜ì–´ ëª¨ë“  ì‹œí¬ë¦¿ì´ ìµœì‹  ê³µê°œí‚¤ë¡œ ì•”í˜¸í™”ë¨.</li><li>í‚¤ íšŒì „ í›„ ë¬´ì¤‘ë‹¨ GitOps í™˜ê²½ì´ ì •ìƒ ìœ ì§€ë¨ì„ ì¦ëª….</li></ul></blockquote><h2 id=9-2-b-sealedsecret-controller--re-seal-><strong>9-2-b)</strong> SealedSecret Controller & Re-seal <strong>(<strong>ArgoCD ë°˜ì˜ í™•ì¸</strong>)</strong><a hidden class=anchor aria-hidden=true href=#9-2-b-sealedsecret-controller--re-seal->#</a></h2><p><img alt=proof-09-reseal-argocd-synced.png loading=lazy src=/mlops-journey/images/proof-09-reseal-argocd-synced.png></p><p>ğŸ“¸ <code>proof-09-reseal-argocd-synced.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>dev/prod ì „ ì•±(<code>airflow</code>, <code>mlflow</code>, <code>fastapi</code>, <code>secrets</code>, <code>logs</code>, <code>notifications</code> ë“±) ìƒíƒœ: <strong>Healthy Â· Synced</strong></li><li>Controller í‚¤ íšŒì „ ì´í›„ ëª¨ë“  SealedSecret ì¬ë°°í¬ ì™„ë£Œ</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>Re-Seal ì‘ì—…ì´ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì •ìƒ ë°˜ì˜ë˜ì—ˆìŒì„ ì¦ëª….</li><li>í‚¤ êµì²´ í›„ ArgoCD GitOps íŒŒì´í”„ë¼ì¸ ì „ì²´ê°€ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€ë¨.</li></ul></blockquote><hr><h1 id=10-íŠ¸ë˜í”½-ì‹¤í—˜--ab--canary--blue-green>10) ğŸš¦íŠ¸ë˜í”½ ì‹¤í—˜ â€” A/B Â· Canary Â· Blue-Green<a hidden class=anchor aria-hidden=true href=#10-íŠ¸ë˜í”½-ì‹¤í—˜--ab--canary--blue-green>#</a></h1><blockquote><p>FastAPIì˜ ë¼ìš°íŒ…ì€ valuesë¡œ ì œì–´ë©ë‹ˆë‹¤.</p><p>ìš´ì˜ ì¤‘ <strong>ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸ ì—†ì´</strong> íŠ¸ë˜í”½ë§Œ ì¡°ì ˆí•˜ë ¤ë©´</p><p><strong>A/B/Canary/Blue-Green</strong> ì¤‘ <strong>Canary/Blue-Green</strong> ê¶Œì¥</p></blockquote><p>(GitOps: <code>charts/fastapi/values/{dev,prod}.yaml</code> â†’ <code>ALIAS_SELECTION_MODE</code>, <code>DEFAULT_ALIAS</code>, <code>CANARY_PERCENT</code>)</p><p><strong>í•©ê²© ê¸°ì¤€ í‘œ</strong></p><ul><li><strong>A/B</strong>ëŠ” í†µê³„ì  ì‹¤í—˜(90:10)</li><li><strong>Canary</strong>ëŠ” ì ì§„ ë°°í¬(10~30%)</li><li><strong>Blue-Green</strong>ì€ ì™„ì „ ì „í™˜(100%)</li></ul><table><thead><tr><th>ìœ í˜•</th><th>values ì„¤ì •</th><th>ê¸°ëŒ€ ë¶„í¬</th></tr></thead><tbody><tr><td>A/B</td><td><code>ALIAS_SELECTION_MODE=ab_test</code></td><td>A/B â‰ˆ 90:10</td></tr><tr><td>Canary(n%)</td><td><code>ALIAS_SELECTION_MODE=canary</code>,<code>CANARY_PERCENT=30</code></td><td>B â‰ˆ 30%</td></tr><tr><td>Blue-Green</td><td><code>ALIAS_SELECTION_MODE=blue_green</code>,<code>DEFAULT_ALIAS=B</code></td><td>B = 100%</td></tr></tbody></table><h2 id=-í…ŒìŠ¤íŠ¸-ìŠ¤í¬ë¦½íŠ¸-abcanaryblue-green-ê³µìš©>ğŸ“ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ (A/BÂ·CanaryÂ·Blue-Green ê³µìš©)<a hidden class=anchor aria-hidden=true href=#-í…ŒìŠ¤íŠ¸-ìŠ¤í¬ë¦½íŠ¸-abcanaryblue-green-ê³µìš©>#</a></h2><p><strong>íŒŒì¼</strong>: <code>/ops/ab_test.sh</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#75715e># ab_test.sh â€” A/B/Canary/Blue-Green ë¶„í¬ ê²€ì¦</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ì‚¬ìš©: ./ab_test.sh [N]  (ê¸°ë³¸ N=200)</span>
</span></span><span style=display:flex><span>set -euo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>N<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>1<span style=color:#66d9ef>:-</span>200<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>URL<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>FASTAPI_URL<span style=color:#66d9ef>:-</span><span style=color:#e6db74>&#34;https://fastapi.local&#34;</span><span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>PAYLOAD<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;data&#34;: [[5.1, 3.5, 1.4, 0.2]]}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;ğŸ” A/BÂ·CanaryÂ·Blue-Green ë¶„í¬ í™•ì¸ (</span><span style=color:#e6db74>${</span>N<span style=color:#e6db74>}</span><span style=color:#e6db74>ê±´)&#34;</span>
</span></span><span style=display:flex><span>: &gt; ab_test_result.log
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#66d9ef>$(</span>seq <span style=color:#ae81ff>1</span> $N<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  id<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;client_</span>$i<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  variant<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>curl -sk <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>URL<span style=color:#e6db74>}</span><span style=color:#e6db74>/predict&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -H <span style=color:#e6db74>&#34;x-client-id: </span><span style=color:#e6db74>${</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    -d <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>PAYLOAD<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> | jq -r <span style=color:#e6db74>&#39;.variant&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;</span>$id<span style=color:#e6db74> â†’ </span>$variant<span style=color:#e6db74>&#34;</span> | tee -a ab_test_result.log &gt;/dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>count_B<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>grep -c <span style=color:#e6db74>&#34;â†’ B&#34;</span> ab_test_result.log <span style=color:#f92672>||</span> true<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>count_A<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span>N <span style=color:#f92672>-</span> count_B<span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>ratio<span style=color:#f92672>=</span><span style=color:#66d9ef>$((</span>count_B <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span> <span style=color:#f92672>/</span> N<span style=color:#66d9ef>))</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;ğŸ“Š ê²°ê³¼: A=</span><span style=color:#e6db74>${</span>count_A<span style=color:#e6db74>}</span><span style=color:#e6db74>, B=</span><span style=color:#e6db74>${</span>count_B<span style=color:#e6db74>}</span><span style=color:#e6db74> (B=</span><span style=color:#e6db74>${</span>ratio<span style=color:#e6db74>}</span><span style=color:#e6db74>%)&#34;</span>
</span></span></code></pre></div><p><strong>íŒŒì¼</strong>: <code>/ops/capture_test.sh</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>set -euo pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mode<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>1<span style=color:#66d9ef>:-</span>ab_test<span style=color:#e6db74>}</span>  <span style=color:#75715e># ab_test, canary, blue_green</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;==============================&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;ğŸ§ª í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì‹œì‘: </span>$mode<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;==============================&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>grep -A <span style=color:#ae81ff>10</span> <span style=color:#e6db74>&#39;^env:&#39;</span> charts/fastapi/values/dev.yaml
</span></span><span style=display:flex><span>yq e <span style=color:#e6db74>&#34;.env.ALIAS_SELECTION_MODE=\&#34;</span>$mode<span style=color:#e6db74>\&#34;&#34;</span> -i charts/fastapi/values/dev.yaml
</span></span><span style=display:flex><span>grep -A <span style=color:#ae81ff>10</span> <span style=color:#e6db74>&#39;^env:&#39;</span> charts/fastapi/values/dev.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>git add charts/fastapi/values/dev.yaml
</span></span><span style=display:flex><span>git commit -am <span style=color:#e6db74>&#34;test: </span>$mode<span style=color:#e6db74> routing&#34;</span> <span style=color:#f92672>&amp;&amp;</span> git push
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;â³ ArgoCD ë™ê¸°í™” ëŒ€ê¸° ì¤‘...&#34;</span>
</span></span><span style=display:flex><span>sleep <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;ğŸš€ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘ (</span>$mode<span style=color:#e6db74>)&#34;</span>
</span></span><span style=display:flex><span>./ops/ab_test.sh <span style=color:#ae81ff>500</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;âœ… í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì¢…ë£Œ: </span>$mode<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span></code></pre></div><h2 id=10-1-ab-í…ŒìŠ¤íŠ¸>10-1) A/B í…ŒìŠ¤íŠ¸<a hidden class=anchor aria-hidden=true href=#10-1-ab-í…ŒìŠ¤íŠ¸>#</a></h2><ul><li><strong>ì„¤ì •</strong>: <code>ALIAS_SELECTION_MODE=ab_test</code></li><li><strong>ìŠ¤í¬ë¦½íŠ¸</strong>: <code>/ops/ab_test.sh 200</code></li><li><strong>í•©ê²© ê¸°ì¤€</strong>: <strong>A/B ë¶„í¬ â‰ˆ 90:10</strong> (ìƒ˜í”Œ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ê·¼ì ‘)</li></ul><p>ğŸ“¸ <code>proof-10-ab_test.png</code></p><p><img alt=proof-10-ab_test.png loading=lazy src=/mlops-journey/images/proof-10-ab_test.png></p><h2 id=10-2-canaryì˜ˆ-30>10-2) Canary(ì˜ˆ: 30%)<a hidden class=anchor aria-hidden=true href=#10-2-canaryì˜ˆ-30>#</a></h2><ul><li><strong>ì„¤ì •</strong>: <code>ALIAS_SELECTION_MODE=canary</code>, <code>CANARY_PERCENT=30</code></li><li><strong>ìŠ¤í¬ë¦½íŠ¸</strong>: <code>/ops/ab_test.sh 500</code></li><li><strong>í•©ê²© ê¸°ì¤€</strong>: <strong>B â‰ˆ 30% Â± (í‘œë³¸ ì˜¤ì°¨ ë²”ìœ„)</strong></li></ul><p>ğŸ“¸ <code>proof-10-canary.png</code></p><p><img alt=proof-10-canary.png loading=lazy src=/mlops-journey/images/proof-10-canary.png></p><h2 id=10-3-blue-green-ì „í™˜>10-3) Blue-Green ì „í™˜<a hidden class=anchor aria-hidden=true href=#10-3-blue-green-ì „í™˜>#</a></h2><ul><li><strong>ì„¤ì •</strong>: <code>ALIAS_SELECTION_MODE=blue_green</code>, <code>DEFAULT_ALIAS=B</code></li><li><strong>ìŠ¤í¬ë¦½íŠ¸</strong>: <code>/ops/ab_test.sh 100</code></li><li><strong>í•©ê²© ê¸°ì¤€</strong>: <strong>B = 100%</strong> (ì™„ì „ ì „í™˜)</li></ul><p>ğŸ“¸ <code>proof-10-blue_green.png</code></p><p><img alt=proof-10-blue_green.png loading=lazy src=/mlops-journey/images/proof-10-blue_green.png></p><hr><h1 id=11--one-commit-flow-ì „ì²´-ì²´ì¸>11) ğŸ”— One-Commit Flow ì „ì²´ ì²´ì¸<a hidden class=anchor aria-hidden=true href=#11--one-commit-flow-ì „ì²´-ì²´ì¸>#</a></h1><h2 id=11-1-ì‚¬ì „-ì¤€ë¹„-1íšŒë§Œ>11-1) ì‚¬ì „ ì¤€ë¹„ (1íšŒë§Œ)<a hidden class=anchor aria-hidden=true href=#11-1-ì‚¬ì „-ì¤€ë¹„-1íšŒë§Œ>#</a></h2><ul><li><code>charts/fastapi/values/{dev,prod}.yaml</code>ì˜ <strong>ALIAS_SELECTION_MODE / DEFAULT_ALIAS / CANARY_PERCENT</strong> ê°’ë§Œ ë°”ê¿”ê°€ë©° í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤</li><li>í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ <code>/ops/ab_test.sh</code> (ì´ë¯¸ ê³µìœ ëœ ë²„ì „) ì‚¬ìš© â€” ëª¨ë“œ ì „í™˜ ì—†ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš© ê°€ëŠ¥</li><li>ë‚´ë¶€ë§ TLSëŠ” <strong>cert-manager ë‚´ë¶€ CA + hosts</strong> ì „ì œë¡œ ë™ì‘(í˜„ì¬ ì„¸íŒ… ìœ ì§€)</li></ul><hr><h2 id=11-2--git-ë¸Œëœì¹˜-ìƒì„±-ë°-pr-íŠ¸ë¦¬ê±°>11-2) ğŸ§± Git ë¸Œëœì¹˜ ìƒì„± ë° PR íŠ¸ë¦¬ê±°<a hidden class=anchor aria-hidden=true href=#11-2--git-ë¸Œëœì¹˜-ìƒì„±-ë°-pr-íŠ¸ë¦¬ê±°>#</a></h2><p><img alt=proof-11-git-pr-trigger.png loading=lazy src=/mlops-journey/images/proof-11-git-pr-trigger.png></p><p>ğŸ“¸ <code>proof-11-git-pr-trigger.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>feat/one-commit-flow-test</code> ë¸Œëœì¹˜ ìƒì„± í›„ Helm CI íŠ¸ë¦¬ê±°ìš© ì»¤ë°‹ í‘¸ì‹œ ì™„ë£Œ</li><li>GitHub PR ìë™ ìƒì„± URL ì¶œë ¥ë¨</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>CI/CD íŒŒì´í”„ë¼ì¸ì´ ì»¤ë°‹ ë‹¨ìœ„ë¡œ ìë™ ì‹¤í–‰ë˜ë„ë¡ <strong>One-Commit Flow</strong>ì˜ ì‹œì‘ì ì„ ì¤€ë¹„í•¨.</li></ul></blockquote><h2 id=11-3--cicd-í†µí•©-ê²€ì¦-github-actions--argocd>11-3) âš™ï¸ CI/CD í†µí•© ê²€ì¦ (GitHub Actions + ArgoCD)<a hidden class=anchor aria-hidden=true href=#11-3--cicd-í†µí•©-ê²€ì¦-github-actions--argocd>#</a></h2><p><img alt=proof-11-ci-cd.png loading=lazy src=/mlops-journey/images/proof-11-ci-cd.png></p><p>ğŸ“¸ <code>proof-11-ci-cd.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>GitHub PRì—ì„œ Helm CI 6ê°œ í…ŒìŠ¤íŠ¸(dev/prod ë³‘ë ¬) ì „ë¶€ ì„±ê³µ</li><li>ArgoCD ë‚´ ëª¨ë“  ì•± ìƒíƒœ <code>Healthy Â· Synced</code> ìœ ì§€</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>Git ì»¤ë°‹ â†’ CI â†’ CDê¹Œì§€ ìë™ ì—°ë™ì´ ì™„ì„±ëœ <strong>One-Commit Flow ì „ì²´ íŒŒì´í”„ë¼ì¸ ê²€ì¦ ì™„ë£Œ</strong>.</li></ul></blockquote><h2 id=11-4--git-pr-ë³‘í•©--argocd-ìë™-sync>11-4) ğŸ”„ Git PR ë³‘í•© & ArgoCD ìë™ Sync<a hidden class=anchor aria-hidden=true href=#11-4--git-pr-ë³‘í•©--argocd-ìë™-sync>#</a></h2><p><img alt=proof-11-git-pr-merge-result.png loading=lazy src=/mlops-journey/images/proof-11-git-pr-merge-result.png></p><p>ğŸ“¸ <code>proof-11-git-pr-merge-result.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>main</code> ë¸Œëœì¹˜ì— PR ë³‘í•©(commit: <code>cccb1dd</code>) ì™„ë£Œ</li><li>ArgoCD ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¦‰ì‹œ <code>Healthy Â· Synced</code> ìƒíƒœ ìœ ì§€</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>ì½”ë“œ ë³‘í•© í›„ CD ìë™ ë°˜ì˜ê¹Œì§€ ì™„ì „ ìë™í™”ë¨ â†’ <strong>GitOps ê¸°ë°˜ â€œOne-Commit Flowâ€ ì‹¤ì‹œê°„ ë°˜ì˜ êµ¬ì¡° í™•ë¦½</strong>.</li></ul></blockquote><hr><h2 id=11-5--airflow-variables-ìë™-ë°˜ì˜-í™•ì¸>11-5) ğŸ“Š Airflow Variables ìë™ ë°˜ì˜ í™•ì¸<a hidden class=anchor aria-hidden=true href=#11-5--airflow-variables-ìë™-ë°˜ì˜-í™•ì¸>#</a></h2><p><img alt=proof-11-airflow-dev-variables.png loading=lazy src=/mlops-journey/images/proof-11-airflow-dev-variables.png></p><p>ğŸ“¸ <code>proof-11-airflow-dev-variables.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>rollback_version=2</code>, <code>rollback_alias=B</code>, <code>mlflow_alias=A</code> ë“± ìµœì‹  ìƒíƒœ ë°˜ì˜</li><li>PR ë³‘í•© ì´í›„ Airflow í™˜ê²½ ìë™ ì—…ë°ì´íŠ¸ ì™„ë£Œ</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>CI/CD íŒŒì´í”„ë¼ì¸ì„ í†µí•œ <strong>Airflow DAG í™˜ê²½ ë³€ìˆ˜ ìë™ ê°±ì‹ </strong>ê¹Œì§€ ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ë¨ â†’ ì™„ì „í•œ E2E ìë™í™” ê²€ì¦ ì™„ë£Œ.</li></ul></blockquote><h2 id=11-6--í•™ìŠµ--ë“±ë¡--í•«ìŠ¤ì™‘--slack-ì•Œë¦¼-ìë™í™”>11-6) ğŸ¤– í•™ìŠµ â†’ ë“±ë¡ â†’ í•«ìŠ¤ì™‘ â†’ Slack ì•Œë¦¼ ìë™í™”<a hidden class=anchor aria-hidden=true href=#11-6--í•™ìŠµ--ë“±ë¡--í•«ìŠ¤ì™‘--slack-ì•Œë¦¼-ìë™í™”>#</a></h2><p><img alt=proof-11-train-ready-reload-slack.png loading=lazy src=/mlops-journey/images/proof-11-train-ready-reload-slack.png></p><p>ğŸ“¸ <code>proof-11-train-ready-reload-slack.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>Airflow DAG(<code>ml_train_register_and_reload_dev</code>) ì „ Task <code>success</code></li><li>MLflow ì‹¤í—˜ <code>Finished</code> ë° <code>accuracy=0.9666</code></li><li>Slack ìë™ ì•Œë¦¼: ëª¨ë¸ ë“±ë¡(<code>best_model v8 â†’ @A</code>) â†’ í•«ìŠ¤ì™‘ ì™„ë£Œ(<code>@A</code>)</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>CI/CD ì´í›„ <strong>ëª¨ë¸ í•™ìŠµë¶€í„° FastAPI ì‹¤ì‹œê°„ ë°˜ì˜ê¹Œì§€ ì™„ì „ ìë™í™” ë£¨í”„</strong> ë‹¬ì„± â†’ ì§„ì •í•œ â€œOne-Commit Flowâ€ ì™„ì„± ğŸš€</li></ul></blockquote><hr><h2 id=11-7--fastapi-canary-ë¼ìš°íŒ…-ê²€ì¦>11-7) ğŸ§ª FastAPI Canary ë¼ìš°íŒ… ê²€ì¦<a hidden class=anchor aria-hidden=true href=#11-7--fastapi-canary-ë¼ìš°íŒ…-ê²€ì¦>#</a></h2><p><img alt=proof-11-routing-canary.png loading=lazy src=/mlops-journey/images/proof-11-routing-canary.png></p><p>ğŸ“¸ <code>proof-11-routing-canary.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>ALIAS_SELECTION_MODE=canary</code>, <code>CANARY_PERCENT=20</code></li><li>Blue-Green ë¡œê·¸ ê²°ê³¼: A=411, B=89 (Bâ‰ˆ17%)</li><li>GitOps ì»¤ë°‹(<code>test: canary routing</code>) ì •ìƒ ë°˜ì˜</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>íŠ¸ë˜í”½ 20%ê°€ Canary(B)ë¡œ ì •ìƒ ë¶„ë°°ë¨ â†’ <strong>FastAPI ë ˆë²¨ íŠ¸ë˜í”½ ì‹¤í—˜ êµ¬ì¡° ì™„ì„±</strong>.</li></ul></blockquote><h2 id=11-8--fastapi-blue-green-ë¼ìš°íŒ…-ê²€ì¦>11-8) ğŸ§ª FastAPI Blue-Green ë¼ìš°íŒ… ê²€ì¦<a hidden class=anchor aria-hidden=true href=#11-8--fastapi-blue-green-ë¼ìš°íŒ…-ê²€ì¦>#</a></h2><p><img alt=proof-11-routing-blue_green.png loading=lazy src=/mlops-journey/images/proof-11-routing-blue_green.png></p><p>ğŸ“¸ <code>proof-11-routing-blue_green.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>ALIAS_SELECTION_MODE=blue_green</code></li><li>í…ŒìŠ¤íŠ¸ ê²°ê³¼: A=0, B=500 (ì •í™•íˆ 100%)</li><li>GitOps ì»¤ë°‹(<code>test: blue_green routing</code>) ë° ArgoCD Sync ì™„ë£Œ</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>Canary ëŒ€ë¹„ <strong>ì™„ì „ ë¶„ë¦¬ëœ íŠ¸ë˜í”½ ë¶„ë°° êµ¬ì¡°</strong> ê²€ì¦ ì™„ë£Œ â†’ A/B/Blue-Green ë¼ìš°íŒ… ì²´ê³„ ëª¨ë‘ ì •ìƒ ë™ì‘.</li></ul></blockquote><hr><h2 id=11-9---ë¡œê·¸-ìŠ¤í† ë¦¬ì§€-ê³„ì¸µ-s3--nfs-ê²€ì¦>11-9) <strong>ğŸ“‚ ë¡œê·¸ ìŠ¤í† ë¦¬ì§€ ê³„ì¸µ (S3 + NFS) ê²€ì¦</strong><a hidden class=anchor aria-hidden=true href=#11-9---ë¡œê·¸-ìŠ¤í† ë¦¬ì§€-ê³„ì¸µ-s3--nfs-ê²€ì¦>#</a></h2><p><img alt=proof-11-logs-s3-nfs.png loading=lazy src=/mlops-journey/images/proof-11-logs-s3-nfs.png></p><p>ğŸ“¸ <code>proof-11-logs-s3-nfs.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>S3: <code>mlflow-artifacts-keonho/dev/airflow-logs/...</code> ê²½ë¡œì— DAGë³„ ë¡œê·¸ ì—…ë¡œë“œ í™•ì¸</li><li>NFS: <code>/mnt/nfs_share/mlops/fastapi/logs/dev/fastapi.log</code> ì‹¤ì‹œê°„ ê°±ì‹ </li><li>FastAPI pod ë¡œê·¸ì™€ NFS ë¡œê·¸ ë™ê¸°í™” ì‹œê° í™•ì¸</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li><p>Airflow â†’ MLflow â†’ FastAPIì˜ <strong>ë¡œê·¸ íŒŒì´í”„ë¼ì¸ ì™„ì „ ì¼ì›í™”</strong>,</p><p>ì‹¤í—˜Â·ì„œë¹™ ë¡œê·¸ê°€ <strong>S3(ë°±ì—…)</strong> + <strong>NFS(ì‹¤ì‹œê°„)</strong> ë¡œ ëª¨ë‘ ê¸°ë¡ë¨.</p></li></ul></blockquote><hr><h2 id=11-10--aws-credentials-ìë™-íšŒì „-ê²€ì¦>11-10) ğŸ”‘ AWS Credentials ìë™ íšŒì „ ê²€ì¦<a hidden class=anchor aria-hidden=true href=#11-10--aws-credentials-ìë™-íšŒì „-ê²€ì¦>#</a></h2><p><img alt=proof-11-aws-credentials-rotate.png loading=lazy src=/mlops-journey/images/proof-11-aws-credentials-rotate.png></p><p>ğŸ“¸ <code>proof-11-aws-credentials-rotate.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>mlflow-airflow-dev-user</code> IAM í‚¤ ìë™ íšŒì „ í›„ <strong>ì‹ ê·œ í‚¤ 2ê°œ Active ìƒíƒœ</strong></li><li><code>aws-credentials-secret</code>ì˜ <code>resourceVersion</code> ê°±ì‹  í™•ì¸ (<code>2471260</code> â†’ <code>2501958</code>)</li><li>GitOps ì»¤ë°‹(<code>feat(dev): rotate aws credentials</code>) ì •ìƒ ë°˜ì˜</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li><p>AWS IAM í‚¤ ìƒì„± â†’ ë¡œì»¬ ë°±ì—… â†’ SealedSecret ìë™ ì•”í˜¸í™” â†’ GitOps ë°˜ì˜ê¹Œì§€</p><p><strong>ì™„ì „ ìë™ íšŒì „ ì²´ê³„</strong> ì„±ê³µì ìœ¼ë¡œ ë™ì‘í•¨.</p></li></ul></blockquote><h2 id=11-11--sealedsecrets-ì»¨íŠ¸ë¡¤ëŸ¬-í‚¤-íšŒì „--re-seal-ê²€ì¦>11-11) ğŸ”‘ SealedSecrets ì»¨íŠ¸ë¡¤ëŸ¬ í‚¤ íšŒì „ & Re-Seal ê²€ì¦<a hidden class=anchor aria-hidden=true href=#11-11--sealedsecrets-ì»¨íŠ¸ë¡¤ëŸ¬-í‚¤-íšŒì „--re-seal-ê²€ì¦>#</a></h2><p><img alt=proof-11-sealedsecret-cm-rotate-reseal.png loading=lazy src=/mlops-journey/images/proof-11-sealedsecret-cm-rotate-reseal.png></p><p>ğŸ“¸ <code>proof-11-sealedsecret-cm-rotate-reseal.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li>ìƒˆ Fingerprint: <code>BA:75:AD:B7...E6:0:48:AB</code> ìœ¼ë¡œ ë³€ê²½ í™•ì¸</li><li>dev/prod ëª¨ë“  SealedSecret íŒŒì¼(<code>.yaml</code>)ì—ì„œ <code>valid</code> ê²°ê³¼ ë°˜í™˜</li><li>ArgoCD ëª¨ë“  ì•± <strong>Healthy / Synced</strong> ìƒíƒœ ìœ ì§€</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li><p>Controller í‚¤ ì¬ë°œê¸‰ + ì „ í™˜ê²½ Re-Seal í›„ì—ë„ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´</p><p><strong>ë¬´ì¤‘ë‹¨ ì‹œí¬ë¦¿ ì¬ì•”í˜¸í™” ì²´ê³„</strong> ì™„ì„±ë¨.</p></li></ul></blockquote><hr><h2 id=11-12--ìˆ˜ë™-ë¡¤ë°±-ë³€ìˆ˜-ì„¤ì •-airflow-variable>11-12) ğŸ”„ ìˆ˜ë™ ë¡¤ë°± ë³€ìˆ˜ ì„¤ì • (Airflow Variable)<a hidden class=anchor aria-hidden=true href=#11-12--ìˆ˜ë™-ë¡¤ë°±-ë³€ìˆ˜-ì„¤ì •-airflow-variable>#</a></h2><p><img alt=proof-11-manual-rollback-variables.png loading=lazy src=/mlops-journey/images/proof-11-manual-rollback-variables.png></p><p>ğŸ“¸ <code>proof-11-manual-rollback-variables.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>rollback_version=1</code>, <code>rollback_model_name=best_model</code>, <code>rollback_alias=B</code> ì„¤ì • ì™„ë£Œ</li><li>ê¸°ì¡´ í”„ë¡œë•ì…˜ ëª¨ë¸(<code>A</code>) ëŒ€ë¹„ ì´ì „ ë²„ì „(<code>B</code>)ìœ¼ë¡œì˜ ë¡¤ë°± ì¤€ë¹„ ìƒíƒœ</li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li>Airflow DAGì—ì„œ ì¡°ê±´ ê¸°ë°˜ ìˆ˜ë™ ë¡¤ë°±ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ <strong>ë³€ìˆ˜ ê¸°ë°˜ ì œì–´ êµ¬ì¡°</strong> ì •ìƒ ë™ì‘ í™•ì¸.</li></ul></blockquote><h2 id=11-13--airflow-ìˆ˜ë™-ë¡¤ë°±-ì‹¤í–‰--slack-ì—°ë™-ê²€ì¦>11-13) ğŸ” Airflow ìˆ˜ë™ ë¡¤ë°± ì‹¤í–‰ & Slack ì—°ë™ ê²€ì¦<a hidden class=anchor aria-hidden=true href=#11-13--airflow-ìˆ˜ë™-ë¡¤ë°±-ì‹¤í–‰--slack-ì—°ë™-ê²€ì¦>#</a></h2><p><img alt=proof-11-manual-rollback-diff.png loading=lazy src=/mlops-journey/images/proof-11-manual-rollback-diff-and-slack.png></p><p>ğŸ“¸ <code>proof-11-manual-rollback-diff-and-slack.png</code></p><blockquote><p>âœ… í™•ì¸ í¬ì¸íŠ¸</p><ul><li><code>manual_rollback_model_dev</code> DAG ì‹¤í–‰ ì„±ê³µ (<code>rollback_model_alias</code> + <code>reload_fastapi_model</code> ì™„ë£Œ)</li><li>FastAPI <code>/models</code> ê²°ê³¼ì—ì„œ <code>B</code> aliasì˜ run_id <code>4a59f6b6...</code> ë¡œ ë¡¤ë°± ë°˜ì˜ í™•ì¸</li><li>Slack ì•Œë¦¼: â€œ[FastAPI] ëª¨ë¸ B í•«ìŠ¤ì™‘ ì™„ë£Œâ€ ì •ìƒ ìˆ˜ì‹ </li></ul></blockquote><blockquote><p>ğŸ’¡ ì˜ë¯¸</p><ul><li><p>ìˆ˜ë™ íŠ¸ë¦¬ê±°ë§Œìœ¼ë¡œ ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ â†’ FastAPI Reload â†’ Slack ì•Œë¦¼ê¹Œì§€</p><p>ì™„ì „ ìë™ ì—°ë™ëœ <strong>í•«ìŠ¤ì™‘ ê¸°ë°˜ ë¡¤ë°± ë£¨í‹´</strong>ì´ ì„±ê³µì ìœ¼ë¡œ ë™ì‘í•¨.</p></li></ul></blockquote><hr><h3 id=í•œ-ì¤„-ìš”ì•½>í•œ ì¤„ ìš”ì•½<a hidden class=anchor aria-hidden=true href=#í•œ-ì¤„-ìš”ì•½>#</a></h3><blockquote><p>ì´ ìº¡ì²˜ í”Œë¡œìš°ë§Œ ë”°ë¥´ë©´, One Commit Flow(CIâ†’CDâ†’í•™ìŠµ/ë“±ë¡â†’READYâ†’í•«ìŠ¤ì™‘â†’ì‹¤í—˜â†’ê´€ì œ)ê°€ ì‹¤ì œ í™˜ê²½ì—ì„œ ì •ìƒ ì‘ë™í–ˆìŒì„ ê·¸ëŒ€ë¡œ ì¦ëª…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></blockquote></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><p style=margin-top:1rem>Â© 2025 Keonho Ban | <a href=https://github.com/keonhoban target=_blank>GitHub</a> | <a href=mailto:keonho0510@naver.com>Email</a></p></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>